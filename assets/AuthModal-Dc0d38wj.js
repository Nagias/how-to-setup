import{j as e}from"./vendor-tiptap-CPIgDqZu.js";import{r as t}from"./vendor-react-BadUDqtX.js";import{u as w,b as f}from"./index-C0aebke8.js";import"./vendor-firebase-D65FIcPE.js";const A=()=>{const{showAuthModal:k,setShowAuthModal:y}=w(),[a,m]=t.useState("login"),[h,g]=t.useState(""),[u,p]=t.useState(""),[d,x]=t.useState(""),[j,b]=t.useState(""),[v,n]=t.useState(""),[c,r]=t.useState(!1),[N,i]=t.useState("");if(!k)return null;const o=()=>{y(!1),n(""),g(""),p(""),x(""),b("")},C=async s=>{s.preventDefault(),n(""),i(""),r(!0);try{if(a==="login")await f.login(h,u),i("Đăng nhập thành công!"),setTimeout(()=>{o(),i(""),r(!1)},500);else{if(!d){n("Vui lòng nhập tên hiển thị"),r(!1);return}await f.register({email:h,password:u,displayName:d,username:j}),i("Đăng ký thành công!"),setTimeout(()=>{o(),i(""),r(!1)},500)}}catch(l){console.error(l),r(!1),l.code==="auth/wrong-password"||l.code==="auth/user-not-found"||l.code==="auth/invalid-credential"?n("Email hoặc mật khẩu không đúng"):l.code==="auth/email-already-in-use"?n("Email đã được sử dụng"):n("Đã có lỗi xảy ra: "+l.message)}};return e.jsx("div",{className:"modal-overlay",onClick:s=>s.target===s.currentTarget&&o(),children:e.jsxs("div",{className:"auth-modal modal-content",children:[e.jsx("button",{className:"modal-close-btn",onClick:o,children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),e.jsxs("div",{className:"auth-content",children:[e.jsx("h2",{children:a==="login"?"Đăng Nhập":"Đăng Ký"}),e.jsx("p",{className:"auth-subtitle",children:a==="login"?"Đăng nhập để lưu setup yêu thích và viết bình luận":"Tạo tài khoản mới để tham gia cộng đồng DeskHub"}),v&&e.jsx("div",{className:"auth-error",children:v}),N&&e.jsx("div",{className:"auth-error",style:{color:"#059669",borderColor:"#059669",backgroundColor:"#ecfdf5"},children:N}),e.jsxs("form",{onSubmit:C,className:"auth-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",className:"input",value:h,onChange:s=>g(s.target.value),placeholder:"name@example.com",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Mật khẩu"}),e.jsx("input",{type:"password",className:"input",value:u,onChange:s=>p(s.target.value),placeholder:"••••••••",required:!0,minLength:6})]}),a==="register"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tên hiển thị"}),e.jsx("input",{type:"text",className:"input",value:d,onChange:s=>x(s.target.value),placeholder:"Tên của bạn",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Username"}),e.jsx("input",{type:"text",className:"input",value:j,onChange:s=>b(s.target.value),placeholder:"username",required:!0,pattern:"[a-zA-Z0-9_-]+",title:"Chỉ chứa chữ cái, số, gạch ngang và gạch dưới"})]})]}),e.jsx("button",{type:"submit",className:"btn btn-primary auth-submit",disabled:c,style:{opacity:c?.7:1,cursor:c?"wait":"pointer"},children:c?"Đang xử lý...":a==="login"?"Đăng Nhập":"Đăng Ký"})]}),e.jsx("div",{className:"auth-switch",children:a==="login"?e.jsxs("p",{children:["Chưa có tài khoản?"," ",e.jsx("button",{onClick:()=>m("register"),className:"link-btn",children:"Đăng ký ngay"})]}):e.jsxs("p",{children:["Đã có tài khoản?"," ",e.jsx("button",{onClick:()=>m("login"),className:"link-btn",children:"Đăng nhập"})]})}),e.jsx("div",{className:"auth-divider",children:e.jsx("span",{children:"hoặc"})}),e.jsx("button",{className:"btn btn-secondary",onClick:o,children:"Tiếp tục với tài khoản Khách"}),e.jsx("p",{className:"auth-note",children:e.jsx("small",{children:"Tài khoản Khách sử dụng IP máy để lưu dữ liệu. Dữ liệu sẽ được giữ trên thiết bị này."})})]})]})})};export{A as default};
