var vC=Object.defineProperty;var wC=(t,e,n)=>e in t?vC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var lr=(t,e,n)=>wC(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Yl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var EE={exports:{}},$h={},TE={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jl=Symbol.for("react.element"),EC=Symbol.for("react.portal"),TC=Symbol.for("react.fragment"),IC=Symbol.for("react.strict_mode"),xC=Symbol.for("react.profiler"),SC=Symbol.for("react.provider"),kC=Symbol.for("react.context"),CC=Symbol.for("react.forward_ref"),AC=Symbol.for("react.suspense"),bC=Symbol.for("react.memo"),RC=Symbol.for("react.lazy"),O_=Symbol.iterator;function PC(t){return t===null||typeof t!="object"?null:(t=O_&&t[O_]||t["@@iterator"],typeof t=="function"?t:null)}var IE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xE=Object.assign,SE={};function Qo(t,e,n){this.props=t,this.context=e,this.refs=SE,this.updater=n||IE}Qo.prototype.isReactComponent={};Qo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Qo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kE(){}kE.prototype=Qo.prototype;function jm(t,e,n){this.props=t,this.context=e,this.refs=SE,this.updater=n||IE}var Lm=jm.prototype=new kE;Lm.constructor=jm;xE(Lm,Qo.prototype);Lm.isPureReactComponent=!0;var F_=Array.isArray,CE=Object.prototype.hasOwnProperty,Vm={current:null},AE={key:!0,ref:!0,__self:!0,__source:!0};function bE(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)CE.call(e,r)&&!AE.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),h=0;h<a;h++)l[h]=arguments[h+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Jl,type:t,key:i,ref:o,props:s,_owner:Vm.current}}function NC(t,e){return{$$typeof:Jl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Mm(t){return typeof t=="object"&&t!==null&&t.$$typeof===Jl}function DC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var U_=/\/+/g;function ef(t,e){return typeof t=="object"&&t!==null&&t.key!=null?DC(""+t.key):e.toString(36)}function fc(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Jl:case EC:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+ef(o,0):r,F_(s)?(n="",t!=null&&(n=t.replace(U_,"$&/")+"/"),fc(s,e,n,"",function(h){return h})):s!=null&&(Mm(s)&&(s=NC(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(U_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",F_(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+ef(i,a);o+=fc(i,e,n,l,s)}else if(l=PC(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+ef(i,a++),o+=fc(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Mu(t,e,n){if(t==null)return t;var r=[],s=0;return fc(t,r,"","",function(i){return e.call(n,i,s++)}),r}function jC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var qt={current:null},pc={transition:null},LC={ReactCurrentDispatcher:qt,ReactCurrentBatchConfig:pc,ReactCurrentOwner:Vm};function RE(){throw Error("act(...) is not supported in production builds of React.")}ge.Children={map:Mu,forEach:function(t,e,n){Mu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Mu(t,function(){e++}),e},toArray:function(t){return Mu(t,function(e){return e})||[]},only:function(t){if(!Mm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ge.Component=Qo;ge.Fragment=TC;ge.Profiler=xC;ge.PureComponent=jm;ge.StrictMode=IC;ge.Suspense=AC;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LC;ge.act=RE;ge.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=xE({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Vm.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)CE.call(e,l)&&!AE.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var h=0;h<l;h++)a[h]=arguments[h+2];r.children=a}return{$$typeof:Jl,type:t.type,key:s,ref:i,props:r,_owner:o}};ge.createContext=function(t){return t={$$typeof:kC,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:SC,_context:t},t.Consumer=t};ge.createElement=bE;ge.createFactory=function(t){var e=bE.bind(null,t);return e.type=t,e};ge.createRef=function(){return{current:null}};ge.forwardRef=function(t){return{$$typeof:CC,render:t}};ge.isValidElement=Mm;ge.lazy=function(t){return{$$typeof:RC,_payload:{_status:-1,_result:t},_init:jC}};ge.memo=function(t,e){return{$$typeof:bC,type:t,compare:e===void 0?null:e}};ge.startTransition=function(t){var e=pc.transition;pc.transition={};try{t()}finally{pc.transition=e}};ge.unstable_act=RE;ge.useCallback=function(t,e){return qt.current.useCallback(t,e)};ge.useContext=function(t){return qt.current.useContext(t)};ge.useDebugValue=function(){};ge.useDeferredValue=function(t){return qt.current.useDeferredValue(t)};ge.useEffect=function(t,e){return qt.current.useEffect(t,e)};ge.useId=function(){return qt.current.useId()};ge.useImperativeHandle=function(t,e,n){return qt.current.useImperativeHandle(t,e,n)};ge.useInsertionEffect=function(t,e){return qt.current.useInsertionEffect(t,e)};ge.useLayoutEffect=function(t,e){return qt.current.useLayoutEffect(t,e)};ge.useMemo=function(t,e){return qt.current.useMemo(t,e)};ge.useReducer=function(t,e,n){return qt.current.useReducer(t,e,n)};ge.useRef=function(t){return qt.current.useRef(t)};ge.useState=function(t){return qt.current.useState(t)};ge.useSyncExternalStore=function(t,e,n){return qt.current.useSyncExternalStore(t,e,n)};ge.useTransition=function(){return qt.current.useTransition()};ge.version="18.3.1";TE.exports=ge;var P=TE.exports;const zt=Yl(P);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VC=P,MC=Symbol.for("react.element"),OC=Symbol.for("react.fragment"),FC=Object.prototype.hasOwnProperty,UC=VC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,BC={key:!0,ref:!0,__self:!0,__source:!0};function PE(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)FC.call(e,r)&&!BC.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:MC,type:t,key:i,ref:o,props:s,_owner:UC.current}}$h.Fragment=OC;$h.jsx=PE;$h.jsxs=PE;EE.exports=$h;var c=EE.exports,ep={},NE={exports:{}},fn={},DE={exports:{}},jE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(K,se){var L=K.length;K.push(se);e:for(;0<L;){var G=L-1>>>1,B=K[G];if(0<s(B,se))K[G]=se,K[L]=B,L=G;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var se=K[0],L=K.pop();if(L!==se){K[0]=L;e:for(var G=0,B=K.length,Y=B>>>1;G<Y;){var re=2*(G+1)-1,xe=K[re],Se=re+1,Ne=K[Se];if(0>s(xe,L))Se<B&&0>s(Ne,xe)?(K[G]=Ne,K[Se]=L,G=Se):(K[G]=xe,K[re]=L,G=re);else if(Se<B&&0>s(Ne,L))K[G]=Ne,K[Se]=L,G=Se;else break e}}return se}function s(K,se){var L=K.sortIndex-se.sortIndex;return L!==0?L:K.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],h=[],d=1,p=null,m=3,_=!1,k=!1,A=!1,b=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(K){for(var se=n(h);se!==null;){if(se.callback===null)r(h);else if(se.startTime<=K)r(h),se.sortIndex=se.expirationTime,e(l,se);else break;se=n(h)}}function N(K){if(A=!1,E(K),!k)if(n(l)!==null)k=!0,et(j);else{var se=n(h);se!==null&&ot(N,se.startTime-K)}}function j(K,se){k=!1,A&&(A=!1,T(y),y=-1),_=!0;var L=m;try{for(E(se),p=n(l);p!==null&&(!(p.expirationTime>se)||K&&!R());){var G=p.callback;if(typeof G=="function"){p.callback=null,m=p.priorityLevel;var B=G(p.expirationTime<=se);se=t.unstable_now(),typeof B=="function"?p.callback=B:p===n(l)&&r(l),E(se)}else r(l);p=n(l)}if(p!==null)var Y=!0;else{var re=n(h);re!==null&&ot(N,re.startTime-se),Y=!1}return Y}finally{p=null,m=L,_=!1}}var F=!1,S=null,y=-1,v=5,C=-1;function R(){return!(t.unstable_now()-C<v)}function D(){if(S!==null){var K=t.unstable_now();C=K;var se=!0;try{se=S(!0,K)}finally{se?x():(F=!1,S=null)}}else F=!1}var x;if(typeof w=="function")x=function(){w(D)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,me=le.port2;le.port1.onmessage=D,x=function(){me.postMessage(null)}}else x=function(){b(D,0)};function et(K){S=K,F||(F=!0,x())}function ot(K,se){y=b(function(){K(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){k||_||(k=!0,et(j))},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(K){switch(m){case 1:case 2:case 3:var se=3;break;default:se=m}var L=m;m=se;try{return K()}finally{m=L}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,se){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var L=m;m=K;try{return se()}finally{m=L}},t.unstable_scheduleCallback=function(K,se,L){var G=t.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?G+L:G):L=G,K){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=L+B,K={id:d++,callback:se,priorityLevel:K,startTime:L,expirationTime:B,sortIndex:-1},L>G?(K.sortIndex=L,e(h,K),n(l)===null&&K===n(h)&&(A?(T(y),y=-1):A=!0,ot(N,L-G))):(K.sortIndex=B,e(l,K),k||_||(k=!0,et(j))),K},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(K){var se=m;return function(){var L=m;m=se;try{return K.apply(this,arguments)}finally{m=L}}}})(jE);DE.exports=jE;var zC=DE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $C=P,hn=zC;function $(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var LE=new Set,_l={};function Ci(t,e){Co(t,e),Co(t+"Capture",e)}function Co(t,e){for(_l[t]=e,t=0;t<e.length;t++)LE.add(e[t])}var Tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tp=Object.prototype.hasOwnProperty,HC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,B_={},z_={};function qC(t){return tp.call(z_,t)?!0:tp.call(B_,t)?!1:HC.test(t)?z_[t]=!0:(B_[t]=!0,!1)}function WC(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function KC(t,e,n,r){if(e===null||typeof e>"u"||WC(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Wt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Ct={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ct[t]=new Wt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ct[e]=new Wt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ct[t]=new Wt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ct[t]=new Wt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ct[t]=new Wt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ct[t]=new Wt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ct[t]=new Wt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ct[t]=new Wt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ct[t]=new Wt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Om=/[\-:]([a-z])/g;function Fm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Om,Fm);Ct[e]=new Wt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Om,Fm);Ct[e]=new Wt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Om,Fm);Ct[e]=new Wt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ct[t]=new Wt(t,1,!1,t.toLowerCase(),null,!1,!1)});Ct.xlinkHref=new Wt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ct[t]=new Wt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Um(t,e,n,r){var s=Ct.hasOwnProperty(e)?Ct[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(KC(e,n,s,r)&&(n=null),r||s===null?qC(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Pr=$C.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ou=Symbol.for("react.element"),Zi=Symbol.for("react.portal"),eo=Symbol.for("react.fragment"),Bm=Symbol.for("react.strict_mode"),np=Symbol.for("react.profiler"),VE=Symbol.for("react.provider"),ME=Symbol.for("react.context"),zm=Symbol.for("react.forward_ref"),rp=Symbol.for("react.suspense"),sp=Symbol.for("react.suspense_list"),$m=Symbol.for("react.memo"),Gr=Symbol.for("react.lazy"),OE=Symbol.for("react.offscreen"),$_=Symbol.iterator;function Ea(t){return t===null||typeof t!="object"?null:(t=$_&&t[$_]||t["@@iterator"],typeof t=="function"?t:null)}var qe=Object.assign,tf;function Fa(t){if(tf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);tf=e&&e[1]||""}return`
`+tf+t}var nf=!1;function rf(t,e){if(!t||nf)return"";nf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{nf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fa(t):""}function GC(t){switch(t.tag){case 5:return Fa(t.type);case 16:return Fa("Lazy");case 13:return Fa("Suspense");case 19:return Fa("SuspenseList");case 0:case 2:case 15:return t=rf(t.type,!1),t;case 11:return t=rf(t.type.render,!1),t;case 1:return t=rf(t.type,!0),t;default:return""}}function ip(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case eo:return"Fragment";case Zi:return"Portal";case np:return"Profiler";case Bm:return"StrictMode";case rp:return"Suspense";case sp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ME:return(t.displayName||"Context")+".Consumer";case VE:return(t._context.displayName||"Context")+".Provider";case zm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case $m:return e=t.displayName||null,e!==null?e:ip(t.type)||"Memo";case Gr:e=t._payload,t=t._init;try{return ip(t(e))}catch{}}return null}function QC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ip(e);case 8:return e===Bm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function _s(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function FE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function XC(t){var e=FE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Fu(t){t._valueTracker||(t._valueTracker=XC(t))}function UE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=FE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Wc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function op(t,e){var n=e.checked;return qe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function H_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=_s(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function BE(t,e){e=e.checked,e!=null&&Um(t,"checked",e,!1)}function ap(t,e){BE(t,e);var n=_s(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?lp(t,e.type,n):e.hasOwnProperty("defaultValue")&&lp(t,e.type,_s(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function q_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function lp(t,e,n){(e!=="number"||Wc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ua=Array.isArray;function fo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+_s(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function up(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return qe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function W_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error($(92));if(Ua(n)){if(1<n.length)throw Error($(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:_s(n)}}function zE(t,e){var n=_s(e.value),r=_s(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function K_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function $E(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?$E(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Uu,HE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Uu=Uu||document.createElement("div"),Uu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Uu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function vl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ja={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},YC=["Webkit","ms","Moz","O"];Object.keys(Ja).forEach(function(t){YC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ja[e]=Ja[t]})});function qE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ja.hasOwnProperty(t)&&Ja[t]?(""+e).trim():e+"px"}function WE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=qE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var JC=qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hp(t,e){if(e){if(JC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function dp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fp=null;function Hm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var pp=null,po=null,mo=null;function G_(t){if(t=tu(t)){if(typeof pp!="function")throw Error($(280));var e=t.stateNode;e&&(e=Gh(e),pp(t.stateNode,t.type,e))}}function KE(t){po?mo?mo.push(t):mo=[t]:po=t}function GE(){if(po){var t=po,e=mo;if(mo=po=null,G_(t),e)for(t=0;t<e.length;t++)G_(e[t])}}function QE(t,e){return t(e)}function XE(){}var sf=!1;function YE(t,e,n){if(sf)return t(e,n);sf=!0;try{return QE(t,e,n)}finally{sf=!1,(po!==null||mo!==null)&&(XE(),GE())}}function wl(t,e){var n=t.stateNode;if(n===null)return null;var r=Gh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error($(231,e,typeof n));return n}var mp=!1;if(Tr)try{var Ta={};Object.defineProperty(Ta,"passive",{get:function(){mp=!0}}),window.addEventListener("test",Ta,Ta),window.removeEventListener("test",Ta,Ta)}catch{mp=!1}function ZC(t,e,n,r,s,i,o,a,l){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(d){this.onError(d)}}var Za=!1,Kc=null,Gc=!1,gp=null,eA={onError:function(t){Za=!0,Kc=t}};function tA(t,e,n,r,s,i,o,a,l){Za=!1,Kc=null,ZC.apply(eA,arguments)}function nA(t,e,n,r,s,i,o,a,l){if(tA.apply(this,arguments),Za){if(Za){var h=Kc;Za=!1,Kc=null}else throw Error($(198));Gc||(Gc=!0,gp=h)}}function Ai(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function JE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Q_(t){if(Ai(t)!==t)throw Error($(188))}function rA(t){var e=t.alternate;if(!e){if(e=Ai(t),e===null)throw Error($(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Q_(s),t;if(i===r)return Q_(s),e;i=i.sibling}throw Error($(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error($(189))}}if(n.alternate!==r)throw Error($(190))}if(n.tag!==3)throw Error($(188));return n.stateNode.current===n?t:e}function ZE(t){return t=rA(t),t!==null?eT(t):null}function eT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=eT(t);if(e!==null)return e;t=t.sibling}return null}var tT=hn.unstable_scheduleCallback,X_=hn.unstable_cancelCallback,sA=hn.unstable_shouldYield,iA=hn.unstable_requestPaint,Je=hn.unstable_now,oA=hn.unstable_getCurrentPriorityLevel,qm=hn.unstable_ImmediatePriority,nT=hn.unstable_UserBlockingPriority,Qc=hn.unstable_NormalPriority,aA=hn.unstable_LowPriority,rT=hn.unstable_IdlePriority,Hh=null,Yn=null;function lA(t){if(Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(Hh,t,void 0,(t.current.flags&128)===128)}catch{}}var Mn=Math.clz32?Math.clz32:hA,uA=Math.log,cA=Math.LN2;function hA(t){return t>>>=0,t===0?32:31-(uA(t)/cA|0)|0}var Bu=64,zu=4194304;function Ba(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Xc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Ba(a):(i&=o,i!==0&&(r=Ba(i)))}else o=n&~s,o!==0?r=Ba(o):i!==0&&(r=Ba(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Mn(e),s=1<<n,r|=t[n],e&=~s;return r}function dA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Mn(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=dA(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function yp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function sT(){var t=Bu;return Bu<<=1,!(Bu&4194240)&&(Bu=64),t}function of(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Zl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Mn(e),t[e]=n}function pA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Mn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Wm(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Mn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ae=0;function iT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var oT,Km,aT,lT,uT,_p=!1,$u=[],is=null,os=null,as=null,El=new Map,Tl=new Map,Xr=[],mA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Y_(t,e){switch(t){case"focusin":case"focusout":is=null;break;case"dragenter":case"dragleave":os=null;break;case"mouseover":case"mouseout":as=null;break;case"pointerover":case"pointerout":El.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tl.delete(e.pointerId)}}function Ia(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=tu(e),e!==null&&Km(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function gA(t,e,n,r,s){switch(e){case"focusin":return is=Ia(is,t,e,n,r,s),!0;case"dragenter":return os=Ia(os,t,e,n,r,s),!0;case"mouseover":return as=Ia(as,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return El.set(i,Ia(El.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Tl.set(i,Ia(Tl.get(i)||null,t,e,n,r,s)),!0}return!1}function cT(t){var e=Ys(t.target);if(e!==null){var n=Ai(e);if(n!==null){if(e=n.tag,e===13){if(e=JE(n),e!==null){t.blockedOn=e,uT(t.priority,function(){aT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function mc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=vp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);fp=r,n.target.dispatchEvent(r),fp=null}else return e=tu(n),e!==null&&Km(e),t.blockedOn=n,!1;e.shift()}return!0}function J_(t,e,n){mc(t)&&n.delete(e)}function yA(){_p=!1,is!==null&&mc(is)&&(is=null),os!==null&&mc(os)&&(os=null),as!==null&&mc(as)&&(as=null),El.forEach(J_),Tl.forEach(J_)}function xa(t,e){t.blockedOn===e&&(t.blockedOn=null,_p||(_p=!0,hn.unstable_scheduleCallback(hn.unstable_NormalPriority,yA)))}function Il(t){function e(s){return xa(s,t)}if(0<$u.length){xa($u[0],t);for(var n=1;n<$u.length;n++){var r=$u[n];r.blockedOn===t&&(r.blockedOn=null)}}for(is!==null&&xa(is,t),os!==null&&xa(os,t),as!==null&&xa(as,t),El.forEach(e),Tl.forEach(e),n=0;n<Xr.length;n++)r=Xr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Xr.length&&(n=Xr[0],n.blockedOn===null);)cT(n),n.blockedOn===null&&Xr.shift()}var go=Pr.ReactCurrentBatchConfig,Yc=!0;function _A(t,e,n,r){var s=Ae,i=go.transition;go.transition=null;try{Ae=1,Gm(t,e,n,r)}finally{Ae=s,go.transition=i}}function vA(t,e,n,r){var s=Ae,i=go.transition;go.transition=null;try{Ae=4,Gm(t,e,n,r)}finally{Ae=s,go.transition=i}}function Gm(t,e,n,r){if(Yc){var s=vp(t,e,n,r);if(s===null)gf(t,e,r,Jc,n),Y_(t,r);else if(gA(s,t,e,n,r))r.stopPropagation();else if(Y_(t,r),e&4&&-1<mA.indexOf(t)){for(;s!==null;){var i=tu(s);if(i!==null&&oT(i),i=vp(t,e,n,r),i===null&&gf(t,e,r,Jc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else gf(t,e,r,null,n)}}var Jc=null;function vp(t,e,n,r){if(Jc=null,t=Hm(r),t=Ys(t),t!==null)if(e=Ai(t),e===null)t=null;else if(n=e.tag,n===13){if(t=JE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Jc=t,null}function hT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(oA()){case qm:return 1;case nT:return 4;case Qc:case aA:return 16;case rT:return 536870912;default:return 16}default:return 16}}var ns=null,Qm=null,gc=null;function dT(){if(gc)return gc;var t,e=Qm,n=e.length,r,s="value"in ns?ns.value:ns.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return gc=s.slice(t,1<r?1-r:void 0)}function yc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Hu(){return!0}function Z_(){return!1}function pn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Hu:Z_,this.isPropagationStopped=Z_,this}return qe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Hu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Hu)},persist:function(){},isPersistent:Hu}),e}var Xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xm=pn(Xo),eu=qe({},Xo,{view:0,detail:0}),wA=pn(eu),af,lf,Sa,qh=qe({},eu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ym,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Sa&&(Sa&&t.type==="mousemove"?(af=t.screenX-Sa.screenX,lf=t.screenY-Sa.screenY):lf=af=0,Sa=t),af)},movementY:function(t){return"movementY"in t?t.movementY:lf}}),ev=pn(qh),EA=qe({},qh,{dataTransfer:0}),TA=pn(EA),IA=qe({},eu,{relatedTarget:0}),uf=pn(IA),xA=qe({},Xo,{animationName:0,elapsedTime:0,pseudoElement:0}),SA=pn(xA),kA=qe({},Xo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),CA=pn(kA),AA=qe({},Xo,{data:0}),tv=pn(AA),bA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},RA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},PA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=PA[t])?!!e[t]:!1}function Ym(){return NA}var DA=qe({},eu,{key:function(t){if(t.key){var e=bA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=yc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?RA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ym,charCode:function(t){return t.type==="keypress"?yc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?yc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),jA=pn(DA),LA=qe({},qh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nv=pn(LA),VA=qe({},eu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ym}),MA=pn(VA),OA=qe({},Xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),FA=pn(OA),UA=qe({},qh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),BA=pn(UA),zA=[9,13,27,32],Jm=Tr&&"CompositionEvent"in window,el=null;Tr&&"documentMode"in document&&(el=document.documentMode);var $A=Tr&&"TextEvent"in window&&!el,fT=Tr&&(!Jm||el&&8<el&&11>=el),rv=" ",sv=!1;function pT(t,e){switch(t){case"keyup":return zA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var to=!1;function HA(t,e){switch(t){case"compositionend":return mT(e);case"keypress":return e.which!==32?null:(sv=!0,rv);case"textInput":return t=e.data,t===rv&&sv?null:t;default:return null}}function qA(t,e){if(to)return t==="compositionend"||!Jm&&pT(t,e)?(t=dT(),gc=Qm=ns=null,to=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return fT&&e.locale!=="ko"?null:e.data;default:return null}}var WA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function iv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!WA[t.type]:e==="textarea"}function gT(t,e,n,r){KE(r),e=Zc(e,"onChange"),0<e.length&&(n=new Xm("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var tl=null,xl=null;function KA(t){CT(t,0)}function Wh(t){var e=so(t);if(UE(e))return t}function GA(t,e){if(t==="change")return e}var yT=!1;if(Tr){var cf;if(Tr){var hf="oninput"in document;if(!hf){var ov=document.createElement("div");ov.setAttribute("oninput","return;"),hf=typeof ov.oninput=="function"}cf=hf}else cf=!1;yT=cf&&(!document.documentMode||9<document.documentMode)}function av(){tl&&(tl.detachEvent("onpropertychange",_T),xl=tl=null)}function _T(t){if(t.propertyName==="value"&&Wh(xl)){var e=[];gT(e,xl,t,Hm(t)),YE(KA,e)}}function QA(t,e,n){t==="focusin"?(av(),tl=e,xl=n,tl.attachEvent("onpropertychange",_T)):t==="focusout"&&av()}function XA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Wh(xl)}function YA(t,e){if(t==="click")return Wh(e)}function JA(t,e){if(t==="input"||t==="change")return Wh(e)}function ZA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Fn=typeof Object.is=="function"?Object.is:ZA;function Sl(t,e){if(Fn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!tp.call(e,s)||!Fn(t[s],e[s]))return!1}return!0}function lv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function uv(t,e){var n=lv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=lv(n)}}function vT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?vT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function wT(){for(var t=window,e=Wc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Wc(t.document)}return e}function Zm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function eb(t){var e=wT(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&vT(n.ownerDocument.documentElement,n)){if(r!==null&&Zm(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=uv(n,i);var o=uv(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var tb=Tr&&"documentMode"in document&&11>=document.documentMode,no=null,wp=null,nl=null,Ep=!1;function cv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ep||no==null||no!==Wc(r)||(r=no,"selectionStart"in r&&Zm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),nl&&Sl(nl,r)||(nl=r,r=Zc(wp,"onSelect"),0<r.length&&(e=new Xm("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=no)))}function qu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ro={animationend:qu("Animation","AnimationEnd"),animationiteration:qu("Animation","AnimationIteration"),animationstart:qu("Animation","AnimationStart"),transitionend:qu("Transition","TransitionEnd")},df={},ET={};Tr&&(ET=document.createElement("div").style,"AnimationEvent"in window||(delete ro.animationend.animation,delete ro.animationiteration.animation,delete ro.animationstart.animation),"TransitionEvent"in window||delete ro.transitionend.transition);function Kh(t){if(df[t])return df[t];if(!ro[t])return t;var e=ro[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in ET)return df[t]=e[n];return t}var TT=Kh("animationend"),IT=Kh("animationiteration"),xT=Kh("animationstart"),ST=Kh("transitionend"),kT=new Map,hv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ss(t,e){kT.set(t,e),Ci(e,[t])}for(var ff=0;ff<hv.length;ff++){var pf=hv[ff],nb=pf.toLowerCase(),rb=pf[0].toUpperCase()+pf.slice(1);Ss(nb,"on"+rb)}Ss(TT,"onAnimationEnd");Ss(IT,"onAnimationIteration");Ss(xT,"onAnimationStart");Ss("dblclick","onDoubleClick");Ss("focusin","onFocus");Ss("focusout","onBlur");Ss(ST,"onTransitionEnd");Co("onMouseEnter",["mouseout","mouseover"]);Co("onMouseLeave",["mouseout","mouseover"]);Co("onPointerEnter",["pointerout","pointerover"]);Co("onPointerLeave",["pointerout","pointerover"]);Ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ci("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var za="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sb=new Set("cancel close invalid load scroll toggle".split(" ").concat(za));function dv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,nA(r,e,void 0,t),t.currentTarget=null}function CT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,h=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;dv(s,a,h),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,h=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;dv(s,a,h),i=l}}}if(Gc)throw t=gp,Gc=!1,gp=null,t}function je(t,e){var n=e[kp];n===void 0&&(n=e[kp]=new Set);var r=t+"__bubble";n.has(r)||(AT(e,t,2,!1),n.add(r))}function mf(t,e,n){var r=0;e&&(r|=4),AT(n,t,r,e)}var Wu="_reactListening"+Math.random().toString(36).slice(2);function kl(t){if(!t[Wu]){t[Wu]=!0,LE.forEach(function(n){n!=="selectionchange"&&(sb.has(n)||mf(n,!1,t),mf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Wu]||(e[Wu]=!0,mf("selectionchange",!1,e))}}function AT(t,e,n,r){switch(hT(e)){case 1:var s=_A;break;case 4:s=vA;break;default:s=Gm}n=s.bind(null,e,n,t),s=void 0,!mp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function gf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Ys(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}YE(function(){var h=i,d=Hm(n),p=[];e:{var m=kT.get(t);if(m!==void 0){var _=Xm,k=t;switch(t){case"keypress":if(yc(n)===0)break e;case"keydown":case"keyup":_=jA;break;case"focusin":k="focus",_=uf;break;case"focusout":k="blur",_=uf;break;case"beforeblur":case"afterblur":_=uf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=ev;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=TA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=MA;break;case TT:case IT:case xT:_=SA;break;case ST:_=FA;break;case"scroll":_=wA;break;case"wheel":_=BA;break;case"copy":case"cut":case"paste":_=CA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=nv}var A=(e&4)!==0,b=!A&&t==="scroll",T=A?m!==null?m+"Capture":null:m;A=[];for(var w=h,E;w!==null;){E=w;var N=E.stateNode;if(E.tag===5&&N!==null&&(E=N,T!==null&&(N=wl(w,T),N!=null&&A.push(Cl(w,N,E)))),b)break;w=w.return}0<A.length&&(m=new _(m,k,null,n,d),p.push({event:m,listeners:A}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",m&&n!==fp&&(k=n.relatedTarget||n.fromElement)&&(Ys(k)||k[Ir]))break e;if((_||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,_?(k=n.relatedTarget||n.toElement,_=h,k=k?Ys(k):null,k!==null&&(b=Ai(k),k!==b||k.tag!==5&&k.tag!==6)&&(k=null)):(_=null,k=h),_!==k)){if(A=ev,N="onMouseLeave",T="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(A=nv,N="onPointerLeave",T="onPointerEnter",w="pointer"),b=_==null?m:so(_),E=k==null?m:so(k),m=new A(N,w+"leave",_,n,d),m.target=b,m.relatedTarget=E,N=null,Ys(d)===h&&(A=new A(T,w+"enter",k,n,d),A.target=E,A.relatedTarget=b,N=A),b=N,_&&k)t:{for(A=_,T=k,w=0,E=A;E;E=Fi(E))w++;for(E=0,N=T;N;N=Fi(N))E++;for(;0<w-E;)A=Fi(A),w--;for(;0<E-w;)T=Fi(T),E--;for(;w--;){if(A===T||T!==null&&A===T.alternate)break t;A=Fi(A),T=Fi(T)}A=null}else A=null;_!==null&&fv(p,m,_,A,!1),k!==null&&b!==null&&fv(p,b,k,A,!0)}}e:{if(m=h?so(h):window,_=m.nodeName&&m.nodeName.toLowerCase(),_==="select"||_==="input"&&m.type==="file")var j=GA;else if(iv(m))if(yT)j=JA;else{j=XA;var F=QA}else(_=m.nodeName)&&_.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(j=YA);if(j&&(j=j(t,h))){gT(p,j,n,d);break e}F&&F(t,m,h),t==="focusout"&&(F=m._wrapperState)&&F.controlled&&m.type==="number"&&lp(m,"number",m.value)}switch(F=h?so(h):window,t){case"focusin":(iv(F)||F.contentEditable==="true")&&(no=F,wp=h,nl=null);break;case"focusout":nl=wp=no=null;break;case"mousedown":Ep=!0;break;case"contextmenu":case"mouseup":case"dragend":Ep=!1,cv(p,n,d);break;case"selectionchange":if(tb)break;case"keydown":case"keyup":cv(p,n,d)}var S;if(Jm)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else to?pT(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(fT&&n.locale!=="ko"&&(to||y!=="onCompositionStart"?y==="onCompositionEnd"&&to&&(S=dT()):(ns=d,Qm="value"in ns?ns.value:ns.textContent,to=!0)),F=Zc(h,y),0<F.length&&(y=new tv(y,t,null,n,d),p.push({event:y,listeners:F}),S?y.data=S:(S=mT(n),S!==null&&(y.data=S)))),(S=$A?HA(t,n):qA(t,n))&&(h=Zc(h,"onBeforeInput"),0<h.length&&(d=new tv("onBeforeInput","beforeinput",null,n,d),p.push({event:d,listeners:h}),d.data=S))}CT(p,e)})}function Cl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Zc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=wl(t,n),i!=null&&r.unshift(Cl(t,i,s)),i=wl(t,e),i!=null&&r.push(Cl(t,i,s))),t=t.return}return r}function Fi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function fv(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,h=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&h!==null&&(a=h,s?(l=wl(n,i),l!=null&&o.unshift(Cl(n,l,a))):s||(l=wl(n,i),l!=null&&o.push(Cl(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var ib=/\r\n?/g,ob=/\u0000|\uFFFD/g;function pv(t){return(typeof t=="string"?t:""+t).replace(ib,`
`).replace(ob,"")}function Ku(t,e,n){if(e=pv(e),pv(t)!==e&&n)throw Error($(425))}function eh(){}var Tp=null,Ip=null;function xp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Sp=typeof setTimeout=="function"?setTimeout:void 0,ab=typeof clearTimeout=="function"?clearTimeout:void 0,mv=typeof Promise=="function"?Promise:void 0,lb=typeof queueMicrotask=="function"?queueMicrotask:typeof mv<"u"?function(t){return mv.resolve(null).then(t).catch(ub)}:Sp;function ub(t){setTimeout(function(){throw t})}function yf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Il(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Il(e)}function ls(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function gv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Yo=Math.random().toString(36).slice(2),Kn="__reactFiber$"+Yo,Al="__reactProps$"+Yo,Ir="__reactContainer$"+Yo,kp="__reactEvents$"+Yo,cb="__reactListeners$"+Yo,hb="__reactHandles$"+Yo;function Ys(t){var e=t[Kn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ir]||n[Kn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=gv(t);t!==null;){if(n=t[Kn])return n;t=gv(t)}return e}t=n,n=t.parentNode}return null}function tu(t){return t=t[Kn]||t[Ir],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function so(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error($(33))}function Gh(t){return t[Al]||null}var Cp=[],io=-1;function ks(t){return{current:t}}function Le(t){0>io||(t.current=Cp[io],Cp[io]=null,io--)}function Pe(t,e){io++,Cp[io]=t.current,t.current=e}var vs={},Vt=ks(vs),Zt=ks(!1),ui=vs;function Ao(t,e){var n=t.type.contextTypes;if(!n)return vs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function en(t){return t=t.childContextTypes,t!=null}function th(){Le(Zt),Le(Vt)}function yv(t,e,n){if(Vt.current!==vs)throw Error($(168));Pe(Vt,e),Pe(Zt,n)}function bT(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error($(108,QC(t)||"Unknown",s));return qe({},n,r)}function nh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||vs,ui=Vt.current,Pe(Vt,t),Pe(Zt,Zt.current),!0}function _v(t,e,n){var r=t.stateNode;if(!r)throw Error($(169));n?(t=bT(t,e,ui),r.__reactInternalMemoizedMergedChildContext=t,Le(Zt),Le(Vt),Pe(Vt,t)):Le(Zt),Pe(Zt,n)}var cr=null,Qh=!1,_f=!1;function RT(t){cr===null?cr=[t]:cr.push(t)}function db(t){Qh=!0,RT(t)}function Cs(){if(!_f&&cr!==null){_f=!0;var t=0,e=Ae;try{var n=cr;for(Ae=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}cr=null,Qh=!1}catch(s){throw cr!==null&&(cr=cr.slice(t+1)),tT(qm,Cs),s}finally{Ae=e,_f=!1}}return null}var oo=[],ao=0,rh=null,sh=0,yn=[],_n=0,ci=null,fr=1,pr="";function Us(t,e){oo[ao++]=sh,oo[ao++]=rh,rh=t,sh=e}function PT(t,e,n){yn[_n++]=fr,yn[_n++]=pr,yn[_n++]=ci,ci=t;var r=fr;t=pr;var s=32-Mn(r)-1;r&=~(1<<s),n+=1;var i=32-Mn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,fr=1<<32-Mn(e)+s|n<<s|r,pr=i+t}else fr=1<<i|n<<s|r,pr=t}function eg(t){t.return!==null&&(Us(t,1),PT(t,1,0))}function tg(t){for(;t===rh;)rh=oo[--ao],oo[ao]=null,sh=oo[--ao],oo[ao]=null;for(;t===ci;)ci=yn[--_n],yn[_n]=null,pr=yn[--_n],yn[_n]=null,fr=yn[--_n],yn[_n]=null}var cn=null,an=null,Fe=!1,jn=null;function NT(t,e){var n=wn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function vv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,cn=t,an=ls(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,cn=t,an=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ci!==null?{id:fr,overflow:pr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=wn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,cn=t,an=null,!0):!1;default:return!1}}function Ap(t){return(t.mode&1)!==0&&(t.flags&128)===0}function bp(t){if(Fe){var e=an;if(e){var n=e;if(!vv(t,e)){if(Ap(t))throw Error($(418));e=ls(n.nextSibling);var r=cn;e&&vv(t,e)?NT(r,n):(t.flags=t.flags&-4097|2,Fe=!1,cn=t)}}else{if(Ap(t))throw Error($(418));t.flags=t.flags&-4097|2,Fe=!1,cn=t}}}function wv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;cn=t}function Gu(t){if(t!==cn)return!1;if(!Fe)return wv(t),Fe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!xp(t.type,t.memoizedProps)),e&&(e=an)){if(Ap(t))throw DT(),Error($(418));for(;e;)NT(t,e),e=ls(e.nextSibling)}if(wv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error($(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){an=ls(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}an=null}}else an=cn?ls(t.stateNode.nextSibling):null;return!0}function DT(){for(var t=an;t;)t=ls(t.nextSibling)}function bo(){an=cn=null,Fe=!1}function ng(t){jn===null?jn=[t]:jn.push(t)}var fb=Pr.ReactCurrentBatchConfig;function ka(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error($(309));var r=n.stateNode}if(!r)throw Error($(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error($(284));if(!n._owner)throw Error($(290,t))}return t}function Qu(t,e){throw t=Object.prototype.toString.call(e),Error($(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ev(t){var e=t._init;return e(t._payload)}function jT(t){function e(T,w){if(t){var E=T.deletions;E===null?(T.deletions=[w],T.flags|=16):E.push(w)}}function n(T,w){if(!t)return null;for(;w!==null;)e(T,w),w=w.sibling;return null}function r(T,w){for(T=new Map;w!==null;)w.key!==null?T.set(w.key,w):T.set(w.index,w),w=w.sibling;return T}function s(T,w){return T=ds(T,w),T.index=0,T.sibling=null,T}function i(T,w,E){return T.index=E,t?(E=T.alternate,E!==null?(E=E.index,E<w?(T.flags|=2,w):E):(T.flags|=2,w)):(T.flags|=1048576,w)}function o(T){return t&&T.alternate===null&&(T.flags|=2),T}function a(T,w,E,N){return w===null||w.tag!==6?(w=Sf(E,T.mode,N),w.return=T,w):(w=s(w,E),w.return=T,w)}function l(T,w,E,N){var j=E.type;return j===eo?d(T,w,E.props.children,N,E.key):w!==null&&(w.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Gr&&Ev(j)===w.type)?(N=s(w,E.props),N.ref=ka(T,w,E),N.return=T,N):(N=xc(E.type,E.key,E.props,null,T.mode,N),N.ref=ka(T,w,E),N.return=T,N)}function h(T,w,E,N){return w===null||w.tag!==4||w.stateNode.containerInfo!==E.containerInfo||w.stateNode.implementation!==E.implementation?(w=kf(E,T.mode,N),w.return=T,w):(w=s(w,E.children||[]),w.return=T,w)}function d(T,w,E,N,j){return w===null||w.tag!==7?(w=ri(E,T.mode,N,j),w.return=T,w):(w=s(w,E),w.return=T,w)}function p(T,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Sf(""+w,T.mode,E),w.return=T,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ou:return E=xc(w.type,w.key,w.props,null,T.mode,E),E.ref=ka(T,null,w),E.return=T,E;case Zi:return w=kf(w,T.mode,E),w.return=T,w;case Gr:var N=w._init;return p(T,N(w._payload),E)}if(Ua(w)||Ea(w))return w=ri(w,T.mode,E,null),w.return=T,w;Qu(T,w)}return null}function m(T,w,E,N){var j=w!==null?w.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return j!==null?null:a(T,w,""+E,N);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ou:return E.key===j?l(T,w,E,N):null;case Zi:return E.key===j?h(T,w,E,N):null;case Gr:return j=E._init,m(T,w,j(E._payload),N)}if(Ua(E)||Ea(E))return j!==null?null:d(T,w,E,N,null);Qu(T,E)}return null}function _(T,w,E,N,j){if(typeof N=="string"&&N!==""||typeof N=="number")return T=T.get(E)||null,a(w,T,""+N,j);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Ou:return T=T.get(N.key===null?E:N.key)||null,l(w,T,N,j);case Zi:return T=T.get(N.key===null?E:N.key)||null,h(w,T,N,j);case Gr:var F=N._init;return _(T,w,E,F(N._payload),j)}if(Ua(N)||Ea(N))return T=T.get(E)||null,d(w,T,N,j,null);Qu(w,N)}return null}function k(T,w,E,N){for(var j=null,F=null,S=w,y=w=0,v=null;S!==null&&y<E.length;y++){S.index>y?(v=S,S=null):v=S.sibling;var C=m(T,S,E[y],N);if(C===null){S===null&&(S=v);break}t&&S&&C.alternate===null&&e(T,S),w=i(C,w,y),F===null?j=C:F.sibling=C,F=C,S=v}if(y===E.length)return n(T,S),Fe&&Us(T,y),j;if(S===null){for(;y<E.length;y++)S=p(T,E[y],N),S!==null&&(w=i(S,w,y),F===null?j=S:F.sibling=S,F=S);return Fe&&Us(T,y),j}for(S=r(T,S);y<E.length;y++)v=_(S,T,y,E[y],N),v!==null&&(t&&v.alternate!==null&&S.delete(v.key===null?y:v.key),w=i(v,w,y),F===null?j=v:F.sibling=v,F=v);return t&&S.forEach(function(R){return e(T,R)}),Fe&&Us(T,y),j}function A(T,w,E,N){var j=Ea(E);if(typeof j!="function")throw Error($(150));if(E=j.call(E),E==null)throw Error($(151));for(var F=j=null,S=w,y=w=0,v=null,C=E.next();S!==null&&!C.done;y++,C=E.next()){S.index>y?(v=S,S=null):v=S.sibling;var R=m(T,S,C.value,N);if(R===null){S===null&&(S=v);break}t&&S&&R.alternate===null&&e(T,S),w=i(R,w,y),F===null?j=R:F.sibling=R,F=R,S=v}if(C.done)return n(T,S),Fe&&Us(T,y),j;if(S===null){for(;!C.done;y++,C=E.next())C=p(T,C.value,N),C!==null&&(w=i(C,w,y),F===null?j=C:F.sibling=C,F=C);return Fe&&Us(T,y),j}for(S=r(T,S);!C.done;y++,C=E.next())C=_(S,T,y,C.value,N),C!==null&&(t&&C.alternate!==null&&S.delete(C.key===null?y:C.key),w=i(C,w,y),F===null?j=C:F.sibling=C,F=C);return t&&S.forEach(function(D){return e(T,D)}),Fe&&Us(T,y),j}function b(T,w,E,N){if(typeof E=="object"&&E!==null&&E.type===eo&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Ou:e:{for(var j=E.key,F=w;F!==null;){if(F.key===j){if(j=E.type,j===eo){if(F.tag===7){n(T,F.sibling),w=s(F,E.props.children),w.return=T,T=w;break e}}else if(F.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Gr&&Ev(j)===F.type){n(T,F.sibling),w=s(F,E.props),w.ref=ka(T,F,E),w.return=T,T=w;break e}n(T,F);break}else e(T,F);F=F.sibling}E.type===eo?(w=ri(E.props.children,T.mode,N,E.key),w.return=T,T=w):(N=xc(E.type,E.key,E.props,null,T.mode,N),N.ref=ka(T,w,E),N.return=T,T=N)}return o(T);case Zi:e:{for(F=E.key;w!==null;){if(w.key===F)if(w.tag===4&&w.stateNode.containerInfo===E.containerInfo&&w.stateNode.implementation===E.implementation){n(T,w.sibling),w=s(w,E.children||[]),w.return=T,T=w;break e}else{n(T,w);break}else e(T,w);w=w.sibling}w=kf(E,T.mode,N),w.return=T,T=w}return o(T);case Gr:return F=E._init,b(T,w,F(E._payload),N)}if(Ua(E))return k(T,w,E,N);if(Ea(E))return A(T,w,E,N);Qu(T,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,w!==null&&w.tag===6?(n(T,w.sibling),w=s(w,E),w.return=T,T=w):(n(T,w),w=Sf(E,T.mode,N),w.return=T,T=w),o(T)):n(T,w)}return b}var Ro=jT(!0),LT=jT(!1),ih=ks(null),oh=null,lo=null,rg=null;function sg(){rg=lo=oh=null}function ig(t){var e=ih.current;Le(ih),t._currentValue=e}function Rp(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function yo(t,e){oh=t,rg=lo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Yt=!0),t.firstContext=null)}function xn(t){var e=t._currentValue;if(rg!==t)if(t={context:t,memoizedValue:e,next:null},lo===null){if(oh===null)throw Error($(308));lo=t,oh.dependencies={lanes:0,firstContext:t}}else lo=lo.next=t;return e}var Js=null;function og(t){Js===null?Js=[t]:Js.push(t)}function VT(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,og(e)):(n.next=s.next,s.next=n),e.interleaved=n,xr(t,r)}function xr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Qr=!1;function ag(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function MT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function _r(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function us(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Te&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,xr(t,n)}return s=r.interleaved,s===null?(e.next=e,og(r)):(e.next=s.next,s.next=e),r.interleaved=e,xr(t,n)}function _c(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Wm(t,n)}}function Tv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ah(t,e,n,r){var s=t.updateQueue;Qr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,h=l.next;l.next=null,o===null?i=h:o.next=h,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=h:a.next=h,d.lastBaseUpdate=l))}if(i!==null){var p=s.baseState;o=0,d=h=l=null,a=i;do{var m=a.lane,_=a.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var k=t,A=a;switch(m=e,_=n,A.tag){case 1:if(k=A.payload,typeof k=="function"){p=k.call(_,p,m);break e}p=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=A.payload,m=typeof k=="function"?k.call(_,p,m):k,m==null)break e;p=qe({},p,m);break e;case 2:Qr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else _={eventTime:_,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(h=d=_,l=p):d=d.next=_,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(d===null&&(l=p),s.baseState=l,s.firstBaseUpdate=h,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);di|=o,t.lanes=o,t.memoizedState=p}}function Iv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error($(191,s));s.call(r)}}}var nu={},Jn=ks(nu),bl=ks(nu),Rl=ks(nu);function Zs(t){if(t===nu)throw Error($(174));return t}function lg(t,e){switch(Pe(Rl,e),Pe(bl,t),Pe(Jn,nu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:cp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=cp(e,t)}Le(Jn),Pe(Jn,e)}function Po(){Le(Jn),Le(bl),Le(Rl)}function OT(t){Zs(Rl.current);var e=Zs(Jn.current),n=cp(e,t.type);e!==n&&(Pe(bl,t),Pe(Jn,n))}function ug(t){bl.current===t&&(Le(Jn),Le(bl))}var Be=ks(0);function lh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var vf=[];function cg(){for(var t=0;t<vf.length;t++)vf[t]._workInProgressVersionPrimary=null;vf.length=0}var vc=Pr.ReactCurrentDispatcher,wf=Pr.ReactCurrentBatchConfig,hi=0,$e=null,ct=null,vt=null,uh=!1,rl=!1,Pl=0,pb=0;function At(){throw Error($(321))}function hg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Fn(t[n],e[n]))return!1;return!0}function dg(t,e,n,r,s,i){if(hi=i,$e=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,vc.current=t===null||t.memoizedState===null?_b:vb,t=n(r,s),rl){i=0;do{if(rl=!1,Pl=0,25<=i)throw Error($(301));i+=1,vt=ct=null,e.updateQueue=null,vc.current=wb,t=n(r,s)}while(rl)}if(vc.current=ch,e=ct!==null&&ct.next!==null,hi=0,vt=ct=$e=null,uh=!1,e)throw Error($(300));return t}function fg(){var t=Pl!==0;return Pl=0,t}function qn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?$e.memoizedState=vt=t:vt=vt.next=t,vt}function Sn(){if(ct===null){var t=$e.alternate;t=t!==null?t.memoizedState:null}else t=ct.next;var e=vt===null?$e.memoizedState:vt.next;if(e!==null)vt=e,ct=t;else{if(t===null)throw Error($(310));ct=t,t={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},vt===null?$e.memoizedState=vt=t:vt=vt.next=t}return vt}function Nl(t,e){return typeof e=="function"?e(t):e}function Ef(t){var e=Sn(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=ct,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,h=i;do{var d=h.lane;if((hi&d)===d)l!==null&&(l=l.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var p={lane:d,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};l===null?(a=l=p,o=r):l=l.next=p,$e.lanes|=d,di|=d}h=h.next}while(h!==null&&h!==i);l===null?o=r:l.next=a,Fn(r,e.memoizedState)||(Yt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,$e.lanes|=i,di|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Tf(t){var e=Sn(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Fn(i,e.memoizedState)||(Yt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function FT(){}function UT(t,e){var n=$e,r=Sn(),s=e(),i=!Fn(r.memoizedState,s);if(i&&(r.memoizedState=s,Yt=!0),r=r.queue,pg($T.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||vt!==null&&vt.memoizedState.tag&1){if(n.flags|=2048,Dl(9,zT.bind(null,n,r,s,e),void 0,null),wt===null)throw Error($(349));hi&30||BT(n,e,s)}return s}function BT(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function zT(t,e,n,r){e.value=n,e.getSnapshot=r,HT(e)&&qT(t)}function $T(t,e,n){return n(function(){HT(e)&&qT(t)})}function HT(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Fn(t,n)}catch{return!0}}function qT(t){var e=xr(t,1);e!==null&&On(e,t,1,-1)}function xv(t){var e=qn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nl,lastRenderedState:t},e.queue=t,t=t.dispatch=yb.bind(null,$e,t),[e.memoizedState,t]}function Dl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function WT(){return Sn().memoizedState}function wc(t,e,n,r){var s=qn();$e.flags|=t,s.memoizedState=Dl(1|e,n,void 0,r===void 0?null:r)}function Xh(t,e,n,r){var s=Sn();r=r===void 0?null:r;var i=void 0;if(ct!==null){var o=ct.memoizedState;if(i=o.destroy,r!==null&&hg(r,o.deps)){s.memoizedState=Dl(e,n,i,r);return}}$e.flags|=t,s.memoizedState=Dl(1|e,n,i,r)}function Sv(t,e){return wc(8390656,8,t,e)}function pg(t,e){return Xh(2048,8,t,e)}function KT(t,e){return Xh(4,2,t,e)}function GT(t,e){return Xh(4,4,t,e)}function QT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function XT(t,e,n){return n=n!=null?n.concat([t]):null,Xh(4,4,QT.bind(null,e,t),n)}function mg(){}function YT(t,e){var n=Sn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&hg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function JT(t,e){var n=Sn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&hg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function ZT(t,e,n){return hi&21?(Fn(n,e)||(n=sT(),$e.lanes|=n,di|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Yt=!0),t.memoizedState=n)}function mb(t,e){var n=Ae;Ae=n!==0&&4>n?n:4,t(!0);var r=wf.transition;wf.transition={};try{t(!1),e()}finally{Ae=n,wf.transition=r}}function eI(){return Sn().memoizedState}function gb(t,e,n){var r=hs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},tI(t))nI(e,n);else if(n=VT(t,e,n,r),n!==null){var s=$t();On(n,t,r,s),rI(n,e,r)}}function yb(t,e,n){var r=hs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(tI(t))nI(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Fn(a,o)){var l=e.interleaved;l===null?(s.next=s,og(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=VT(t,e,s,r),n!==null&&(s=$t(),On(n,t,r,s),rI(n,e,r))}}function tI(t){var e=t.alternate;return t===$e||e!==null&&e===$e}function nI(t,e){rl=uh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function rI(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Wm(t,n)}}var ch={readContext:xn,useCallback:At,useContext:At,useEffect:At,useImperativeHandle:At,useInsertionEffect:At,useLayoutEffect:At,useMemo:At,useReducer:At,useRef:At,useState:At,useDebugValue:At,useDeferredValue:At,useTransition:At,useMutableSource:At,useSyncExternalStore:At,useId:At,unstable_isNewReconciler:!1},_b={readContext:xn,useCallback:function(t,e){return qn().memoizedState=[t,e===void 0?null:e],t},useContext:xn,useEffect:Sv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,wc(4194308,4,QT.bind(null,e,t),n)},useLayoutEffect:function(t,e){return wc(4194308,4,t,e)},useInsertionEffect:function(t,e){return wc(4,2,t,e)},useMemo:function(t,e){var n=qn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=qn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=gb.bind(null,$e,t),[r.memoizedState,t]},useRef:function(t){var e=qn();return t={current:t},e.memoizedState=t},useState:xv,useDebugValue:mg,useDeferredValue:function(t){return qn().memoizedState=t},useTransition:function(){var t=xv(!1),e=t[0];return t=mb.bind(null,t[1]),qn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=$e,s=qn();if(Fe){if(n===void 0)throw Error($(407));n=n()}else{if(n=e(),wt===null)throw Error($(349));hi&30||BT(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Sv($T.bind(null,r,i,t),[t]),r.flags|=2048,Dl(9,zT.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=qn(),e=wt.identifierPrefix;if(Fe){var n=pr,r=fr;n=(r&~(1<<32-Mn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Pl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=pb++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},vb={readContext:xn,useCallback:YT,useContext:xn,useEffect:pg,useImperativeHandle:XT,useInsertionEffect:KT,useLayoutEffect:GT,useMemo:JT,useReducer:Ef,useRef:WT,useState:function(){return Ef(Nl)},useDebugValue:mg,useDeferredValue:function(t){var e=Sn();return ZT(e,ct.memoizedState,t)},useTransition:function(){var t=Ef(Nl)[0],e=Sn().memoizedState;return[t,e]},useMutableSource:FT,useSyncExternalStore:UT,useId:eI,unstable_isNewReconciler:!1},wb={readContext:xn,useCallback:YT,useContext:xn,useEffect:pg,useImperativeHandle:XT,useInsertionEffect:KT,useLayoutEffect:GT,useMemo:JT,useReducer:Tf,useRef:WT,useState:function(){return Tf(Nl)},useDebugValue:mg,useDeferredValue:function(t){var e=Sn();return ct===null?e.memoizedState=t:ZT(e,ct.memoizedState,t)},useTransition:function(){var t=Tf(Nl)[0],e=Sn().memoizedState;return[t,e]},useMutableSource:FT,useSyncExternalStore:UT,useId:eI,unstable_isNewReconciler:!1};function Pn(t,e){if(t&&t.defaultProps){e=qe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Pp(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:qe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Yh={isMounted:function(t){return(t=t._reactInternals)?Ai(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=$t(),s=hs(t),i=_r(r,s);i.payload=e,n!=null&&(i.callback=n),e=us(t,i,s),e!==null&&(On(e,t,s,r),_c(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=$t(),s=hs(t),i=_r(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=us(t,i,s),e!==null&&(On(e,t,s,r),_c(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=$t(),r=hs(t),s=_r(n,r);s.tag=2,e!=null&&(s.callback=e),e=us(t,s,r),e!==null&&(On(e,t,r,n),_c(e,t,r))}};function kv(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Sl(n,r)||!Sl(s,i):!0}function sI(t,e,n){var r=!1,s=vs,i=e.contextType;return typeof i=="object"&&i!==null?i=xn(i):(s=en(e)?ui:Vt.current,r=e.contextTypes,i=(r=r!=null)?Ao(t,s):vs),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Yh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Cv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Yh.enqueueReplaceState(e,e.state,null)}function Np(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},ag(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=xn(i):(i=en(e)?ui:Vt.current,s.context=Ao(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Pp(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Yh.enqueueReplaceState(s,s.state,null),ah(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function No(t,e){try{var n="",r=e;do n+=GC(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function If(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Dp(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Eb=typeof WeakMap=="function"?WeakMap:Map;function iI(t,e,n){n=_r(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){dh||(dh=!0,$p=r),Dp(t,e)},n}function oI(t,e,n){n=_r(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Dp(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Dp(t,e),typeof r!="function"&&(cs===null?cs=new Set([this]):cs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Av(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Eb;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=Lb.bind(null,t,e,n),e.then(t,t))}function bv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Rv(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=_r(-1,1),e.tag=2,us(n,e,1))),n.lanes|=1),t)}var Tb=Pr.ReactCurrentOwner,Yt=!1;function Ut(t,e,n,r){e.child=t===null?LT(e,null,n,r):Ro(e,t.child,n,r)}function Pv(t,e,n,r,s){n=n.render;var i=e.ref;return yo(e,s),r=dg(t,e,n,r,i,s),n=fg(),t!==null&&!Yt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Sr(t,e,s)):(Fe&&n&&eg(e),e.flags|=1,Ut(t,e,r,s),e.child)}function Nv(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Ig(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,aI(t,e,i,r,s)):(t=xc(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Sl,n(o,r)&&t.ref===e.ref)return Sr(t,e,s)}return e.flags|=1,t=ds(i,r),t.ref=e.ref,t.return=e,e.child=t}function aI(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Sl(i,r)&&t.ref===e.ref)if(Yt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Yt=!0);else return e.lanes=t.lanes,Sr(t,e,s)}return jp(t,e,n,r,s)}function lI(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(co,rn),rn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Pe(co,rn),rn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Pe(co,rn),rn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Pe(co,rn),rn|=r;return Ut(t,e,s,n),e.child}function uI(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function jp(t,e,n,r,s){var i=en(n)?ui:Vt.current;return i=Ao(e,i),yo(e,s),n=dg(t,e,n,r,i,s),r=fg(),t!==null&&!Yt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Sr(t,e,s)):(Fe&&r&&eg(e),e.flags|=1,Ut(t,e,n,s),e.child)}function Dv(t,e,n,r,s){if(en(n)){var i=!0;nh(e)}else i=!1;if(yo(e,s),e.stateNode===null)Ec(t,e),sI(e,n,r),Np(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=xn(h):(h=en(n)?ui:Vt.current,h=Ao(e,h));var d=n.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==h)&&Cv(e,o,r,h),Qr=!1;var m=e.memoizedState;o.state=m,ah(e,r,o,s),l=e.memoizedState,a!==r||m!==l||Zt.current||Qr?(typeof d=="function"&&(Pp(e,n,d,r),l=e.memoizedState),(a=Qr||kv(e,n,a,r,m,l,h))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=h,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,MT(t,e),a=e.memoizedProps,h=e.type===e.elementType?a:Pn(e.type,a),o.props=h,p=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=xn(l):(l=en(n)?ui:Vt.current,l=Ao(e,l));var _=n.getDerivedStateFromProps;(d=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||m!==l)&&Cv(e,o,r,l),Qr=!1,m=e.memoizedState,o.state=m,ah(e,r,o,s);var k=e.memoizedState;a!==p||m!==k||Zt.current||Qr?(typeof _=="function"&&(Pp(e,n,_,r),k=e.memoizedState),(h=Qr||kv(e,n,h,r,m,k,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,k,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,k,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=k),o.props=r,o.state=k,o.context=l,r=h):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Lp(t,e,n,r,i,s)}function Lp(t,e,n,r,s,i){uI(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&_v(e,n,!1),Sr(t,e,i);r=e.stateNode,Tb.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ro(e,t.child,null,i),e.child=Ro(e,null,a,i)):Ut(t,e,a,i),e.memoizedState=r.state,s&&_v(e,n,!0),e.child}function cI(t){var e=t.stateNode;e.pendingContext?yv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&yv(t,e.context,!1),lg(t,e.containerInfo)}function jv(t,e,n,r,s){return bo(),ng(s),e.flags|=256,Ut(t,e,n,r),e.child}var Vp={dehydrated:null,treeContext:null,retryLane:0};function Mp(t){return{baseLanes:t,cachePool:null,transitions:null}}function hI(t,e,n){var r=e.pendingProps,s=Be.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Pe(Be,s&1),t===null)return bp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=ed(o,r,0,null),t=ri(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Mp(n),e.memoizedState=Vp,t):gg(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Ib(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ds(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ds(a,i):(i=ri(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Mp(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Vp,r}return i=t.child,t=i.sibling,r=ds(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function gg(t,e){return e=ed({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Xu(t,e,n,r){return r!==null&&ng(r),Ro(e,t.child,null,n),t=gg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Ib(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=If(Error($(422))),Xu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=ed({mode:"visible",children:r.children},s,0,null),i=ri(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ro(e,t.child,null,o),e.child.memoizedState=Mp(o),e.memoizedState=Vp,i);if(!(e.mode&1))return Xu(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error($(419)),r=If(i,r,void 0),Xu(t,e,o,r)}if(a=(o&t.childLanes)!==0,Yt||a){if(r=wt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,xr(t,s),On(r,t,s,-1))}return Tg(),r=If(Error($(421))),Xu(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Vb.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,an=ls(s.nextSibling),cn=e,Fe=!0,jn=null,t!==null&&(yn[_n++]=fr,yn[_n++]=pr,yn[_n++]=ci,fr=t.id,pr=t.overflow,ci=e),e=gg(e,r.children),e.flags|=4096,e)}function Lv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Rp(t.return,e,n)}function xf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function dI(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Ut(t,e,r.children,n),r=Be.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Lv(t,n,e);else if(t.tag===19)Lv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Pe(Be,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&lh(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),xf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&lh(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}xf(e,!0,n,null,i);break;case"together":xf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ec(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Sr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),di|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error($(153));if(e.child!==null){for(t=e.child,n=ds(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ds(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function xb(t,e,n){switch(e.tag){case 3:cI(e),bo();break;case 5:OT(e);break;case 1:en(e.type)&&nh(e);break;case 4:lg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Pe(ih,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Pe(Be,Be.current&1),e.flags|=128,null):n&e.child.childLanes?hI(t,e,n):(Pe(Be,Be.current&1),t=Sr(t,e,n),t!==null?t.sibling:null);Pe(Be,Be.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return dI(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Pe(Be,Be.current),r)break;return null;case 22:case 23:return e.lanes=0,lI(t,e,n)}return Sr(t,e,n)}var fI,Op,pI,mI;fI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Op=function(){};pI=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Zs(Jn.current);var i=null;switch(n){case"input":s=op(t,s),r=op(t,r),i=[];break;case"select":s=qe({},s,{value:void 0}),r=qe({},r,{value:void 0}),i=[];break;case"textarea":s=up(t,s),r=up(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=eh)}hp(n,r);var o;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var a=s[h];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(_l.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var l=r[h];if(a=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&l!==a&&(l!=null||a!=null))if(h==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(h,n)),n=l;else h==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(h,l)):h==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(h,""+l):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(_l.hasOwnProperty(h)?(l!=null&&h==="onScroll"&&je("scroll",t),i||a===l||(i=[])):(i=i||[]).push(h,l))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};mI=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ca(t,e){if(!Fe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Sb(t,e,n){var r=e.pendingProps;switch(tg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(e),null;case 1:return en(e.type)&&th(),bt(e),null;case 3:return r=e.stateNode,Po(),Le(Zt),Le(Vt),cg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Gu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,jn!==null&&(Wp(jn),jn=null))),Op(t,e),bt(e),null;case 5:ug(e);var s=Zs(Rl.current);if(n=e.type,t!==null&&e.stateNode!=null)pI(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error($(166));return bt(e),null}if(t=Zs(Jn.current),Gu(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Kn]=e,r[Al]=i,t=(e.mode&1)!==0,n){case"dialog":je("cancel",r),je("close",r);break;case"iframe":case"object":case"embed":je("load",r);break;case"video":case"audio":for(s=0;s<za.length;s++)je(za[s],r);break;case"source":je("error",r);break;case"img":case"image":case"link":je("error",r),je("load",r);break;case"details":je("toggle",r);break;case"input":H_(r,i),je("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},je("invalid",r);break;case"textarea":W_(r,i),je("invalid",r)}hp(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Ku(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Ku(r.textContent,a,t),s=["children",""+a]):_l.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&je("scroll",r)}switch(n){case"input":Fu(r),q_(r,i,!0);break;case"textarea":Fu(r),K_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=eh)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=$E(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Kn]=e,t[Al]=r,fI(t,e,!1,!1),e.stateNode=t;e:{switch(o=dp(n,r),n){case"dialog":je("cancel",t),je("close",t),s=r;break;case"iframe":case"object":case"embed":je("load",t),s=r;break;case"video":case"audio":for(s=0;s<za.length;s++)je(za[s],t);s=r;break;case"source":je("error",t),s=r;break;case"img":case"image":case"link":je("error",t),je("load",t),s=r;break;case"details":je("toggle",t),s=r;break;case"input":H_(t,r),s=op(t,r),je("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=qe({},r,{value:void 0}),je("invalid",t);break;case"textarea":W_(t,r),s=up(t,r),je("invalid",t);break;default:s=r}hp(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?WE(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&HE(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&vl(t,l):typeof l=="number"&&vl(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(_l.hasOwnProperty(i)?l!=null&&i==="onScroll"&&je("scroll",t):l!=null&&Um(t,i,l,o))}switch(n){case"input":Fu(t),q_(t,r,!1);break;case"textarea":Fu(t),K_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+_s(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?fo(t,!!r.multiple,i,!1):r.defaultValue!=null&&fo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=eh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bt(e),null;case 6:if(t&&e.stateNode!=null)mI(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error($(166));if(n=Zs(Rl.current),Zs(Jn.current),Gu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Kn]=e,(i=r.nodeValue!==n)&&(t=cn,t!==null))switch(t.tag){case 3:Ku(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ku(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Kn]=e,e.stateNode=r}return bt(e),null;case 13:if(Le(Be),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Fe&&an!==null&&e.mode&1&&!(e.flags&128))DT(),bo(),e.flags|=98560,i=!1;else if(i=Gu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error($(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));i[Kn]=e}else bo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bt(e),i=!1}else jn!==null&&(Wp(jn),jn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Be.current&1?ht===0&&(ht=3):Tg())),e.updateQueue!==null&&(e.flags|=4),bt(e),null);case 4:return Po(),Op(t,e),t===null&&kl(e.stateNode.containerInfo),bt(e),null;case 10:return ig(e.type._context),bt(e),null;case 17:return en(e.type)&&th(),bt(e),null;case 19:if(Le(Be),i=e.memoizedState,i===null)return bt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Ca(i,!1);else{if(ht!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=lh(t),o!==null){for(e.flags|=128,Ca(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Pe(Be,Be.current&1|2),e.child}t=t.sibling}i.tail!==null&&Je()>Do&&(e.flags|=128,r=!0,Ca(i,!1),e.lanes=4194304)}else{if(!r)if(t=lh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ca(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Fe)return bt(e),null}else 2*Je()-i.renderingStartTime>Do&&n!==1073741824&&(e.flags|=128,r=!0,Ca(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Je(),e.sibling=null,n=Be.current,Pe(Be,r?n&1|2:n&1),e):(bt(e),null);case 22:case 23:return Eg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?rn&1073741824&&(bt(e),e.subtreeFlags&6&&(e.flags|=8192)):bt(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function kb(t,e){switch(tg(e),e.tag){case 1:return en(e.type)&&th(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Po(),Le(Zt),Le(Vt),cg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ug(e),null;case 13:if(Le(Be),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error($(340));bo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Le(Be),null;case 4:return Po(),null;case 10:return ig(e.type._context),null;case 22:case 23:return Eg(),null;case 24:return null;default:return null}}var Yu=!1,Nt=!1,Cb=typeof WeakSet=="function"?WeakSet:Set,te=null;function uo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xe(t,e,r)}else n.current=null}function Fp(t,e,n){try{n()}catch(r){Xe(t,e,r)}}var Vv=!1;function Ab(t,e){if(Tp=Yc,t=wT(),Zm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,h=0,d=0,p=t,m=null;t:for(;;){for(var _;p!==n||s!==0&&p.nodeType!==3||(a=o+s),p!==i||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(_=p.firstChild)!==null;)m=p,p=_;for(;;){if(p===t)break t;if(m===n&&++h===s&&(a=o),m===i&&++d===r&&(l=o),(_=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=_}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ip={focusedElem:t,selectionRange:n},Yc=!1,te=e;te!==null;)if(e=te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,te=t;else for(;te!==null;){e=te;try{var k=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var A=k.memoizedProps,b=k.memoizedState,T=e.stateNode,w=T.getSnapshotBeforeUpdate(e.elementType===e.type?A:Pn(e.type,A),b);T.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(N){Xe(e,e.return,N)}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}return k=Vv,Vv=!1,k}function sl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Fp(e,n,i)}s=s.next}while(s!==r)}}function Jh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Up(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function gI(t){var e=t.alternate;e!==null&&(t.alternate=null,gI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Kn],delete e[Al],delete e[kp],delete e[cb],delete e[hb])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yI(t){return t.tag===5||t.tag===3||t.tag===4}function Mv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||yI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Bp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=eh));else if(r!==4&&(t=t.child,t!==null))for(Bp(t,e,n),t=t.sibling;t!==null;)Bp(t,e,n),t=t.sibling}function zp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(zp(t,e,n),t=t.sibling;t!==null;)zp(t,e,n),t=t.sibling}var It=null,Nn=!1;function zr(t,e,n){for(n=n.child;n!==null;)_I(t,e,n),n=n.sibling}function _I(t,e,n){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(Hh,n)}catch{}switch(n.tag){case 5:Nt||uo(n,e);case 6:var r=It,s=Nn;It=null,zr(t,e,n),It=r,Nn=s,It!==null&&(Nn?(t=It,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):It.removeChild(n.stateNode));break;case 18:It!==null&&(Nn?(t=It,n=n.stateNode,t.nodeType===8?yf(t.parentNode,n):t.nodeType===1&&yf(t,n),Il(t)):yf(It,n.stateNode));break;case 4:r=It,s=Nn,It=n.stateNode.containerInfo,Nn=!0,zr(t,e,n),It=r,Nn=s;break;case 0:case 11:case 14:case 15:if(!Nt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Fp(n,e,o),s=s.next}while(s!==r)}zr(t,e,n);break;case 1:if(!Nt&&(uo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Xe(n,e,a)}zr(t,e,n);break;case 21:zr(t,e,n);break;case 22:n.mode&1?(Nt=(r=Nt)||n.memoizedState!==null,zr(t,e,n),Nt=r):zr(t,e,n);break;default:zr(t,e,n)}}function Ov(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Cb),e.forEach(function(r){var s=Mb.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Rn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:It=a.stateNode,Nn=!1;break e;case 3:It=a.stateNode.containerInfo,Nn=!0;break e;case 4:It=a.stateNode.containerInfo,Nn=!0;break e}a=a.return}if(It===null)throw Error($(160));_I(i,o,s),It=null,Nn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(h){Xe(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)vI(e,t),e=e.sibling}function vI(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Rn(e,t),$n(t),r&4){try{sl(3,t,t.return),Jh(3,t)}catch(A){Xe(t,t.return,A)}try{sl(5,t,t.return)}catch(A){Xe(t,t.return,A)}}break;case 1:Rn(e,t),$n(t),r&512&&n!==null&&uo(n,n.return);break;case 5:if(Rn(e,t),$n(t),r&512&&n!==null&&uo(n,n.return),t.flags&32){var s=t.stateNode;try{vl(s,"")}catch(A){Xe(t,t.return,A)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&BE(s,i),dp(a,o);var h=dp(a,i);for(o=0;o<l.length;o+=2){var d=l[o],p=l[o+1];d==="style"?WE(s,p):d==="dangerouslySetInnerHTML"?HE(s,p):d==="children"?vl(s,p):Um(s,d,p,h)}switch(a){case"input":ap(s,i);break;case"textarea":zE(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?fo(s,!!i.multiple,_,!1):m!==!!i.multiple&&(i.defaultValue!=null?fo(s,!!i.multiple,i.defaultValue,!0):fo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Al]=i}catch(A){Xe(t,t.return,A)}}break;case 6:if(Rn(e,t),$n(t),r&4){if(t.stateNode===null)throw Error($(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(A){Xe(t,t.return,A)}}break;case 3:if(Rn(e,t),$n(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Il(e.containerInfo)}catch(A){Xe(t,t.return,A)}break;case 4:Rn(e,t),$n(t);break;case 13:Rn(e,t),$n(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(vg=Je())),r&4&&Ov(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Nt=(h=Nt)||d,Rn(e,t),Nt=h):Rn(e,t),$n(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!d&&t.mode&1)for(te=t,d=t.child;d!==null;){for(p=te=d;te!==null;){switch(m=te,_=m.child,m.tag){case 0:case 11:case 14:case 15:sl(4,m,m.return);break;case 1:uo(m,m.return);var k=m.stateNode;if(typeof k.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,k.props=e.memoizedProps,k.state=e.memoizedState,k.componentWillUnmount()}catch(A){Xe(r,n,A)}}break;case 5:uo(m,m.return);break;case 22:if(m.memoizedState!==null){Uv(p);continue}}_!==null?(_.return=m,te=_):Uv(p)}d=d.sibling}e:for(d=null,p=t;;){if(p.tag===5){if(d===null){d=p;try{s=p.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=qE("display",o))}catch(A){Xe(t,t.return,A)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=h?"":p.memoizedProps}catch(A){Xe(t,t.return,A)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Rn(e,t),$n(t),r&4&&Ov(t);break;case 21:break;default:Rn(e,t),$n(t)}}function $n(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(yI(n)){var r=n;break e}n=n.return}throw Error($(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(vl(s,""),r.flags&=-33);var i=Mv(t);zp(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Mv(t);Bp(t,a,o);break;default:throw Error($(161))}}catch(l){Xe(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function bb(t,e,n){te=t,wI(t)}function wI(t,e,n){for(var r=(t.mode&1)!==0;te!==null;){var s=te,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Yu;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Nt;a=Yu;var h=Nt;if(Yu=o,(Nt=l)&&!h)for(te=s;te!==null;)o=te,l=o.child,o.tag===22&&o.memoizedState!==null?Bv(s):l!==null?(l.return=o,te=l):Bv(s);for(;i!==null;)te=i,wI(i),i=i.sibling;te=s,Yu=a,Nt=h}Fv(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,te=i):Fv(t)}}function Fv(t){for(;te!==null;){var e=te;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Nt||Jh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Nt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Pn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Iv(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Iv(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var d=h.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&Il(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}Nt||e.flags&512&&Up(e)}catch(m){Xe(e,e.return,m)}}if(e===t){te=null;break}if(n=e.sibling,n!==null){n.return=e.return,te=n;break}te=e.return}}function Uv(t){for(;te!==null;){var e=te;if(e===t){te=null;break}var n=e.sibling;if(n!==null){n.return=e.return,te=n;break}te=e.return}}function Bv(t){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Jh(4,e)}catch(l){Xe(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Xe(e,s,l)}}var i=e.return;try{Up(e)}catch(l){Xe(e,i,l)}break;case 5:var o=e.return;try{Up(e)}catch(l){Xe(e,o,l)}}}catch(l){Xe(e,e.return,l)}if(e===t){te=null;break}var a=e.sibling;if(a!==null){a.return=e.return,te=a;break}te=e.return}}var Rb=Math.ceil,hh=Pr.ReactCurrentDispatcher,yg=Pr.ReactCurrentOwner,Tn=Pr.ReactCurrentBatchConfig,Te=0,wt=null,rt=null,kt=0,rn=0,co=ks(0),ht=0,jl=null,di=0,Zh=0,_g=0,il=null,Xt=null,vg=0,Do=1/0,ur=null,dh=!1,$p=null,cs=null,Ju=!1,rs=null,fh=0,ol=0,Hp=null,Tc=-1,Ic=0;function $t(){return Te&6?Je():Tc!==-1?Tc:Tc=Je()}function hs(t){return t.mode&1?Te&2&&kt!==0?kt&-kt:fb.transition!==null?(Ic===0&&(Ic=sT()),Ic):(t=Ae,t!==0||(t=window.event,t=t===void 0?16:hT(t.type)),t):1}function On(t,e,n,r){if(50<ol)throw ol=0,Hp=null,Error($(185));Zl(t,n,r),(!(Te&2)||t!==wt)&&(t===wt&&(!(Te&2)&&(Zh|=n),ht===4&&Yr(t,kt)),tn(t,r),n===1&&Te===0&&!(e.mode&1)&&(Do=Je()+500,Qh&&Cs()))}function tn(t,e){var n=t.callbackNode;fA(t,e);var r=Xc(t,t===wt?kt:0);if(r===0)n!==null&&X_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&X_(n),e===1)t.tag===0?db(zv.bind(null,t)):RT(zv.bind(null,t)),lb(function(){!(Te&6)&&Cs()}),n=null;else{switch(iT(r)){case 1:n=qm;break;case 4:n=nT;break;case 16:n=Qc;break;case 536870912:n=rT;break;default:n=Qc}n=AI(n,EI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function EI(t,e){if(Tc=-1,Ic=0,Te&6)throw Error($(327));var n=t.callbackNode;if(_o()&&t.callbackNode!==n)return null;var r=Xc(t,t===wt?kt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ph(t,r);else{e=r;var s=Te;Te|=2;var i=II();(wt!==t||kt!==e)&&(ur=null,Do=Je()+500,ni(t,e));do try{Db();break}catch(a){TI(t,a)}while(!0);sg(),hh.current=i,Te=s,rt!==null?e=0:(wt=null,kt=0,e=ht)}if(e!==0){if(e===2&&(s=yp(t),s!==0&&(r=s,e=qp(t,s))),e===1)throw n=jl,ni(t,0),Yr(t,r),tn(t,Je()),n;if(e===6)Yr(t,r);else{if(s=t.current.alternate,!(r&30)&&!Pb(s)&&(e=ph(t,r),e===2&&(i=yp(t),i!==0&&(r=i,e=qp(t,i))),e===1))throw n=jl,ni(t,0),Yr(t,r),tn(t,Je()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error($(345));case 2:Bs(t,Xt,ur);break;case 3:if(Yr(t,r),(r&130023424)===r&&(e=vg+500-Je(),10<e)){if(Xc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){$t(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Sp(Bs.bind(null,t,Xt,ur),e);break}Bs(t,Xt,ur);break;case 4:if(Yr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Mn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Je()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Rb(r/1960))-r,10<r){t.timeoutHandle=Sp(Bs.bind(null,t,Xt,ur),r);break}Bs(t,Xt,ur);break;case 5:Bs(t,Xt,ur);break;default:throw Error($(329))}}}return tn(t,Je()),t.callbackNode===n?EI.bind(null,t):null}function qp(t,e){var n=il;return t.current.memoizedState.isDehydrated&&(ni(t,e).flags|=256),t=ph(t,e),t!==2&&(e=Xt,Xt=n,e!==null&&Wp(e)),t}function Wp(t){Xt===null?Xt=t:Xt.push.apply(Xt,t)}function Pb(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Fn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Yr(t,e){for(e&=~_g,e&=~Zh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Mn(e),r=1<<n;t[n]=-1,e&=~r}}function zv(t){if(Te&6)throw Error($(327));_o();var e=Xc(t,0);if(!(e&1))return tn(t,Je()),null;var n=ph(t,e);if(t.tag!==0&&n===2){var r=yp(t);r!==0&&(e=r,n=qp(t,r))}if(n===1)throw n=jl,ni(t,0),Yr(t,e),tn(t,Je()),n;if(n===6)throw Error($(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Bs(t,Xt,ur),tn(t,Je()),null}function wg(t,e){var n=Te;Te|=1;try{return t(e)}finally{Te=n,Te===0&&(Do=Je()+500,Qh&&Cs())}}function fi(t){rs!==null&&rs.tag===0&&!(Te&6)&&_o();var e=Te;Te|=1;var n=Tn.transition,r=Ae;try{if(Tn.transition=null,Ae=1,t)return t()}finally{Ae=r,Tn.transition=n,Te=e,!(Te&6)&&Cs()}}function Eg(){rn=co.current,Le(co)}function ni(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,ab(n)),rt!==null)for(n=rt.return;n!==null;){var r=n;switch(tg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&th();break;case 3:Po(),Le(Zt),Le(Vt),cg();break;case 5:ug(r);break;case 4:Po();break;case 13:Le(Be);break;case 19:Le(Be);break;case 10:ig(r.type._context);break;case 22:case 23:Eg()}n=n.return}if(wt=t,rt=t=ds(t.current,null),kt=rn=e,ht=0,jl=null,_g=Zh=di=0,Xt=il=null,Js!==null){for(e=0;e<Js.length;e++)if(n=Js[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Js=null}return t}function TI(t,e){do{var n=rt;try{if(sg(),vc.current=ch,uh){for(var r=$e.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}uh=!1}if(hi=0,vt=ct=$e=null,rl=!1,Pl=0,yg.current=null,n===null||n.return===null){ht=1,jl=e,rt=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=kt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var h=l,d=a,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var _=bv(o);if(_!==null){_.flags&=-257,Rv(_,o,a,i,e),_.mode&1&&Av(i,h,e),e=_,l=h;var k=e.updateQueue;if(k===null){var A=new Set;A.add(l),e.updateQueue=A}else k.add(l);break e}else{if(!(e&1)){Av(i,h,e),Tg();break e}l=Error($(426))}}else if(Fe&&a.mode&1){var b=bv(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),Rv(b,o,a,i,e),ng(No(l,a));break e}}i=l=No(l,a),ht!==4&&(ht=2),il===null?il=[i]:il.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=iI(i,l,e);Tv(i,T);break e;case 1:a=l;var w=i.type,E=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(cs===null||!cs.has(E)))){i.flags|=65536,e&=-e,i.lanes|=e;var N=oI(i,a,e);Tv(i,N);break e}}i=i.return}while(i!==null)}SI(n)}catch(j){e=j,rt===n&&n!==null&&(rt=n=n.return);continue}break}while(!0)}function II(){var t=hh.current;return hh.current=ch,t===null?ch:t}function Tg(){(ht===0||ht===3||ht===2)&&(ht=4),wt===null||!(di&268435455)&&!(Zh&268435455)||Yr(wt,kt)}function ph(t,e){var n=Te;Te|=2;var r=II();(wt!==t||kt!==e)&&(ur=null,ni(t,e));do try{Nb();break}catch(s){TI(t,s)}while(!0);if(sg(),Te=n,hh.current=r,rt!==null)throw Error($(261));return wt=null,kt=0,ht}function Nb(){for(;rt!==null;)xI(rt)}function Db(){for(;rt!==null&&!sA();)xI(rt)}function xI(t){var e=CI(t.alternate,t,rn);t.memoizedProps=t.pendingProps,e===null?SI(t):rt=e,yg.current=null}function SI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=kb(n,e),n!==null){n.flags&=32767,rt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ht=6,rt=null;return}}else if(n=Sb(n,e,rn),n!==null){rt=n;return}if(e=e.sibling,e!==null){rt=e;return}rt=e=t}while(e!==null);ht===0&&(ht=5)}function Bs(t,e,n){var r=Ae,s=Tn.transition;try{Tn.transition=null,Ae=1,jb(t,e,n,r)}finally{Tn.transition=s,Ae=r}return null}function jb(t,e,n,r){do _o();while(rs!==null);if(Te&6)throw Error($(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error($(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(pA(t,i),t===wt&&(rt=wt=null,kt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ju||(Ju=!0,AI(Qc,function(){return _o(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Tn.transition,Tn.transition=null;var o=Ae;Ae=1;var a=Te;Te|=4,yg.current=null,Ab(t,n),vI(n,t),eb(Ip),Yc=!!Tp,Ip=Tp=null,t.current=n,bb(n),iA(),Te=a,Ae=o,Tn.transition=i}else t.current=n;if(Ju&&(Ju=!1,rs=t,fh=s),i=t.pendingLanes,i===0&&(cs=null),lA(n.stateNode),tn(t,Je()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(dh)throw dh=!1,t=$p,$p=null,t;return fh&1&&t.tag!==0&&_o(),i=t.pendingLanes,i&1?t===Hp?ol++:(ol=0,Hp=t):ol=0,Cs(),null}function _o(){if(rs!==null){var t=iT(fh),e=Tn.transition,n=Ae;try{if(Tn.transition=null,Ae=16>t?16:t,rs===null)var r=!1;else{if(t=rs,rs=null,fh=0,Te&6)throw Error($(331));var s=Te;for(Te|=4,te=t.current;te!==null;){var i=te,o=i.child;if(te.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var h=a[l];for(te=h;te!==null;){var d=te;switch(d.tag){case 0:case 11:case 15:sl(8,d,i)}var p=d.child;if(p!==null)p.return=d,te=p;else for(;te!==null;){d=te;var m=d.sibling,_=d.return;if(gI(d),d===h){te=null;break}if(m!==null){m.return=_,te=m;break}te=_}}}var k=i.alternate;if(k!==null){var A=k.child;if(A!==null){k.child=null;do{var b=A.sibling;A.sibling=null,A=b}while(A!==null)}}te=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,te=o;else e:for(;te!==null;){if(i=te,i.flags&2048)switch(i.tag){case 0:case 11:case 15:sl(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,te=T;break e}te=i.return}}var w=t.current;for(te=w;te!==null;){o=te;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,te=E;else e:for(o=w;te!==null;){if(a=te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Jh(9,a)}}catch(j){Xe(a,a.return,j)}if(a===o){te=null;break e}var N=a.sibling;if(N!==null){N.return=a.return,te=N;break e}te=a.return}}if(Te=s,Cs(),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(Hh,t)}catch{}r=!0}return r}finally{Ae=n,Tn.transition=e}}return!1}function $v(t,e,n){e=No(n,e),e=iI(t,e,1),t=us(t,e,1),e=$t(),t!==null&&(Zl(t,1,e),tn(t,e))}function Xe(t,e,n){if(t.tag===3)$v(t,t,n);else for(;e!==null;){if(e.tag===3){$v(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(cs===null||!cs.has(r))){t=No(n,t),t=oI(e,t,1),e=us(e,t,1),t=$t(),e!==null&&(Zl(e,1,t),tn(e,t));break}}e=e.return}}function Lb(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=$t(),t.pingedLanes|=t.suspendedLanes&n,wt===t&&(kt&n)===n&&(ht===4||ht===3&&(kt&130023424)===kt&&500>Je()-vg?ni(t,0):_g|=n),tn(t,e)}function kI(t,e){e===0&&(t.mode&1?(e=zu,zu<<=1,!(zu&130023424)&&(zu=4194304)):e=1);var n=$t();t=xr(t,e),t!==null&&(Zl(t,e,n),tn(t,n))}function Vb(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),kI(t,n)}function Mb(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(e),kI(t,n)}var CI;CI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Zt.current)Yt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Yt=!1,xb(t,e,n);Yt=!!(t.flags&131072)}else Yt=!1,Fe&&e.flags&1048576&&PT(e,sh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ec(t,e),t=e.pendingProps;var s=Ao(e,Vt.current);yo(e,n),s=dg(null,e,r,t,s,n);var i=fg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,en(r)?(i=!0,nh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ag(e),s.updater=Yh,e.stateNode=s,s._reactInternals=e,Np(e,r,t,n),e=Lp(null,e,r,!0,i,n)):(e.tag=0,Fe&&i&&eg(e),Ut(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ec(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Fb(r),t=Pn(r,t),s){case 0:e=jp(null,e,r,t,n);break e;case 1:e=Dv(null,e,r,t,n);break e;case 11:e=Pv(null,e,r,t,n);break e;case 14:e=Nv(null,e,r,Pn(r.type,t),n);break e}throw Error($(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Pn(r,s),jp(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Pn(r,s),Dv(t,e,r,s,n);case 3:e:{if(cI(e),t===null)throw Error($(387));r=e.pendingProps,i=e.memoizedState,s=i.element,MT(t,e),ah(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=No(Error($(423)),e),e=jv(t,e,r,n,s);break e}else if(r!==s){s=No(Error($(424)),e),e=jv(t,e,r,n,s);break e}else for(an=ls(e.stateNode.containerInfo.firstChild),cn=e,Fe=!0,jn=null,n=LT(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(bo(),r===s){e=Sr(t,e,n);break e}Ut(t,e,r,n)}e=e.child}return e;case 5:return OT(e),t===null&&bp(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,xp(r,s)?o=null:i!==null&&xp(r,i)&&(e.flags|=32),uI(t,e),Ut(t,e,o,n),e.child;case 6:return t===null&&bp(e),null;case 13:return hI(t,e,n);case 4:return lg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ro(e,null,r,n):Ut(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Pn(r,s),Pv(t,e,r,s,n);case 7:return Ut(t,e,e.pendingProps,n),e.child;case 8:return Ut(t,e,e.pendingProps.children,n),e.child;case 12:return Ut(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Pe(ih,r._currentValue),r._currentValue=o,i!==null)if(Fn(i.value,o)){if(i.children===s.children&&!Zt.current){e=Sr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=_r(-1,n&-n),l.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var d=h.pending;d===null?l.next=l:(l.next=d.next,d.next=l),h.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Rp(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error($(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Rp(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ut(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,yo(e,n),s=xn(s),r=r(s),e.flags|=1,Ut(t,e,r,n),e.child;case 14:return r=e.type,s=Pn(r,e.pendingProps),s=Pn(r.type,s),Nv(t,e,r,s,n);case 15:return aI(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Pn(r,s),Ec(t,e),e.tag=1,en(r)?(t=!0,nh(e)):t=!1,yo(e,n),sI(e,r,s),Np(e,r,s,n),Lp(null,e,r,!0,t,n);case 19:return dI(t,e,n);case 22:return lI(t,e,n)}throw Error($(156,e.tag))};function AI(t,e){return tT(t,e)}function Ob(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wn(t,e,n,r){return new Ob(t,e,n,r)}function Ig(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Fb(t){if(typeof t=="function")return Ig(t)?1:0;if(t!=null){if(t=t.$$typeof,t===zm)return 11;if(t===$m)return 14}return 2}function ds(t,e){var n=t.alternate;return n===null?(n=wn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function xc(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Ig(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case eo:return ri(n.children,s,i,e);case Bm:o=8,s|=8;break;case np:return t=wn(12,n,e,s|2),t.elementType=np,t.lanes=i,t;case rp:return t=wn(13,n,e,s),t.elementType=rp,t.lanes=i,t;case sp:return t=wn(19,n,e,s),t.elementType=sp,t.lanes=i,t;case OE:return ed(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case VE:o=10;break e;case ME:o=9;break e;case zm:o=11;break e;case $m:o=14;break e;case Gr:o=16,r=null;break e}throw Error($(130,t==null?t:typeof t,""))}return e=wn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ri(t,e,n,r){return t=wn(7,t,r,e),t.lanes=n,t}function ed(t,e,n,r){return t=wn(22,t,r,e),t.elementType=OE,t.lanes=n,t.stateNode={isHidden:!1},t}function Sf(t,e,n){return t=wn(6,t,null,e),t.lanes=n,t}function kf(t,e,n){return e=wn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ub(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=of(0),this.expirationTimes=of(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=of(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function xg(t,e,n,r,s,i,o,a,l){return t=new Ub(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=wn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ag(i),t}function Bb(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function bI(t){if(!t)return vs;t=t._reactInternals;e:{if(Ai(t)!==t||t.tag!==1)throw Error($(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(en(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(t.tag===1){var n=t.type;if(en(n))return bT(t,n,e)}return e}function RI(t,e,n,r,s,i,o,a,l){return t=xg(n,r,!0,t,s,i,o,a,l),t.context=bI(null),n=t.current,r=$t(),s=hs(n),i=_r(r,s),i.callback=e??null,us(n,i,s),t.current.lanes=s,Zl(t,s,r),tn(t,r),t}function td(t,e,n,r){var s=e.current,i=$t(),o=hs(s);return n=bI(n),e.context===null?e.context=n:e.pendingContext=n,e=_r(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=us(s,e,o),t!==null&&(On(t,s,o,i),_c(t,s,o)),o}function mh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Hv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Sg(t,e){Hv(t,e),(t=t.alternate)&&Hv(t,e)}function zb(){return null}var PI=typeof reportError=="function"?reportError:function(t){console.error(t)};function kg(t){this._internalRoot=t}nd.prototype.render=kg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error($(409));td(t,e,null,null)};nd.prototype.unmount=kg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;fi(function(){td(null,t,null,null)}),e[Ir]=null}};function nd(t){this._internalRoot=t}nd.prototype.unstable_scheduleHydration=function(t){if(t){var e=lT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Xr.length&&e!==0&&e<Xr[n].priority;n++);Xr.splice(n,0,t),n===0&&cT(t)}};function Cg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function rd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function qv(){}function $b(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=mh(o);i.call(h)}}var o=RI(e,r,t,0,null,!1,!1,"",qv);return t._reactRootContainer=o,t[Ir]=o.current,kl(t.nodeType===8?t.parentNode:t),fi(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var h=mh(l);a.call(h)}}var l=xg(t,0,!1,null,null,!1,!1,"",qv);return t._reactRootContainer=l,t[Ir]=l.current,kl(t.nodeType===8?t.parentNode:t),fi(function(){td(e,l,n,r)}),l}function sd(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=mh(o);a.call(l)}}td(e,o,t,s)}else o=$b(n,e,t,s,r);return mh(o)}oT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ba(e.pendingLanes);n!==0&&(Wm(e,n|1),tn(e,Je()),!(Te&6)&&(Do=Je()+500,Cs()))}break;case 13:fi(function(){var r=xr(t,1);if(r!==null){var s=$t();On(r,t,1,s)}}),Sg(t,1)}};Km=function(t){if(t.tag===13){var e=xr(t,134217728);if(e!==null){var n=$t();On(e,t,134217728,n)}Sg(t,134217728)}};aT=function(t){if(t.tag===13){var e=hs(t),n=xr(t,e);if(n!==null){var r=$t();On(n,t,e,r)}Sg(t,e)}};lT=function(){return Ae};uT=function(t,e){var n=Ae;try{return Ae=t,e()}finally{Ae=n}};pp=function(t,e,n){switch(e){case"input":if(ap(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Gh(r);if(!s)throw Error($(90));UE(r),ap(r,s)}}}break;case"textarea":zE(t,n);break;case"select":e=n.value,e!=null&&fo(t,!!n.multiple,e,!1)}};QE=wg;XE=fi;var Hb={usingClientEntryPoint:!1,Events:[tu,so,Gh,KE,GE,wg]},Aa={findFiberByHostInstance:Ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qb={bundleType:Aa.bundleType,version:Aa.version,rendererPackageName:Aa.rendererPackageName,rendererConfig:Aa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ZE(t),t===null?null:t.stateNode},findFiberByHostInstance:Aa.findFiberByHostInstance||zb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zu.isDisabled&&Zu.supportsFiber)try{Hh=Zu.inject(qb),Yn=Zu}catch{}}fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Hb;fn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cg(e))throw Error($(200));return Bb(t,e,null,n)};fn.createRoot=function(t,e){if(!Cg(t))throw Error($(299));var n=!1,r="",s=PI;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=xg(t,1,!1,null,null,n,!1,r,s),t[Ir]=e.current,kl(t.nodeType===8?t.parentNode:t),new kg(e)};fn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error($(188)):(t=Object.keys(t).join(","),Error($(268,t)));return t=ZE(e),t=t===null?null:t.stateNode,t};fn.flushSync=function(t){return fi(t)};fn.hydrate=function(t,e,n){if(!rd(e))throw Error($(200));return sd(null,t,e,!0,n)};fn.hydrateRoot=function(t,e,n){if(!Cg(t))throw Error($(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=PI;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=RI(e,null,t,1,n??null,s,!1,i,o),t[Ir]=e.current,kl(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new nd(e)};fn.render=function(t,e,n){if(!rd(e))throw Error($(200));return sd(null,t,e,!1,n)};fn.unmountComponentAtNode=function(t){if(!rd(t))throw Error($(40));return t._reactRootContainer?(fi(function(){sd(null,null,t,!1,function(){t._reactRootContainer=null,t[Ir]=null})}),!0):!1};fn.unstable_batchedUpdates=wg;fn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!rd(n))throw Error($(200));if(t==null||t._reactInternals===void 0)throw Error($(38));return sd(t,e,n,!1,r)};fn.version="18.3.1-next-f1338f8080-20240426";function NI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(NI)}catch(t){console.error(t)}}NI(),NE.exports=fn;var DI=NE.exports;const jI=Yl(DI);var Wv=DI;ep.createRoot=Wv.createRoot,ep.hydrateRoot=Wv.hydrateRoot;/**
 * react-router v7.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Kv="popstate";function Wb(t={}){function e(s,i){let{pathname:o="/",search:a="",hash:l=""}=bi(s.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Kp("",{pathname:o,search:a,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let o=s.document.querySelector("base"),a="";if(o&&o.getAttribute("href")){let l=s.location.href,h=l.indexOf("#");a=h===-1?l:l.slice(0,h)}return a+"#"+(typeof i=="string"?i:Ll(i))}function r(s,i){kn(s.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return Gb(e,n,r,t)}function He(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function kn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Kb(){return Math.random().toString(36).substring(2,10)}function Gv(t,e){return{usr:t.state,key:t.key,idx:e}}function Kp(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?bi(e):e,state:n,key:e&&e.key||r||Kb()}}function Ll({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function bi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function Gb(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a="POP",l=null,h=d();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function d(){return(o.state||{idx:null}).idx}function p(){a="POP";let b=d(),T=b==null?null:b-h;h=b,l&&l({action:a,location:A.location,delta:T})}function m(b,T){a="PUSH";let w=Kp(A.location,b,T);n&&n(w,b),h=d()+1;let E=Gv(w,h),N=A.createHref(w);try{o.pushState(E,"",N)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;s.location.assign(N)}i&&l&&l({action:a,location:A.location,delta:1})}function _(b,T){a="REPLACE";let w=Kp(A.location,b,T);n&&n(w,b),h=d();let E=Gv(w,h),N=A.createHref(w);o.replaceState(E,"",N),i&&l&&l({action:a,location:A.location,delta:0})}function k(b){return Qb(b)}let A={get action(){return a},get location(){return t(s,o)},listen(b){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Kv,p),l=b,()=>{s.removeEventListener(Kv,p),l=null}},createHref(b){return e(s,b)},createURL:k,encodeLocation(b){let T=k(b);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:_,go(b){return o.go(b)}};return A}function Qb(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),He(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Ll(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function LI(t,e,n="/"){return Xb(t,e,n,!1)}function Xb(t,e,n,r){let s=typeof e=="string"?bi(e):e,i=kr(s.pathname||"/",n);if(i==null)return null;let o=VI(t);Yb(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let h=lR(i);a=oR(o[l],h,r)}return a}function VI(t,e=[],n=[],r="",s=!1){let i=(o,a,l=s,h)=>{let d={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(r)&&l)return;He(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length)}let p=vr([r,d.relativePath]),m=n.concat(d);o.children&&o.children.length>0&&(He(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),VI(o.children,e,m,p,l)),!(o.path==null&&!o.index)&&e.push({path:p,score:sR(p,o.index),routesMeta:m})};return t.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))i(o,a);else for(let h of MI(o.path))i(o,a,!0,h)}),e}function MI(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=MI(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function Yb(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:iR(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var Jb=/^:[\w-]+$/,Zb=3,eR=2,tR=1,nR=10,rR=-2,Qv=t=>t==="*";function sR(t,e){let n=t.split("/"),r=n.length;return n.some(Qv)&&(r+=rR),e&&(r+=eR),n.filter(s=>!Qv(s)).reduce((s,i)=>s+(Jb.test(i)?Zb:i===""?tR:nR),r)}function iR(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function oR(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],h=a===r.length-1,d=i==="/"?e:e.slice(i.length)||"/",p=gh({path:l.relativePath,caseSensitive:l.caseSensitive,end:h},d),m=l.route;if(!p&&h&&n&&!r[r.length-1].route.index&&(p=gh({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},d)),!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:vr([i,p.pathname]),pathnameBase:dR(vr([i,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(i=vr([i,p.pathnameBase]))}return o}function gh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=aR(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((h,{paramName:d,isOptional:p},m)=>{if(d==="*"){let k=a[m]||"";o=i.slice(0,i.length-k.length).replace(/(.)\/+$/,"$1")}const _=a[m];return p&&!_?h[d]=void 0:h[d]=(_||"").replace(/%2F/g,"/"),h},{}),pathname:i,pathnameBase:o,pattern:t}}function aR(t,e=!1,n=!0){kn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function lR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return kn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function kr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var OI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,uR=t=>OI.test(t);function cR(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?bi(t):t,i;if(n)if(uR(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),kn(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?i=Xv(n.substring(1),"/"):i=Xv(n,e)}else i=e;return{pathname:i,search:fR(r),hash:pR(s)}}function Xv(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Cf(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function hR(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function FI(t){let e=hR(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function UI(t,e,n,r=!1){let s;typeof t=="string"?s=bi(t):(s={...t},He(!s.pathname||!s.pathname.includes("?"),Cf("?","pathname","search",s)),He(!s.pathname||!s.pathname.includes("#"),Cf("#","pathname","hash",s)),He(!s.search||!s.search.includes("#"),Cf("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;s.pathname=m.join("/")}a=p>=0?e[p]:"/"}let l=cR(s,a),h=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(h||d)&&(l.pathname+="/"),l}var vr=t=>t.join("/").replace(/\/\/+/g,"/"),dR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),fR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,pR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,mR=class{constructor(t,e,n,r=!1){this.status=t,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function gR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function yR(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var BI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function zI(t,e){let n=t;if(typeof n!="string"||!OI.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,s=!1;if(BI)try{let i=new URL(window.location.href),o=n.startsWith("//")?new URL(i.protocol+n):new URL(n),a=kr(o.pathname,e);o.origin===i.origin&&a!=null?n=a+o.search+o.hash:s=!0}catch{kn(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:s,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var $I=["POST","PUT","PATCH","DELETE"];new Set($I);var _R=["GET",...$I];new Set(_R);var Jo=P.createContext(null);Jo.displayName="DataRouter";var id=P.createContext(null);id.displayName="DataRouterState";var vR=P.createContext(!1),HI=P.createContext({isTransitioning:!1});HI.displayName="ViewTransition";var wR=P.createContext(new Map);wR.displayName="Fetchers";var ER=P.createContext(null);ER.displayName="Await";var An=P.createContext(null);An.displayName="Navigation";var ru=P.createContext(null);ru.displayName="Location";var or=P.createContext({outlet:null,matches:[],isDataRoute:!1});or.displayName="Route";var Ag=P.createContext(null);Ag.displayName="RouteError";var qI="REACT_ROUTER_ERROR",TR="REDIRECT",IR="ROUTE_ERROR_RESPONSE";function xR(t){if(t.startsWith(`${qI}:${TR}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function SR(t){if(t.startsWith(`${qI}:${IR}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new mR(e.status,e.statusText,e.data)}catch{}}function kR(t,{relative:e}={}){He(su(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=P.useContext(An),{hash:s,pathname:i,search:o}=ou(t,{relative:e}),a=i;return n!=="/"&&(a=i==="/"?n:vr([n,i])),r.createHref({pathname:a,search:o,hash:s})}function su(){return P.useContext(ru)!=null}function Nr(){return He(su(),"useLocation() may be used only in the context of a <Router> component."),P.useContext(ru).location}var WI="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function KI(t){P.useContext(An).static||P.useLayoutEffect(t)}function iu(){let{isDataRoute:t}=P.useContext(or);return t?FR():CR()}function CR(){He(su(),"useNavigate() may be used only in the context of a <Router> component.");let t=P.useContext(Jo),{basename:e,navigator:n}=P.useContext(An),{matches:r}=P.useContext(or),{pathname:s}=Nr(),i=JSON.stringify(FI(r)),o=P.useRef(!1);return KI(()=>{o.current=!0}),P.useCallback((l,h={})=>{if(kn(o.current,WI),!o.current)return;if(typeof l=="number"){n.go(l);return}let d=UI(l,JSON.parse(i),s,h.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:vr([e,d.pathname])),(h.replace?n.replace:n.push)(d,h.state,h)},[e,n,i,s,t])}P.createContext(null);function bg(){let{matches:t}=P.useContext(or),e=t[t.length-1];return e?e.params:{}}function ou(t,{relative:e}={}){let{matches:n}=P.useContext(or),{pathname:r}=Nr(),s=JSON.stringify(FI(n));return P.useMemo(()=>UI(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function AR(t,e){return GI(t,e)}function GI(t,e,n,r,s){var w;He(su(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=P.useContext(An),{matches:o}=P.useContext(or),a=o[o.length-1],l=a?a.params:{},h=a?a.pathname:"/",d=a?a.pathnameBase:"/",p=a&&a.route;{let E=p&&p.path||"";XI(h,!p||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let m=Nr(),_;if(e){let E=typeof e=="string"?bi(e):e;He(d==="/"||((w=E.pathname)==null?void 0:w.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${E.pathname}" was given in the \`location\` prop.`),_=E}else _=m;let k=_.pathname||"/",A=k;if(d!=="/"){let E=d.replace(/^\//,"").split("/");A="/"+k.replace(/^\//,"").split("/").slice(E.length).join("/")}let b=LI(t,{pathname:A});kn(p||b!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),kn(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=DR(b&&b.map(E=>Object.assign({},E,{params:Object.assign({},l,E.params),pathname:vr([d,i.encodeLocation?i.encodeLocation(E.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?d:vr([d,i.encodeLocation?i.encodeLocation(E.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathnameBase])})),o,n,r,s);return e&&T?P.createElement(ru.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},T):T}function bR(){let t=OR(),e=gR(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=P.createElement(P.Fragment,null,P.createElement("p",null," Hey developer "),P.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",P.createElement("code",{style:i},"ErrorBoundary")," or"," ",P.createElement("code",{style:i},"errorElement")," prop on your route.")),P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),n?P.createElement("pre",{style:s},n):null,o)}var RR=P.createElement(bR,null),QI=class extends P.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=SR(t.digest);n&&(t=n)}let e=t!==void 0?P.createElement(or.Provider,{value:this.props.routeContext},P.createElement(Ag.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?P.createElement(PR,{error:t},e):e}};QI.contextType=vR;var Af=new WeakMap;function PR({children:t,error:e}){let{basename:n}=P.useContext(An);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=xR(e.digest);if(r){let s=Af.get(e);if(s)throw s;let i=zI(r.location,n);if(BI&&!Af.get(e))if(i.isExternal||r.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:r.replace}));throw Af.set(e,o),o}return P.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return t}function NR({routeContext:t,match:e,children:n}){let r=P.useContext(Jo);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),P.createElement(or.Provider,{value:t},n)}function DR(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let d=i.findIndex(p=>p.route.id&&(o==null?void 0:o[p.route.id])!==void 0);He(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,d+1))}let a=!1,l=-1;if(n)for(let d=0;d<i.length;d++){let p=i[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(l=d),p.route.id){let{loaderData:m,errors:_}=n,k=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!_||_[p.route.id]===void 0);if(p.route.lazy||k){a=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}let h=n&&r?(d,p)=>{var m,_;r(d,{location:n.location,params:((_=(m=n.matches)==null?void 0:m[0])==null?void 0:_.params)??{},unstable_pattern:yR(n.matches),errorInfo:p})}:void 0;return i.reduceRight((d,p,m)=>{let _,k=!1,A=null,b=null;n&&(_=o&&p.route.id?o[p.route.id]:void 0,A=p.route.errorElement||RR,a&&(l<0&&m===0?(XI("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),k=!0,b=null):l===m&&(k=!0,b=p.route.hydrateFallbackElement||null)));let T=e.concat(i.slice(0,m+1)),w=()=>{let E;return _?E=A:k?E=b:p.route.Component?E=P.createElement(p.route.Component,null):p.route.element?E=p.route.element:E=d,P.createElement(NR,{match:p,routeContext:{outlet:d,matches:T,isDataRoute:n!=null},children:E})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?P.createElement(QI,{location:n.location,revalidation:n.revalidation,component:A,error:_,children:w(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:h}):w()},null)}function Rg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jR(t){let e=P.useContext(Jo);return He(e,Rg(t)),e}function LR(t){let e=P.useContext(id);return He(e,Rg(t)),e}function VR(t){let e=P.useContext(or);return He(e,Rg(t)),e}function Pg(t){let e=VR(t),n=e.matches[e.matches.length-1];return He(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function MR(){return Pg("useRouteId")}function OR(){var r;let t=P.useContext(Ag),e=LR("useRouteError"),n=Pg("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function FR(){let{router:t}=jR("useNavigate"),e=Pg("useNavigate"),n=P.useRef(!1);return KI(()=>{n.current=!0}),P.useCallback(async(s,i={})=>{kn(n.current,WI),n.current&&(typeof s=="number"?await t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var Yv={};function XI(t,e,n){!e&&!Yv[t]&&(Yv[t]=!0,kn(!1,n))}P.memo(UR);function UR({routes:t,future:e,state:n,onError:r}){return GI(t,void 0,n,r,e)}function Hn(t){He(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function BR({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1,unstable_useTransitions:o}){He(!su(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=t.replace(/^\/*/,"/"),l=P.useMemo(()=>({basename:a,navigator:s,static:i,unstable_useTransitions:o,future:{}}),[a,s,i,o]);typeof n=="string"&&(n=bi(n));let{pathname:h="/",search:d="",hash:p="",state:m=null,key:_="default"}=n,k=P.useMemo(()=>{let A=kr(h,a);return A==null?null:{location:{pathname:A,search:d,hash:p,state:m,key:_},navigationType:r}},[a,h,d,p,m,_,r]);return kn(k!=null,`<Router basename="${a}"> is not able to match the URL "${h}${d}${p}" because it does not start with the basename, so the <Router> won't render anything.`),k==null?null:P.createElement(An.Provider,{value:l},P.createElement(ru.Provider,{children:e,value:k}))}function zR({children:t,location:e}){return AR(Gp(t),e)}function Gp(t,e=[]){let n=[];return P.Children.forEach(t,(r,s)=>{if(!P.isValidElement(r))return;let i=[...e,s];if(r.type===P.Fragment){n.push.apply(n,Gp(r.props.children,i));return}He(r.type===Hn,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),He(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Gp(r.props.children,i)),n.push(o)}),n}var Sc="get",kc="application/x-www-form-urlencoded";function od(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function $R(t){return od(t)&&t.tagName.toLowerCase()==="button"}function HR(t){return od(t)&&t.tagName.toLowerCase()==="form"}function qR(t){return od(t)&&t.tagName.toLowerCase()==="input"}function WR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function KR(t,e){return t.button===0&&(!e||e==="_self")&&!WR(t)}var ec=null;function GR(){if(ec===null)try{new FormData(document.createElement("form"),0),ec=!1}catch{ec=!0}return ec}var QR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function bf(t){return t!=null&&!QR.has(t)?(kn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${kc}"`),null):t}function XR(t,e){let n,r,s,i,o;if(HR(t)){let a=t.getAttribute("action");r=a?kr(a,e):null,n=t.getAttribute("method")||Sc,s=bf(t.getAttribute("enctype"))||kc,i=new FormData(t)}else if($R(t)||qR(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?kr(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||Sc,s=bf(t.getAttribute("formenctype"))||bf(a.getAttribute("enctype"))||kc,i=new FormData(a,t),!GR()){let{name:h,type:d,value:p}=t;if(d==="image"){let m=h?`${h}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else h&&i.append(h,p)}}else{if(od(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Sc,r=null,s=kc,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ng(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function YR(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&kr(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function JR(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function ZR(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function eP(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await JR(i,n);return o.links?o.links():[]}return[]}));return sP(r.flat(1).filter(ZR).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Jv(t,e,n,r,s,i){let o=(l,h)=>n[h]?l.route.id!==n[h].route.id:!0,a=(l,h)=>{var d;return n[h].pathname!==l.pathname||((d=n[h].route.path)==null?void 0:d.endsWith("*"))&&n[h].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,h)=>o(l,h)||a(l,h)):i==="data"?e.filter((l,h)=>{var p;let d=r.routes[l.route.id];if(!d||!d.hasLoader)return!1;if(o(l,h)||a(l,h))return!0;if(l.route.shouldRevalidate){let m=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((p=n[0])==null?void 0:p.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function tP(t,e,{includeHydrateFallback:n}={}){return nP(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function nP(t){return[...new Set(t)]}function rP(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function sP(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify(rP(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function YI(){let t=P.useContext(Jo);return Ng(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function iP(){let t=P.useContext(id);return Ng(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Dg=P.createContext(void 0);Dg.displayName="FrameworkContext";function JI(){let t=P.useContext(Dg);return Ng(t,"You must render this element inside a <HydratedRouter> element"),t}function oP(t,e){let n=P.useContext(Dg),[r,s]=P.useState(!1),[i,o]=P.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:h,onMouseLeave:d,onTouchStart:p}=e,m=P.useRef(null);P.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let A=T=>{T.forEach(w=>{o(w.isIntersecting)})},b=new IntersectionObserver(A,{threshold:.5});return m.current&&b.observe(m.current),()=>{b.disconnect()}}},[t]),P.useEffect(()=>{if(r){let A=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(A)}}},[r]);let _=()=>{s(!0)},k=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,m,{}]:[i,m,{onFocus:ba(a,_),onBlur:ba(l,k),onMouseEnter:ba(h,_),onMouseLeave:ba(d,k),onTouchStart:ba(p,_)}]:[!1,m,{}]}function ba(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function aP({page:t,...e}){let{router:n}=YI(),r=P.useMemo(()=>LI(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?P.createElement(uP,{page:t,matches:r,...e}):null}function lP(t){let{manifest:e,routeModules:n}=JI(),[r,s]=P.useState([]);return P.useEffect(()=>{let i=!1;return eP(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function uP({page:t,matches:e,...n}){let r=Nr(),{manifest:s,routeModules:i}=JI(),{basename:o}=YI(),{loaderData:a,matches:l}=iP(),h=P.useMemo(()=>Jv(t,e,l,s,r,"data"),[t,e,l,s,r]),d=P.useMemo(()=>Jv(t,e,l,s,r,"assets"),[t,e,l,s,r]),p=P.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let k=new Set,A=!1;if(e.forEach(T=>{var E;let w=s.routes[T.route.id];!w||!w.hasLoader||(!h.some(N=>N.route.id===T.route.id)&&T.route.id in a&&((E=i[T.route.id])!=null&&E.shouldRevalidate)||w.hasClientLoader?A=!0:k.add(T.route.id))}),k.size===0)return[];let b=YR(t,o,"data");return A&&k.size>0&&b.searchParams.set("_routes",e.filter(T=>k.has(T.route.id)).map(T=>T.route.id).join(",")),[b.pathname+b.search]},[o,a,r,s,h,e,t,i]),m=P.useMemo(()=>tP(d,s),[d,s]),_=lP(d);return P.createElement(P.Fragment,null,p.map(k=>P.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...n})),m.map(k=>P.createElement("link",{key:k,rel:"modulepreload",href:k,...n})),_.map(({key:k,link:A})=>P.createElement("link",{key:k,nonce:n.nonce,...A})))}function cP(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var hP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{hP&&(window.__reactRouterVersion="7.11.0")}catch{}function dP({basename:t,children:e,unstable_useTransitions:n,window:r}){let s=P.useRef();s.current==null&&(s.current=Wb({window:r,v5Compat:!0}));let i=s.current,[o,a]=P.useState({action:i.action,location:i.location}),l=P.useCallback(h=>{n===!1?a(h):P.startTransition(()=>a(h))},[n]);return P.useLayoutEffect(()=>i.listen(l),[i,l]),P.createElement(BR,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:n})}var ZI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gn=P.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:a,target:l,to:h,preventScrollReset:d,viewTransition:p,unstable_defaultShouldRevalidate:m,..._},k){let{basename:A,unstable_useTransitions:b}=P.useContext(An),T=typeof h=="string"&&ZI.test(h),w=zI(h,A);h=w.to;let E=kR(h,{relative:s}),[N,j,F]=oP(r,_),S=gP(h,{replace:o,state:a,target:l,preventScrollReset:d,relative:s,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:b});function y(C){e&&e(C),C.defaultPrevented||S(C)}let v=P.createElement("a",{..._,...F,href:w.absoluteURL||E,onClick:w.isExternal||i?e:y,ref:cP(k,j),target:l,"data-discover":!T&&n==="render"?"true":void 0});return N&&!T?P.createElement(P.Fragment,null,v,P.createElement(aP,{page:E})):v});gn.displayName="Link";var fP=P.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:a,children:l,...h},d){let p=ou(o,{relative:h.relative}),m=Nr(),_=P.useContext(id),{navigator:k,basename:A}=P.useContext(An),b=_!=null&&EP(p)&&a===!0,T=k.encodeLocation?k.encodeLocation(p).pathname:p.pathname,w=m.pathname,E=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;n||(w=w.toLowerCase(),E=E?E.toLowerCase():null,T=T.toLowerCase()),E&&A&&(E=kr(E,A)||E);const N=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let j=w===T||!s&&w.startsWith(T)&&w.charAt(N)==="/",F=E!=null&&(E===T||!s&&E.startsWith(T)&&E.charAt(T.length)==="/"),S={isActive:j,isPending:F,isTransitioning:b},y=j?e:void 0,v;typeof r=="function"?v=r(S):v=[r,j?"active":null,F?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let C=typeof i=="function"?i(S):i;return P.createElement(gn,{...h,"aria-current":y,className:v,ref:d,style:C,to:o,viewTransition:a},typeof l=="function"?l(S):l)});fP.displayName="NavLink";var pP=P.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=Sc,action:a,onSubmit:l,relative:h,preventScrollReset:d,viewTransition:p,unstable_defaultShouldRevalidate:m,..._},k)=>{let{unstable_useTransitions:A}=P.useContext(An),b=vP(),T=wP(a,{relative:h}),w=o.toLowerCase()==="get"?"get":"post",E=typeof a=="string"&&ZI.test(a),N=j=>{if(l&&l(j),j.defaultPrevented)return;j.preventDefault();let F=j.nativeEvent.submitter,S=(F==null?void 0:F.getAttribute("formmethod"))||o,y=()=>b(F||j.currentTarget,{fetcherKey:e,method:S,navigate:n,replace:s,state:i,relative:h,preventScrollReset:d,viewTransition:p,unstable_defaultShouldRevalidate:m});A&&n!==!1?P.startTransition(()=>y()):y()};return P.createElement("form",{ref:k,method:w,action:T,onSubmit:r?l:N,..._,"data-discover":!E&&t==="render"?"true":void 0})});pP.displayName="Form";function mP(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ex(t){let e=P.useContext(Jo);return He(e,mP(t)),e}function gP(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:a,unstable_useTransitions:l}={}){let h=iu(),d=Nr(),p=ou(t,{relative:i});return P.useCallback(m=>{if(KR(m,e)){m.preventDefault();let _=n!==void 0?n:Ll(d)===Ll(p),k=()=>h(t,{replace:_,state:r,preventScrollReset:s,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:a});l?P.startTransition(()=>k()):k()}},[d,h,p,n,r,e,t,s,i,o,a,l])}var yP=0,_P=()=>`__${String(++yP)}__`;function vP(){let{router:t}=ex("useSubmit"),{basename:e}=P.useContext(An),n=MR(),r=t.fetch,s=t.navigate;return P.useCallback(async(i,o={})=>{let{action:a,method:l,encType:h,formData:d,body:p}=XR(i,e);if(o.navigate===!1){let m=o.fetcherKey||_P();await r(m,n,o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:d,body:p,formMethod:o.method||l,formEncType:o.encType||h,flushSync:o.flushSync})}else await s(o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:d,body:p,formMethod:o.method||l,formEncType:o.encType||h,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,s,e,n])}function wP(t,{relative:e}={}){let{basename:n}=P.useContext(An),r=P.useContext(or);He(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...ou(t||".",{relative:e})},o=Nr();if(t==null){i.search=o.search;let a=new URLSearchParams(i.search),l=a.getAll("index");if(l.some(d=>d==="")){a.delete("index"),l.filter(p=>p).forEach(p=>a.append("index",p));let d=a.toString();i.search=d?`?${d}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:vr([n,i.pathname])),Ll(i)}function EP(t,{relative:e}={}){let n=P.useContext(HI);He(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=ex("useViewTransitionState"),s=ou(t,{relative:e});if(!n.isTransitioning)return!1;let i=kr(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=kr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return gh(s.pathname,o)!=null||gh(s.pathname,i)!=null}var TP=typeof Element<"u",IP=typeof Map=="function",xP=typeof Set=="function",SP=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function Cc(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var n,r,s;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(r=n;r--!==0;)if(!Cc(t[r],e[r]))return!1;return!0}var i;if(IP&&t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(i=t.entries();!(r=i.next()).done;)if(!e.has(r.value[0]))return!1;for(i=t.entries();!(r=i.next()).done;)if(!Cc(r.value[1],e.get(r.value[0])))return!1;return!0}if(xP&&t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(i=t.entries();!(r=i.next()).done;)if(!e.has(r.value[0]))return!1;return!0}if(SP&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!=e.length)return!1;for(r=n;r--!==0;)if(t[r]!==e[r])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof e.valueOf=="function")return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof e.toString=="function")return t.toString()===e.toString();if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,s[r]))return!1;if(TP&&t instanceof Element)return!1;for(r=n;r--!==0;)if(!((s[r]==="_owner"||s[r]==="__v"||s[r]==="__o")&&t.$$typeof)&&!Cc(t[s[r]],e[s[r]]))return!1;return!0}return t!==t&&e!==e}var kP=function(e,n){try{return Cc(e,n)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}};const CP=Yl(kP);var AP=function(t,e,n,r,s,i,o,a){if(!t){var l;if(e===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var h=[n,r,s,i,o,a],d=0;l=new Error(e.replace(/%s/g,function(){return h[d++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}},bP=AP;const Zv=Yl(bP);var RP=function(e,n,r,s){var i=r?r.call(s,e,n):void 0;if(i!==void 0)return!!i;if(e===n)return!0;if(typeof e!="object"||!e||typeof n!="object"||!n)return!1;var o=Object.keys(e),a=Object.keys(n);if(o.length!==a.length)return!1;for(var l=Object.prototype.hasOwnProperty.bind(n),h=0;h<o.length;h++){var d=o[h];if(!l(d))return!1;var p=e[d],m=n[d];if(i=r?r.call(s,p,m,d):void 0,i===!1||i===void 0&&p!==m)return!1}return!0};const PP=Yl(RP);var tx=(t=>(t.BASE="base",t.BODY="body",t.HEAD="head",t.HTML="html",t.LINK="link",t.META="meta",t.NOSCRIPT="noscript",t.SCRIPT="script",t.STYLE="style",t.TITLE="title",t.FRAGMENT="Symbol(react.fragment)",t))(tx||{}),Rf={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},ew=Object.values(tx),jg={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},NP=Object.entries(jg).reduce((t,[e,n])=>(t[n]=e,t),{}),Ln="data-rh",vo={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},wo=(t,e)=>{for(let n=t.length-1;n>=0;n-=1){const r=t[n];if(Object.prototype.hasOwnProperty.call(r,e))return r[e]}return null},DP=t=>{let e=wo(t,"title");const n=wo(t,vo.TITLE_TEMPLATE);if(Array.isArray(e)&&(e=e.join("")),n&&e)return n.replace(/%s/g,()=>e);const r=wo(t,vo.DEFAULT_TITLE);return e||r||void 0},jP=t=>wo(t,vo.ON_CHANGE_CLIENT_STATE)||(()=>{}),Pf=(t,e)=>e.filter(n=>typeof n[t]<"u").map(n=>n[t]).reduce((n,r)=>({...n,...r}),{}),LP=(t,e)=>e.filter(n=>typeof n.base<"u").map(n=>n.base).reverse().reduce((n,r)=>{if(!n.length){const s=Object.keys(r);for(let i=0;i<s.length;i+=1){const a=s[i].toLowerCase();if(t.indexOf(a)!==-1&&r[a])return n.concat(r)}}return n},[]),VP=t=>console&&typeof console.warn=="function"&&console.warn(t),Ra=(t,e,n)=>{const r={};return n.filter(s=>Array.isArray(s[t])?!0:(typeof s[t]<"u"&&VP(`Helmet: ${t} should be of type "Array". Instead found type "${typeof s[t]}"`),!1)).map(s=>s[t]).reverse().reduce((s,i)=>{const o={};i.filter(l=>{let h;const d=Object.keys(l);for(let m=0;m<d.length;m+=1){const _=d[m],k=_.toLowerCase();e.indexOf(k)!==-1&&!(h==="rel"&&l[h].toLowerCase()==="canonical")&&!(k==="rel"&&l[k].toLowerCase()==="stylesheet")&&(h=k),e.indexOf(_)!==-1&&(_==="innerHTML"||_==="cssText"||_==="itemprop")&&(h=_)}if(!h||!l[h])return!1;const p=l[h].toLowerCase();return r[h]||(r[h]={}),o[h]||(o[h]={}),r[h][p]?!1:(o[h][p]=!0,!0)}).reverse().forEach(l=>s.push(l));const a=Object.keys(o);for(let l=0;l<a.length;l+=1){const h=a[l],d={...r[h],...o[h]};r[h]=d}return s},[]).reverse()},MP=(t,e)=>{if(Array.isArray(t)&&t.length){for(let n=0;n<t.length;n+=1)if(t[n][e])return!0}return!1},OP=t=>({baseTag:LP(["href"],t),bodyAttributes:Pf("bodyAttributes",t),defer:wo(t,vo.DEFER),encode:wo(t,vo.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:Pf("htmlAttributes",t),linkTags:Ra("link",["rel","href"],t),metaTags:Ra("meta",["name","charset","http-equiv","property","itemprop"],t),noscriptTags:Ra("noscript",["innerHTML"],t),onChangeClientState:jP(t),scriptTags:Ra("script",["src","innerHTML"],t),styleTags:Ra("style",["cssText"],t),title:DP(t),titleAttributes:Pf("titleAttributes",t),prioritizeSeoTags:MP(t,vo.PRIORITIZE_SEO_TAGS)}),nx=t=>Array.isArray(t)?t.join(""):t,FP=(t,e)=>{const n=Object.keys(t);for(let r=0;r<n.length;r+=1)if(e[n[r]]&&e[n[r]].includes(t[n[r]]))return!0;return!1},Nf=(t,e)=>Array.isArray(t)?t.reduce((n,r)=>(FP(r,e)?n.priority.push(r):n.default.push(r),n),{priority:[],default:[]}):{default:t,priority:[]},tw=(t,e)=>({...t,[e]:void 0}),UP=["noscript","script","style"],Qp=(t,e=!0)=>e===!1?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),rx=t=>Object.keys(t).reduce((e,n)=>{const r=typeof t[n]<"u"?`${n}="${t[n]}"`:`${n}`;return e?`${e} ${r}`:r},""),BP=(t,e,n,r)=>{const s=rx(n),i=nx(e);return s?`<${t} ${Ln}="true" ${s}>${Qp(i,r)}</${t}>`:`<${t} ${Ln}="true">${Qp(i,r)}</${t}>`},zP=(t,e,n=!0)=>e.reduce((r,s)=>{const i=s,o=Object.keys(i).filter(h=>!(h==="innerHTML"||h==="cssText")).reduce((h,d)=>{const p=typeof i[d]>"u"?d:`${d}="${Qp(i[d],n)}"`;return h?`${h} ${p}`:p},""),a=i.innerHTML||i.cssText||"",l=UP.indexOf(t)===-1;return`${r}<${t} ${Ln}="true" ${o}${l?"/>":`>${a}</${t}>`}`},""),sx=(t,e={})=>Object.keys(t).reduce((n,r)=>{const s=jg[r];return n[s||r]=t[r],n},e),$P=(t,e,n)=>{const r={key:e,[Ln]:!0},s=sx(n,r);return[zt.createElement("title",s,e)]},Ac=(t,e)=>e.map((n,r)=>{const s={key:r,[Ln]:!0};return Object.keys(n).forEach(i=>{const a=jg[i]||i;if(a==="innerHTML"||a==="cssText"){const l=n.innerHTML||n.cssText;s.dangerouslySetInnerHTML={__html:l}}else s[a]=n[i]}),zt.createElement(t,s)}),mn=(t,e,n=!0)=>{switch(t){case"title":return{toComponent:()=>$P(t,e.title,e.titleAttributes),toString:()=>BP(t,e.title,e.titleAttributes,n)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>sx(e),toString:()=>rx(e)};default:return{toComponent:()=>Ac(t,e),toString:()=>zP(t,e,n)}}},HP=({metaTags:t,linkTags:e,scriptTags:n,encode:r})=>{const s=Nf(t,Rf.meta),i=Nf(e,Rf.link),o=Nf(n,Rf.script);return{priorityMethods:{toComponent:()=>[...Ac("meta",s.priority),...Ac("link",i.priority),...Ac("script",o.priority)],toString:()=>`${mn("meta",s.priority,r)} ${mn("link",i.priority,r)} ${mn("script",o.priority,r)}`},metaTags:s.default,linkTags:i.default,scriptTags:o.default}},qP=t=>{const{baseTag:e,bodyAttributes:n,encode:r=!0,htmlAttributes:s,noscriptTags:i,styleTags:o,title:a="",titleAttributes:l,prioritizeSeoTags:h}=t;let{linkTags:d,metaTags:p,scriptTags:m}=t,_={toComponent:()=>{},toString:()=>""};return h&&({priorityMethods:_,linkTags:d,metaTags:p,scriptTags:m}=HP(t)),{priority:_,base:mn("base",e,r),bodyAttributes:mn("bodyAttributes",n,r),htmlAttributes:mn("htmlAttributes",s,r),link:mn("link",d,r),meta:mn("meta",p,r),noscript:mn("noscript",i,r),script:mn("script",m,r),style:mn("style",o,r),title:mn("title",{title:a,titleAttributes:l},r)}},Xp=qP,tc=[],ix=!!(typeof window<"u"&&window.document&&window.document.createElement),Yp=class{constructor(t,e){lr(this,"instances",[]);lr(this,"canUseDOM",ix);lr(this,"context");lr(this,"value",{setHelmet:t=>{this.context.helmet=t},helmetInstances:{get:()=>this.canUseDOM?tc:this.instances,add:t=>{(this.canUseDOM?tc:this.instances).push(t)},remove:t=>{const e=(this.canUseDOM?tc:this.instances).indexOf(t);(this.canUseDOM?tc:this.instances).splice(e,1)}}});this.context=t,this.canUseDOM=e||!1,e||(t.helmet=Xp({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},WP={},ox=zt.createContext(WP),ti,ax=(ti=class extends P.Component{constructor(n){super(n);lr(this,"helmetData");this.helmetData=new Yp(this.props.context||{},ti.canUseDOM)}render(){return zt.createElement(ox.Provider,{value:this.helmetData.value},this.props.children)}},lr(ti,"canUseDOM",ix),ti),Ui=(t,e)=>{const n=document.head||document.querySelector("head"),r=n.querySelectorAll(`${t}[${Ln}]`),s=[].slice.call(r),i=[];let o;return e&&e.length&&e.forEach(a=>{const l=document.createElement(t);for(const h in a)if(Object.prototype.hasOwnProperty.call(a,h))if(h==="innerHTML")l.innerHTML=a.innerHTML;else if(h==="cssText")l.styleSheet?l.styleSheet.cssText=a.cssText:l.appendChild(document.createTextNode(a.cssText));else{const d=h,p=typeof a[d]>"u"?"":a[d];l.setAttribute(h,p)}l.setAttribute(Ln,"true"),s.some((h,d)=>(o=d,l.isEqualNode(h)))?s.splice(o,1):i.push(l)}),s.forEach(a=>{var l;return(l=a.parentNode)==null?void 0:l.removeChild(a)}),i.forEach(a=>n.appendChild(a)),{oldTags:s,newTags:i}},Jp=(t,e)=>{const n=document.getElementsByTagName(t)[0];if(!n)return;const r=n.getAttribute(Ln),s=r?r.split(","):[],i=[...s],o=Object.keys(e);for(const a of o){const l=e[a]||"";n.getAttribute(a)!==l&&n.setAttribute(a,l),s.indexOf(a)===-1&&s.push(a);const h=i.indexOf(a);h!==-1&&i.splice(h,1)}for(let a=i.length-1;a>=0;a-=1)n.removeAttribute(i[a]);s.length===i.length?n.removeAttribute(Ln):n.getAttribute(Ln)!==o.join(",")&&n.setAttribute(Ln,o.join(","))},KP=(t,e)=>{typeof t<"u"&&document.title!==t&&(document.title=nx(t)),Jp("title",e)},nw=(t,e)=>{const{baseTag:n,bodyAttributes:r,htmlAttributes:s,linkTags:i,metaTags:o,noscriptTags:a,onChangeClientState:l,scriptTags:h,styleTags:d,title:p,titleAttributes:m}=t;Jp("body",r),Jp("html",s),KP(p,m);const _={baseTag:Ui("base",n),linkTags:Ui("link",i),metaTags:Ui("meta",o),noscriptTags:Ui("noscript",a),scriptTags:Ui("script",h),styleTags:Ui("style",d)},k={},A={};Object.keys(_).forEach(b=>{const{newTags:T,oldTags:w}=_[b];T.length&&(k[b]=T),w.length&&(A[b]=_[b].oldTags)}),e&&e(),l(t,k,A)},Pa=null,GP=t=>{Pa&&cancelAnimationFrame(Pa),t.defer?Pa=requestAnimationFrame(()=>{nw(t,()=>{Pa=null})}):(nw(t),Pa=null)},QP=GP,rw=class extends P.Component{constructor(){super(...arguments);lr(this,"rendered",!1)}shouldComponentUpdate(e){return!PP(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:n}=this.props.context;let r=null;const s=OP(e.get().map(i=>{const o={...i.props};return delete o.context,o}));ax.canUseDOM?QP(s):Xp&&(r=Xp(s)),n(r)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}},Zf,XP=(Zf=class extends P.Component{shouldComponentUpdate(t){return!CP(tw(this.props,"helmetData"),tw(t,"helmetData"))}mapNestedChildrenToProps(t,e){if(!e)return null;switch(t.type){case"script":case"noscript":return{innerHTML:e};case"style":return{cssText:e};default:throw new Error(`<${t.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(t,e,n,r){return{...e,[t.type]:[...e[t.type]||[],{...n,...this.mapNestedChildrenToProps(t,r)}]}}mapObjectTypeChildren(t,e,n,r){switch(t.type){case"title":return{...e,[t.type]:r,titleAttributes:{...n}};case"body":return{...e,bodyAttributes:{...n}};case"html":return{...e,htmlAttributes:{...n}};default:return{...e,[t.type]:{...n}}}}mapArrayTypeChildrenToProps(t,e){let n={...e};return Object.keys(t).forEach(r=>{n={...n,[r]:t[r]}}),n}warnOnInvalidChildren(t,e){return Zv(ew.some(n=>t.type===n),typeof t.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${ew.join(", ")} are allowed. Helmet does not support rendering <${t.type}> elements. Refer to our API for more information.`),Zv(!e||typeof e=="string"||Array.isArray(e)&&!e.some(n=>typeof n!="string"),`Helmet expects a string as a child of <${t.type}>. Did you forget to wrap your children in braces? ( <${t.type}>{\`\`}</${t.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(t,e){let n={};return zt.Children.forEach(t,r=>{if(!r||!r.props)return;const{children:s,...i}=r.props,o=Object.keys(i).reduce((l,h)=>(l[NP[h]||h]=i[h],l),{});let{type:a}=r;switch(typeof a=="symbol"?a=a.toString():this.warnOnInvalidChildren(r,s),a){case"Symbol(react.fragment)":e=this.mapChildrenToProps(s,e);break;case"link":case"meta":case"noscript":case"script":case"style":n=this.flattenArrayTypeChildren(r,n,o,s);break;default:e=this.mapObjectTypeChildren(r,e,o,s);break}}),this.mapArrayTypeChildrenToProps(n,e)}render(){const{children:t,...e}=this.props;let n={...e},{helmetData:r}=e;if(t&&(n=this.mapChildrenToProps(t,n)),r&&!(r instanceof Yp)){const s=r;r=new Yp(s.context,!0),delete n.helmetData}return r?zt.createElement(rw,{...n,context:r.value}):zt.createElement(ox.Consumer,null,s=>zt.createElement(rw,{...n,context:s}))}},lr(Zf,"defaultProps",{defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1}),Zf);const YP=()=>{const t=document.createElement("canvas"),e=t.getContext("2d");e.textBaseline="top",e.font="14px Arial",e.fillText("fingerprint",2,2);const n={userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform,screenResolution:`${screen.width}x${screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,canvasFingerprint:t.toDataURL(),colorDepth:screen.colorDepth,deviceMemory:navigator.deviceMemory||"unknown",hardwareConcurrency:navigator.hardwareConcurrency||"unknown"},r=JSON.stringify(n);let s=0;for(let i=0;i<r.length;i++){const o=r.charCodeAt(i);s=(s<<5)-s+o,s=s&s}return`guest_${Math.abs(s).toString(36)}`},JP=()=>{let t=localStorage.getItem("deskhub_guest_id");return t||(t=YP(),localStorage.setItem("deskhub_guest_id",t)),t},Na=()=>{const t=JSON.parse(localStorage.getItem("deskhub_current_user")||"null");if(t)return{id:t.id,username:t.username,displayName:t.displayName,avatar:t.avatar,role:t.role,isGuest:!1};const e=JP(),n=localStorage.getItem("deskhub_guest_name")||"Khch",r=localStorage.getItem("deskhub_guest_avatar")||"https://i.pravatar.cc/150?img=0";return{id:e,username:e,displayName:n,avatar:r,role:"guest",isGuest:!0}},ZP=(t,e)=>{localStorage.setItem("deskhub_guest_name",t)},eN=()=>{};var sw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},tN=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},ux={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,h=l?t[s+2]:0,d=i>>2,p=(i&3)<<4|a>>4;let m=(a&15)<<2|h>>6,_=h&63;l||(_=64,o||(m=64)),r.push(n[d],n[p],n[m],n[_])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(lx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):tN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||h==null||p==null)throw new nN;const m=i<<2|a>>4;if(r.push(m),h!==64){const _=a<<4&240|h>>2;if(r.push(_),p!==64){const k=h<<6&192|p;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class nN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const rN=function(t){const e=lx(t);return ux.encodeByteArray(e,!0)},yh=function(t){return rN(t).replace(/\./g,"")},cx=function(t){try{return ux.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sN=()=>hx().__FIREBASE_DEFAULTS__,iN=()=>{if(typeof process>"u"||typeof sw>"u")return;const t=sw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},oN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&cx(t[1]);return e&&JSON.parse(e)},ad=()=>{try{return eN()||sN()||iN()||oN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},dx=t=>{var e,n;return(n=(e=ad())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},fx=t=>{const e=dx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},px=()=>{var t;return(t=ad())==null?void 0:t.config},mx=t=>{var e;return(e=ad())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Lg(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[yh(JSON.stringify(n)),yh(JSON.stringify(o)),""].join(".")}const al={};function lN(){const t={prod:[],emulator:[]};for(const e of Object.keys(al))al[e]?t.emulator.push(e):t.prod.push(e);return t}function uN(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let iw=!1;function Vg(t,e){if(typeof window>"u"||typeof document>"u"||!As(window.location.host)||al[t]===e||al[t]||iw)return;al[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=lN().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,_){m.setAttribute("width","24"),m.setAttribute("id",_),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function h(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{iw=!0,o()},m}function d(m,_){m.setAttribute("id",_),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=uN(r),_=n("text"),k=document.getElementById(_)||document.createElement("span"),A=n("learnmore"),b=document.getElementById(A)||document.createElement("a"),T=n("preprendIcon"),w=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const E=m.element;a(E),d(b,A);const N=h();l(w,T),E.append(w,k,b,N),document.body.appendChild(E)}i?(k.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function cN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dt())}function yx(){var e;const t=(e=ad())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function hN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function dN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function fN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function pN(){const t=dt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function _x(){return!yx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function vx(){return!yx()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function wx(){try{return typeof indexedDB=="object"}catch{return!1}}function mN(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gN="FirebaseError";class ar extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=gN,Object.setPrototypeOf(this,ar.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,au.prototype.create)}}class au{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?yN(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new ar(s,a,r)}}function yN(t,e){return t.replace(_N,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const _N=/\{\$([^}]+)}/g;function vN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function pi(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(ow(i)&&ow(o)){if(!pi(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function ow(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function $a(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Ha(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function wN(t,e){const n=new EN(t,e);return n.subscribe.bind(n)}class EN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");TN(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Df),s.error===void 0&&(s.error=Df),s.complete===void 0&&(s.complete=Df);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function TN(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Df(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(t){return t&&t._delegate?t._delegate:t}class ws{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new aN;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(SN(e))try{this.getOrInitializeService({instanceIdentifier:zs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=zs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=zs){return this.instances.has(e)}getOptions(e=zs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:xN(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=zs){return this.component?this.component.multipleInstances?e:zs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xN(t){return t===zs?void 0:t}function SN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new IN(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ye||(ye={}));const CN={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},AN=ye.INFO,bN={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},RN=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=bN[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Mg{constructor(e){this.name=e,this._logLevel=AN,this._logHandler=RN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?CN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}}const PN=(t,e)=>e.some(n=>t instanceof n);let aw,lw;function NN(){return aw||(aw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DN(){return lw||(lw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ex=new WeakMap,Zp=new WeakMap,Tx=new WeakMap,jf=new WeakMap,Og=new WeakMap;function jN(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(fs(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Ex.set(n,t)}).catch(()=>{}),Og.set(e,t),e}function LN(t){if(Zp.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Zp.set(t,e)}let em={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Zp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Tx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return fs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function VN(t){em=t(em)}function MN(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Lf(this),e,...n);return Tx.set(r,e.sort?e.sort():[e]),fs(r)}:DN().includes(t)?function(...e){return t.apply(Lf(this),e),fs(Ex.get(this))}:function(...e){return fs(t.apply(Lf(this),e))}}function ON(t){return typeof t=="function"?MN(t):(t instanceof IDBTransaction&&LN(t),PN(t,NN())?new Proxy(t,em):t)}function fs(t){if(t instanceof IDBRequest)return jN(t);if(jf.has(t))return jf.get(t);const e=ON(t);return e!==t&&(jf.set(t,e),Og.set(e,t)),e}const Lf=t=>Og.get(t);function FN(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=fs(o);return r&&o.addEventListener("upgradeneeded",l=>{r(fs(o.result),l.oldVersion,l.newVersion,fs(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const UN=["get","getKey","getAll","getAllKeys","count"],BN=["put","add","delete","clear"],Vf=new Map;function uw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Vf.get(e))return Vf.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=BN.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||UN.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(a.shift())),(await Promise.all([h[n](...a),s&&l.done]))[0]};return Vf.set(e,i),i}VN(t=>({...t,get:(e,n,r)=>uw(e,n)||t.get(e,n,r),has:(e,n)=>!!uw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if($N(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function $N(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const tm="@firebase/app",cw="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr=new Mg("@firebase/app"),HN="@firebase/app-compat",qN="@firebase/analytics-compat",WN="@firebase/analytics",KN="@firebase/app-check-compat",GN="@firebase/app-check",QN="@firebase/auth",XN="@firebase/auth-compat",YN="@firebase/database",JN="@firebase/data-connect",ZN="@firebase/database-compat",e2="@firebase/functions",t2="@firebase/functions-compat",n2="@firebase/installations",r2="@firebase/installations-compat",s2="@firebase/messaging",i2="@firebase/messaging-compat",o2="@firebase/performance",a2="@firebase/performance-compat",l2="@firebase/remote-config",u2="@firebase/remote-config-compat",c2="@firebase/storage",h2="@firebase/storage-compat",d2="@firebase/firestore",f2="@firebase/ai",p2="@firebase/firestore-compat",m2="firebase",g2="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nm="[DEFAULT]",y2={[tm]:"fire-core",[HN]:"fire-core-compat",[WN]:"fire-analytics",[qN]:"fire-analytics-compat",[GN]:"fire-app-check",[KN]:"fire-app-check-compat",[QN]:"fire-auth",[XN]:"fire-auth-compat",[YN]:"fire-rtdb",[JN]:"fire-data-connect",[ZN]:"fire-rtdb-compat",[e2]:"fire-fn",[t2]:"fire-fn-compat",[n2]:"fire-iid",[r2]:"fire-iid-compat",[s2]:"fire-fcm",[i2]:"fire-fcm-compat",[o2]:"fire-perf",[a2]:"fire-perf-compat",[l2]:"fire-rc",[u2]:"fire-rc-compat",[c2]:"fire-gcs",[h2]:"fire-gcs-compat",[d2]:"fire-fst",[p2]:"fire-fst-compat",[f2]:"fire-vertex","fire-js":"fire-js",[m2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h=new Map,_2=new Map,rm=new Map;function hw(t,e){try{t.container.addComponent(e)}catch(n){Cr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function mi(t){const e=t.name;if(rm.has(e))return Cr.debug(`There were multiple attempts to register component ${e}.`),!1;rm.set(e,t);for(const n of _h.values())hw(n,t);for(const n of _2.values())hw(n,t);return!0}function ld(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function on(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ps=new au("app","Firebase",v2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ws("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ps.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri=g2;function Ix(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:nm,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw ps.create("bad-app-name",{appName:String(s)});if(n||(n=px()),!n)throw ps.create("no-options");const i=_h.get(s);if(i){if(pi(n,i.options)&&pi(r,i.config))return i;throw ps.create("duplicate-app",{appName:s})}const o=new kN(s);for(const l of rm.values())o.addComponent(l);const a=new w2(n,r,o);return _h.set(s,a),a}function Fg(t=nm){const e=_h.get(t);if(!e&&t===nm&&px())return Ix();if(!e)throw ps.create("no-app",{appName:t});return e}function Zn(t,e,n){let r=y2[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Cr.warn(o.join(" "));return}mi(new ws(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E2="firebase-heartbeat-database",T2=1,Vl="firebase-heartbeat-store";let Mf=null;function xx(){return Mf||(Mf=FN(E2,T2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Vl)}catch(n){console.warn(n)}}}}).catch(t=>{throw ps.create("idb-open",{originalErrorMessage:t.message})})),Mf}async function I2(t){try{const n=(await xx()).transaction(Vl),r=await n.objectStore(Vl).get(Sx(t));return await n.done,r}catch(e){if(e instanceof ar)Cr.warn(e.message);else{const n=ps.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Cr.warn(n.message)}}}async function dw(t,e){try{const r=(await xx()).transaction(Vl,"readwrite");await r.objectStore(Vl).put(e,Sx(t)),await r.done}catch(n){if(n instanceof ar)Cr.warn(n.message);else{const r=ps.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Cr.warn(r.message)}}}function Sx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2=1024,S2=30;class k2{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new A2(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=fw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>S2){const o=b2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Cr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=fw(),{heartbeatsToSend:r,unsentEntries:s}=C2(this._heartbeatsCache.heartbeats),i=yh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Cr.warn(n),""}}}function fw(){return new Date().toISOString().substring(0,10)}function C2(t,e=x2){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),pw(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),pw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class A2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return wx()?mN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await I2(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return dw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return dw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function pw(t){return yh(JSON.stringify({version:2,heartbeats:t})).length}function b2(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R2(t){mi(new ws("platform-logger",e=>new zN(e),"PRIVATE")),mi(new ws("heartbeat",e=>new k2(e),"PRIVATE")),Zn(tm,cw,t),Zn(tm,cw,"esm2020"),Zn("fire-js","")}R2("");var mw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ms,kx;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,y){function v(){}v.prototype=y.prototype,S.F=y.prototype,S.prototype=new v,S.prototype.constructor=S,S.D=function(C,R,D){for(var x=Array(arguments.length-2),le=2;le<arguments.length;le++)x[le-2]=arguments[le];return y.prototype[R].apply(C,x)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,y,v){v||(v=0);const C=Array(16);if(typeof y=="string")for(var R=0;R<16;++R)C[R]=y.charCodeAt(v++)|y.charCodeAt(v++)<<8|y.charCodeAt(v++)<<16|y.charCodeAt(v++)<<24;else for(R=0;R<16;++R)C[R]=y[v++]|y[v++]<<8|y[v++]<<16|y[v++]<<24;y=S.g[0],v=S.g[1],R=S.g[2];let D=S.g[3],x;x=y+(D^v&(R^D))+C[0]+3614090360&4294967295,y=v+(x<<7&4294967295|x>>>25),x=D+(R^y&(v^R))+C[1]+3905402710&4294967295,D=y+(x<<12&4294967295|x>>>20),x=R+(v^D&(y^v))+C[2]+606105819&4294967295,R=D+(x<<17&4294967295|x>>>15),x=v+(y^R&(D^y))+C[3]+3250441966&4294967295,v=R+(x<<22&4294967295|x>>>10),x=y+(D^v&(R^D))+C[4]+4118548399&4294967295,y=v+(x<<7&4294967295|x>>>25),x=D+(R^y&(v^R))+C[5]+1200080426&4294967295,D=y+(x<<12&4294967295|x>>>20),x=R+(v^D&(y^v))+C[6]+2821735955&4294967295,R=D+(x<<17&4294967295|x>>>15),x=v+(y^R&(D^y))+C[7]+4249261313&4294967295,v=R+(x<<22&4294967295|x>>>10),x=y+(D^v&(R^D))+C[8]+1770035416&4294967295,y=v+(x<<7&4294967295|x>>>25),x=D+(R^y&(v^R))+C[9]+2336552879&4294967295,D=y+(x<<12&4294967295|x>>>20),x=R+(v^D&(y^v))+C[10]+4294925233&4294967295,R=D+(x<<17&4294967295|x>>>15),x=v+(y^R&(D^y))+C[11]+2304563134&4294967295,v=R+(x<<22&4294967295|x>>>10),x=y+(D^v&(R^D))+C[12]+1804603682&4294967295,y=v+(x<<7&4294967295|x>>>25),x=D+(R^y&(v^R))+C[13]+4254626195&4294967295,D=y+(x<<12&4294967295|x>>>20),x=R+(v^D&(y^v))+C[14]+2792965006&4294967295,R=D+(x<<17&4294967295|x>>>15),x=v+(y^R&(D^y))+C[15]+1236535329&4294967295,v=R+(x<<22&4294967295|x>>>10),x=y+(R^D&(v^R))+C[1]+4129170786&4294967295,y=v+(x<<5&4294967295|x>>>27),x=D+(v^R&(y^v))+C[6]+3225465664&4294967295,D=y+(x<<9&4294967295|x>>>23),x=R+(y^v&(D^y))+C[11]+643717713&4294967295,R=D+(x<<14&4294967295|x>>>18),x=v+(D^y&(R^D))+C[0]+3921069994&4294967295,v=R+(x<<20&4294967295|x>>>12),x=y+(R^D&(v^R))+C[5]+3593408605&4294967295,y=v+(x<<5&4294967295|x>>>27),x=D+(v^R&(y^v))+C[10]+38016083&4294967295,D=y+(x<<9&4294967295|x>>>23),x=R+(y^v&(D^y))+C[15]+3634488961&4294967295,R=D+(x<<14&4294967295|x>>>18),x=v+(D^y&(R^D))+C[4]+3889429448&4294967295,v=R+(x<<20&4294967295|x>>>12),x=y+(R^D&(v^R))+C[9]+568446438&4294967295,y=v+(x<<5&4294967295|x>>>27),x=D+(v^R&(y^v))+C[14]+3275163606&4294967295,D=y+(x<<9&4294967295|x>>>23),x=R+(y^v&(D^y))+C[3]+4107603335&4294967295,R=D+(x<<14&4294967295|x>>>18),x=v+(D^y&(R^D))+C[8]+1163531501&4294967295,v=R+(x<<20&4294967295|x>>>12),x=y+(R^D&(v^R))+C[13]+2850285829&4294967295,y=v+(x<<5&4294967295|x>>>27),x=D+(v^R&(y^v))+C[2]+4243563512&4294967295,D=y+(x<<9&4294967295|x>>>23),x=R+(y^v&(D^y))+C[7]+1735328473&4294967295,R=D+(x<<14&4294967295|x>>>18),x=v+(D^y&(R^D))+C[12]+2368359562&4294967295,v=R+(x<<20&4294967295|x>>>12),x=y+(v^R^D)+C[5]+4294588738&4294967295,y=v+(x<<4&4294967295|x>>>28),x=D+(y^v^R)+C[8]+2272392833&4294967295,D=y+(x<<11&4294967295|x>>>21),x=R+(D^y^v)+C[11]+1839030562&4294967295,R=D+(x<<16&4294967295|x>>>16),x=v+(R^D^y)+C[14]+4259657740&4294967295,v=R+(x<<23&4294967295|x>>>9),x=y+(v^R^D)+C[1]+2763975236&4294967295,y=v+(x<<4&4294967295|x>>>28),x=D+(y^v^R)+C[4]+1272893353&4294967295,D=y+(x<<11&4294967295|x>>>21),x=R+(D^y^v)+C[7]+4139469664&4294967295,R=D+(x<<16&4294967295|x>>>16),x=v+(R^D^y)+C[10]+3200236656&4294967295,v=R+(x<<23&4294967295|x>>>9),x=y+(v^R^D)+C[13]+681279174&4294967295,y=v+(x<<4&4294967295|x>>>28),x=D+(y^v^R)+C[0]+3936430074&4294967295,D=y+(x<<11&4294967295|x>>>21),x=R+(D^y^v)+C[3]+3572445317&4294967295,R=D+(x<<16&4294967295|x>>>16),x=v+(R^D^y)+C[6]+76029189&4294967295,v=R+(x<<23&4294967295|x>>>9),x=y+(v^R^D)+C[9]+3654602809&4294967295,y=v+(x<<4&4294967295|x>>>28),x=D+(y^v^R)+C[12]+3873151461&4294967295,D=y+(x<<11&4294967295|x>>>21),x=R+(D^y^v)+C[15]+530742520&4294967295,R=D+(x<<16&4294967295|x>>>16),x=v+(R^D^y)+C[2]+3299628645&4294967295,v=R+(x<<23&4294967295|x>>>9),x=y+(R^(v|~D))+C[0]+4096336452&4294967295,y=v+(x<<6&4294967295|x>>>26),x=D+(v^(y|~R))+C[7]+1126891415&4294967295,D=y+(x<<10&4294967295|x>>>22),x=R+(y^(D|~v))+C[14]+2878612391&4294967295,R=D+(x<<15&4294967295|x>>>17),x=v+(D^(R|~y))+C[5]+4237533241&4294967295,v=R+(x<<21&4294967295|x>>>11),x=y+(R^(v|~D))+C[12]+1700485571&4294967295,y=v+(x<<6&4294967295|x>>>26),x=D+(v^(y|~R))+C[3]+2399980690&4294967295,D=y+(x<<10&4294967295|x>>>22),x=R+(y^(D|~v))+C[10]+4293915773&4294967295,R=D+(x<<15&4294967295|x>>>17),x=v+(D^(R|~y))+C[1]+2240044497&4294967295,v=R+(x<<21&4294967295|x>>>11),x=y+(R^(v|~D))+C[8]+1873313359&4294967295,y=v+(x<<6&4294967295|x>>>26),x=D+(v^(y|~R))+C[15]+4264355552&4294967295,D=y+(x<<10&4294967295|x>>>22),x=R+(y^(D|~v))+C[6]+2734768916&4294967295,R=D+(x<<15&4294967295|x>>>17),x=v+(D^(R|~y))+C[13]+1309151649&4294967295,v=R+(x<<21&4294967295|x>>>11),x=y+(R^(v|~D))+C[4]+4149444226&4294967295,y=v+(x<<6&4294967295|x>>>26),x=D+(v^(y|~R))+C[11]+3174756917&4294967295,D=y+(x<<10&4294967295|x>>>22),x=R+(y^(D|~v))+C[2]+718787259&4294967295,R=D+(x<<15&4294967295|x>>>17),x=v+(D^(R|~y))+C[9]+3951481745&4294967295,S.g[0]=S.g[0]+y&4294967295,S.g[1]=S.g[1]+(R+(x<<21&4294967295|x>>>11))&4294967295,S.g[2]=S.g[2]+R&4294967295,S.g[3]=S.g[3]+D&4294967295}r.prototype.v=function(S,y){y===void 0&&(y=S.length);const v=y-this.blockSize,C=this.C;let R=this.h,D=0;for(;D<y;){if(R==0)for(;D<=v;)s(this,S,D),D+=this.blockSize;if(typeof S=="string"){for(;D<y;)if(C[R++]=S.charCodeAt(D++),R==this.blockSize){s(this,C),R=0;break}}else for(;D<y;)if(C[R++]=S[D++],R==this.blockSize){s(this,C),R=0;break}}this.h=R,this.o+=y},r.prototype.A=function(){var S=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);S[0]=128;for(var y=1;y<S.length-8;++y)S[y]=0;y=this.o*8;for(var v=S.length-8;v<S.length;++v)S[v]=y&255,y/=256;for(this.v(S),S=Array(16),y=0,v=0;v<4;++v)for(let C=0;C<32;C+=8)S[y++]=this.g[v]>>>C&255;return S};function i(S,y){var v=a;return Object.prototype.hasOwnProperty.call(v,S)?v[S]:v[S]=y(S)}function o(S,y){this.h=y;const v=[];let C=!0;for(let R=S.length-1;R>=0;R--){const D=S[R]|0;C&&D==y||(v[R]=D,C=!1)}this.g=v}var a={};function l(S){return-128<=S&&S<128?i(S,function(y){return new o([y|0],y<0?-1:0)}):new o([S|0],S<0?-1:0)}function h(S){if(isNaN(S)||!isFinite(S))return p;if(S<0)return b(h(-S));const y=[];let v=1;for(let C=0;S>=v;C++)y[C]=S/v|0,v*=4294967296;return new o(y,0)}function d(S,y){if(S.length==0)throw Error("number format error: empty string");if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(S.charAt(0)=="-")return b(d(S.substring(1),y));if(S.indexOf("-")>=0)throw Error('number format error: interior "-" character');const v=h(Math.pow(y,8));let C=p;for(let D=0;D<S.length;D+=8){var R=Math.min(8,S.length-D);const x=parseInt(S.substring(D,D+R),y);R<8?(R=h(Math.pow(y,R)),C=C.j(R).add(h(x))):(C=C.j(v),C=C.add(h(x)))}return C}var p=l(0),m=l(1),_=l(16777216);t=o.prototype,t.m=function(){if(A(this))return-b(this).m();let S=0,y=1;for(let v=0;v<this.g.length;v++){const C=this.i(v);S+=(C>=0?C:4294967296+C)*y,y*=4294967296}return S},t.toString=function(S){if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(k(this))return"0";if(A(this))return"-"+b(this).toString(S);const y=h(Math.pow(S,6));var v=this;let C="";for(;;){const R=N(v,y).g;v=T(v,R.j(y));let D=((v.g.length>0?v.g[0]:v.h)>>>0).toString(S);if(v=R,k(v))return D+C;for(;D.length<6;)D="0"+D;C=D+C}},t.i=function(S){return S<0?0:S<this.g.length?this.g[S]:this.h};function k(S){if(S.h!=0)return!1;for(let y=0;y<S.g.length;y++)if(S.g[y]!=0)return!1;return!0}function A(S){return S.h==-1}t.l=function(S){return S=T(this,S),A(S)?-1:k(S)?0:1};function b(S){const y=S.g.length,v=[];for(let C=0;C<y;C++)v[C]=~S.g[C];return new o(v,~S.h).add(m)}t.abs=function(){return A(this)?b(this):this},t.add=function(S){const y=Math.max(this.g.length,S.g.length),v=[];let C=0;for(let R=0;R<=y;R++){let D=C+(this.i(R)&65535)+(S.i(R)&65535),x=(D>>>16)+(this.i(R)>>>16)+(S.i(R)>>>16);C=x>>>16,D&=65535,x&=65535,v[R]=x<<16|D}return new o(v,v[v.length-1]&-2147483648?-1:0)};function T(S,y){return S.add(b(y))}t.j=function(S){if(k(this)||k(S))return p;if(A(this))return A(S)?b(this).j(b(S)):b(b(this).j(S));if(A(S))return b(this.j(b(S)));if(this.l(_)<0&&S.l(_)<0)return h(this.m()*S.m());const y=this.g.length+S.g.length,v=[];for(var C=0;C<2*y;C++)v[C]=0;for(C=0;C<this.g.length;C++)for(let R=0;R<S.g.length;R++){const D=this.i(C)>>>16,x=this.i(C)&65535,le=S.i(R)>>>16,me=S.i(R)&65535;v[2*C+2*R]+=x*me,w(v,2*C+2*R),v[2*C+2*R+1]+=D*me,w(v,2*C+2*R+1),v[2*C+2*R+1]+=x*le,w(v,2*C+2*R+1),v[2*C+2*R+2]+=D*le,w(v,2*C+2*R+2)}for(S=0;S<y;S++)v[S]=v[2*S+1]<<16|v[2*S];for(S=y;S<2*y;S++)v[S]=0;return new o(v,0)};function w(S,y){for(;(S[y]&65535)!=S[y];)S[y+1]+=S[y]>>>16,S[y]&=65535,y++}function E(S,y){this.g=S,this.h=y}function N(S,y){if(k(y))throw Error("division by zero");if(k(S))return new E(p,p);if(A(S))return y=N(b(S),y),new E(b(y.g),b(y.h));if(A(y))return y=N(S,b(y)),new E(b(y.g),y.h);if(S.g.length>30){if(A(S)||A(y))throw Error("slowDivide_ only works with positive integers.");for(var v=m,C=y;C.l(S)<=0;)v=j(v),C=j(C);var R=F(v,1),D=F(C,1);for(C=F(C,2),v=F(v,2);!k(C);){var x=D.add(C);x.l(S)<=0&&(R=R.add(v),D=x),C=F(C,1),v=F(v,1)}return y=T(S,R.j(y)),new E(R,y)}for(R=p;S.l(y)>=0;){for(v=Math.max(1,Math.floor(S.m()/y.m())),C=Math.ceil(Math.log(v)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),D=h(v),x=D.j(y);A(x)||x.l(S)>0;)v-=C,D=h(v),x=D.j(y);k(D)&&(D=m),R=R.add(D),S=T(S,x)}return new E(R,S)}t.B=function(S){return N(this,S).h},t.and=function(S){const y=Math.max(this.g.length,S.g.length),v=[];for(let C=0;C<y;C++)v[C]=this.i(C)&S.i(C);return new o(v,this.h&S.h)},t.or=function(S){const y=Math.max(this.g.length,S.g.length),v=[];for(let C=0;C<y;C++)v[C]=this.i(C)|S.i(C);return new o(v,this.h|S.h)},t.xor=function(S){const y=Math.max(this.g.length,S.g.length),v=[];for(let C=0;C<y;C++)v[C]=this.i(C)^S.i(C);return new o(v,this.h^S.h)};function j(S){const y=S.g.length+1,v=[];for(let C=0;C<y;C++)v[C]=S.i(C)<<1|S.i(C-1)>>>31;return new o(v,S.h)}function F(S,y){const v=y>>5;y%=32;const C=S.g.length-v,R=[];for(let D=0;D<C;D++)R[D]=y>0?S.i(D+v)>>>y|S.i(D+v+1)<<32-y:S.i(D+v);return new o(R,S.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,kx=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,ms=o}).apply(typeof mw<"u"?mw:typeof self<"u"?self:typeof window<"u"?window:{});var nc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cx,qa,Ax,bc,sm,bx,Rx,Px;(function(){var t,e=Object.defineProperty;function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof nc=="object"&&nc];for(var f=0;f<u.length;++f){var g=u[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(u,f){if(f)e:{var g=r;u=u.split(".");for(var I=0;I<u.length-1;I++){var M=u[I];if(!(M in g))break e;g=g[M]}u=u[u.length-1],I=g[u],f=f(I),f!=I&&f!=null&&e(g,u,{configurable:!0,writable:!0,value:f})}}s("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(u){return u||function(f){var g=[],I;for(I in f)Object.prototype.hasOwnProperty.call(f,I)&&g.push([I,f[I]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function l(u,f,g){return u.call.apply(u.bind,arguments)}function h(u,f,g){return h=l,h.apply(null,arguments)}function d(u,f){var g=Array.prototype.slice.call(arguments,1);return function(){var I=g.slice();return I.push.apply(I,arguments),u.apply(this,I)}}function p(u,f){function g(){}g.prototype=f.prototype,u.Z=f.prototype,u.prototype=new g,u.prototype.constructor=u,u.Ob=function(I,M,O){for(var Q=Array(arguments.length-2),fe=2;fe<arguments.length;fe++)Q[fe-2]=arguments[fe];return f.prototype[M].apply(I,Q)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function _(u){const f=u.length;if(f>0){const g=Array(f);for(let I=0;I<f;I++)g[I]=u[I];return g}return[]}function k(u,f){for(let I=1;I<arguments.length;I++){const M=arguments[I];var g=typeof M;if(g=g!="object"?g:M?Array.isArray(M)?"array":g:"null",g=="array"||g=="object"&&typeof M.length=="number"){g=u.length||0;const O=M.length||0;u.length=g+O;for(let Q=0;Q<O;Q++)u[g+Q]=M[Q]}else u.push(M)}}class A{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function b(u){o.setTimeout(()=>{throw u},0)}function T(){var u=S;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class w{constructor(){this.h=this.g=null}add(f,g){const I=E.get();I.set(f,g),this.h?this.h.next=I:this.g=I,this.h=I}}var E=new A(()=>new N,u=>u.reset());class N{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let j,F=!1,S=new w,y=()=>{const u=Promise.resolve(void 0);j=()=>{u.then(v)}};function v(){for(var u;u=T();){try{u.h.call(u.g)}catch(g){b(g)}var f=E;f.j(u),f.h<100&&(f.h++,u.next=f.g,f.g=u)}F=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function R(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}R.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const g=()=>{};o.addEventListener("test",g,f),o.removeEventListener("test",g,f)}catch{}return u}();function x(u){return/^[\s\xa0]*$/.test(u)}function le(u,f){R.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,f)}p(le,R),le.prototype.init=function(u,f){const g=this.type=u.type,I=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget,f||(g=="mouseover"?f=u.fromElement:g=="mouseout"&&(f=u.toElement)),this.relatedTarget=f,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&le.Z.h.call(this)},le.prototype.h=function(){le.Z.h.call(this);const u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var me="closure_listenable_"+(Math.random()*1e6|0),et=0;function ot(u,f,g,I,M){this.listener=u,this.proxy=null,this.src=f,this.type=g,this.capture=!!I,this.ha=M,this.key=++et,this.da=this.fa=!1}function K(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function se(u,f,g){for(const I in u)f.call(g,u[I],I,u)}function L(u,f){for(const g in u)f.call(void 0,u[g],g,u)}function G(u){const f={};for(const g in u)f[g]=u[g];return f}const B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Y(u,f){let g,I;for(let M=1;M<arguments.length;M++){I=arguments[M];for(g in I)u[g]=I[g];for(let O=0;O<B.length;O++)g=B[O],Object.prototype.hasOwnProperty.call(I,g)&&(u[g]=I[g])}}function re(u){this.src=u,this.g={},this.h=0}re.prototype.add=function(u,f,g,I,M){const O=u.toString();u=this.g[O],u||(u=this.g[O]=[],this.h++);const Q=Se(u,f,I,M);return Q>-1?(f=u[Q],g||(f.fa=!1)):(f=new ot(f,this.src,O,!!I,M),f.fa=g,u.push(f)),f};function xe(u,f){const g=f.type;if(g in u.g){var I=u.g[g],M=Array.prototype.indexOf.call(I,f,void 0),O;(O=M>=0)&&Array.prototype.splice.call(I,M,1),O&&(K(f),u.g[g].length==0&&(delete u.g[g],u.h--))}}function Se(u,f,g,I){for(let M=0;M<u.length;++M){const O=u[M];if(!O.da&&O.listener==f&&O.capture==!!g&&O.ha==I)return M}return-1}var Ne="closure_lm_"+(Math.random()*1e6|0),Kt={};function we(u,f,g,I,M){if(Array.isArray(f)){for(let O=0;O<f.length;O++)we(u,f[O],g,I,M);return null}return g=ji(g),u&&u[me]?u.J(f,g,a(I)?!!I.capture:!1,M):tt(u,f,g,!1,I,M)}function tt(u,f,g,I,M,O){if(!f)throw Error("Invalid event type");const Q=a(M)?!!M.capture:!!M;let fe=J(u);if(fe||(u[Ne]=fe=new re(u)),g=fe.add(f,g,I,Q,O),g.proxy)return g;if(I=at(),g.proxy=I,I.src=u,I.listener=g,u.addEventListener)D||(M=Q),M===void 0&&(M=!1),u.addEventListener(f.toString(),I,M);else if(u.attachEvent)u.attachEvent(Et(f.toString()),I);else if(u.addListener&&u.removeListener)u.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return g}function at(){function u(g){return f.call(u.src,u.listener,g)}const f=pt;return u}function H(u,f,g,I,M){if(Array.isArray(f))for(var O=0;O<f.length;O++)H(u,f[O],g,I,M);else I=a(I)?!!I.capture:!!I,g=ji(g),u&&u[me]?(u=u.i,O=String(f).toString(),O in u.g&&(f=u.g[O],g=Se(f,g,I,M),g>-1&&(K(f[g]),Array.prototype.splice.call(f,g,1),f.length==0&&(delete u.g[O],u.h--)))):u&&(u=J(u))&&(f=u.g[f.toString()],u=-1,f&&(u=Se(f,g,I,M)),(g=u>-1?f[u]:null)&&Ee(g))}function Ee(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[me])xe(f.i,u);else{var g=u.type,I=u.proxy;f.removeEventListener?f.removeEventListener(g,I,u.capture):f.detachEvent?f.detachEvent(Et(g),I):f.addListener&&f.removeListener&&f.removeListener(I),(g=J(f))?(xe(g,u),g.h==0&&(g.src=null,f[Ne]=null)):K(u)}}}function Et(u){return u in Kt?Kt[u]:Kt[u]="on"+u}function pt(u,f){if(u.da)u=!0;else{f=new le(f,this);const g=u.listener,I=u.ha||u.src;u.fa&&Ee(u),u=g.call(I,f)}return u}function J(u){return u=u[Ne],u instanceof re?u:null}var Ge="__closure_events_fn_"+(Math.random()*1e9>>>0);function ji(u){return typeof u=="function"?u:(u[Ge]||(u[Ge]=function(f){return u.handleEvent(f)}),u[Ge])}function Me(){C.call(this),this.i=new re(this),this.M=this,this.G=null}p(Me,C),Me.prototype[me]=!0,Me.prototype.removeEventListener=function(u,f,g,I){H(this,u,f,g,I)};function q(u,f){var g,I=u.G;if(I)for(g=[];I;I=I.G)g.push(I);if(u=u.M,I=f.type||f,typeof f=="string")f=new R(f,u);else if(f instanceof R)f.target=f.target||u;else{var M=f;f=new R(I,u),Y(f,M)}M=!0;let O,Q;if(g)for(Q=g.length-1;Q>=0;Q--)O=f.g=g[Q],M=Z(O,I,!0,f)&&M;if(O=f.g=u,M=Z(O,I,!0,f)&&M,M=Z(O,I,!1,f)&&M,g)for(Q=0;Q<g.length;Q++)O=f.g=g[Q],M=Z(O,I,!1,f)&&M}Me.prototype.N=function(){if(Me.Z.N.call(this),this.i){var u=this.i;for(const f in u.g){const g=u.g[f];for(let I=0;I<g.length;I++)K(g[I]);delete u.g[f],u.h--}}this.G=null},Me.prototype.J=function(u,f,g,I){return this.i.add(String(u),f,!1,g,I)},Me.prototype.K=function(u,f,g,I){return this.i.add(String(u),f,!0,g,I)};function Z(u,f,g,I){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();let M=!0;for(let O=0;O<f.length;++O){const Q=f[O];if(Q&&!Q.da&&Q.capture==g){const fe=Q.listener,lt=Q.ha||Q.src;Q.fa&&xe(u.i,Q),M=fe.call(lt,I)!==!1&&M}}return M&&!I.defaultPrevented}function ee(u,f){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=h(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:o.setTimeout(u,f||0)}function ue(u){u.g=ee(()=>{u.g=null,u.i&&(u.i=!1,ue(u))},u.l);const f=u.h;u.h=null,u.m.apply(null,f)}class ce extends C{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:ue(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function mt(u){C.call(this),this.h=u,this.g={}}p(mt,C);var Tt=[];function bn(u){se(u.g,function(f,g){this.g.hasOwnProperty(g)&&Ee(f)},u),u.g={}}mt.prototype.N=function(){mt.Z.N.call(this),bn(this)},mt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ia=o.JSON.stringify,Li=o.JSON.parse,Xk=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function Ky(){}function Gy(){}var oa={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Od(){R.call(this,"d")}p(Od,R);function Fd(){R.call(this,"c")}p(Fd,R);var js={},Qy=null;function ku(){return Qy=Qy||new Me}js.Ia="serverreachability";function Xy(u){R.call(this,js.Ia,u)}p(Xy,R);function aa(u){const f=ku();q(f,new Xy(f))}js.STAT_EVENT="statevent";function Yy(u,f){R.call(this,js.STAT_EVENT,u),this.stat=f}p(Yy,R);function Ot(u){const f=ku();q(f,new Yy(f,u))}js.Ja="timingevent";function Jy(u,f){R.call(this,js.Ja,u),this.size=f}p(Jy,R);function la(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},f)}function ua(){this.g=!0}ua.prototype.ua=function(){this.g=!1};function Yk(u,f,g,I,M,O){u.info(function(){if(u.g)if(O){var Q="",fe=O.split("&");for(let Re=0;Re<fe.length;Re++){var lt=fe[Re].split("=");if(lt.length>1){const gt=lt[0];lt=lt[1];const zn=gt.split("_");Q=zn.length>=2&&zn[1]=="type"?Q+(gt+"="+lt+"&"):Q+(gt+"=redacted&")}}}else Q=null;else Q=O;return"XMLHTTP REQ ("+I+") [attempt "+M+"]: "+f+`
`+g+`
`+Q})}function Jk(u,f,g,I,M,O,Q){u.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+M+"]: "+f+`
`+g+`
`+O+" "+Q})}function Vi(u,f,g,I){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+eC(u,g)+(I?" "+I:"")})}function Zk(u,f){u.info(function(){return"TIMEOUT: "+f})}ua.prototype.info=function(){};function eC(u,f){if(!u.g)return f;if(!f)return null;try{const O=JSON.parse(f);if(O){for(u=0;u<O.length;u++)if(Array.isArray(O[u])){var g=O[u];if(!(g.length<2)){var I=g[1];if(Array.isArray(I)&&!(I.length<1)){var M=I[0];if(M!="noop"&&M!="stop"&&M!="close")for(let Q=1;Q<I.length;Q++)I[Q]=""}}}}return ia(O)}catch{return f}}var Cu={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Zy={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},e_;function Ud(){}p(Ud,Ky),Ud.prototype.g=function(){return new XMLHttpRequest},e_=new Ud;function ca(u){return encodeURIComponent(String(u))}function tC(u){var f=1;u=u.split(":");const g=[];for(;f>0&&u.length;)g.push(u.shift()),f--;return u.length&&g.push(u.join(":")),g}function Vr(u,f,g,I){this.j=u,this.i=f,this.l=g,this.S=I||1,this.V=new mt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new t_}function t_(){this.i=null,this.g="",this.h=!1}var n_={},Bd={};function zd(u,f,g){u.M=1,u.A=bu(Bn(f)),u.u=g,u.R=!0,r_(u,null)}function r_(u,f){u.F=Date.now(),Au(u),u.B=Bn(u.A);var g=u.B,I=u.S;Array.isArray(I)||(I=[String(I)]),g_(g.i,"t",I),u.C=0,g=u.j.L,u.h=new t_,u.g=j_(u.j,g?f:null,!u.u),u.P>0&&(u.O=new ce(h(u.Y,u,u.g),u.P)),f=u.V,g=u.g,I=u.ba;var M="readystatechange";Array.isArray(M)||(M&&(Tt[0]=M.toString()),M=Tt);for(let O=0;O<M.length;O++){const Q=we(g,M[O],I||f.handleEvent,!1,f.h||f);if(!Q)break;f.g[Q.key]=Q}f=u.J?G(u.J):{},u.u?(u.v||(u.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,f)):(u.v="GET",u.g.ea(u.B,u.v,null,f)),aa(),Yk(u.i,u.v,u.B,u.l,u.S,u.u)}Vr.prototype.ba=function(u){u=u.target;const f=this.O;f&&Fr(u)==3?f.j():this.Y(u)},Vr.prototype.Y=function(u){try{if(u==this.g)e:{const fe=Fr(this.g),lt=this.g.ya(),Re=this.g.ca();if(!(fe<3)&&(fe!=3||this.g&&(this.h.h||this.g.la()||I_(this.g)))){this.K||fe!=4||lt==7||(lt==8||Re<=0?aa(3):aa(2)),$d(this);var f=this.g.ca();this.X=f;var g=nC(this);if(this.o=f==200,Jk(this.i,this.v,this.B,this.l,this.S,fe,f),this.o){if(this.U&&!this.L){t:{if(this.g){var I,M=this.g;if((I=M.g?M.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(I)){var O=I;break t}}O=null}if(u=O)Vi(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Hd(this,u);else{this.o=!1,this.m=3,Ot(12),Ls(this),ha(this);break e}}if(this.R){u=!0;let gt;for(;!this.K&&this.C<g.length;)if(gt=rC(this,g),gt==Bd){fe==4&&(this.m=4,Ot(14),u=!1),Vi(this.i,this.l,null,"[Incomplete Response]");break}else if(gt==n_){this.m=4,Ot(15),Vi(this.i,this.l,g,"[Invalid Chunk]"),u=!1;break}else Vi(this.i,this.l,gt,null),Hd(this,gt);if(s_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),fe!=4||g.length!=0||this.h.h||(this.m=1,Ot(16),u=!1),this.o=this.o&&u,!u)Vi(this.i,this.l,g,"[Invalid Chunked Response]"),Ls(this),ha(this);else if(g.length>0&&!this.W){this.W=!0;var Q=this.j;Q.g==this&&Q.aa&&!Q.P&&(Q.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),Jd(Q),Q.P=!0,Ot(11))}}else Vi(this.i,this.l,g,null),Hd(this,g);fe==4&&Ls(this),this.o&&!this.K&&(fe==4?R_(this.j,this):(this.o=!1,Au(this)))}else yC(this.g),f==400&&g.indexOf("Unknown SID")>0?(this.m=3,Ot(12)):(this.m=0,Ot(13)),Ls(this),ha(this)}}}catch{}finally{}};function nC(u){if(!s_(u))return u.g.la();const f=I_(u.g);if(f==="")return"";let g="";const I=f.length,M=Fr(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Ls(u),ha(u),"";u.h.i=new o.TextDecoder}for(let O=0;O<I;O++)u.h.h=!0,g+=u.h.i.decode(f[O],{stream:!(M&&O==I-1)});return f.length=0,u.h.g+=g,u.C=0,u.h.g}function s_(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function rC(u,f){var g=u.C,I=f.indexOf(`
`,g);return I==-1?Bd:(g=Number(f.substring(g,I)),isNaN(g)?n_:(I+=1,I+g>f.length?Bd:(f=f.slice(I,I+g),u.C=I+g,f)))}Vr.prototype.cancel=function(){this.K=!0,Ls(this)};function Au(u){u.T=Date.now()+u.H,i_(u,u.H)}function i_(u,f){if(u.D!=null)throw Error("WatchDog timer not null");u.D=la(h(u.aa,u),f)}function $d(u){u.D&&(o.clearTimeout(u.D),u.D=null)}Vr.prototype.aa=function(){this.D=null;const u=Date.now();u-this.T>=0?(Zk(this.i,this.B),this.M!=2&&(aa(),Ot(17)),Ls(this),this.m=2,ha(this)):i_(this,this.T-u)};function ha(u){u.j.I==0||u.K||R_(u.j,u)}function Ls(u){$d(u);var f=u.O;f&&typeof f.dispose=="function"&&f.dispose(),u.O=null,bn(u.V),u.g&&(f=u.g,u.g=null,f.abort(),f.dispose())}function Hd(u,f){try{var g=u.j;if(g.I!=0&&(g.g==u||qd(g.h,u))){if(!u.L&&qd(g.h,u)&&g.I==3){try{var I=g.Ba.g.parse(f)}catch{I=null}if(Array.isArray(I)&&I.length==3){var M=I;if(M[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<u.F)ju(g),Nu(g);else break e;Yd(g),Ot(18)}}else g.xa=M[1],0<g.xa-g.K&&M[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=la(h(g.Va,g),6e3));l_(g.h)<=1&&g.ta&&(g.ta=void 0)}else Ms(g,11)}else if((u.L||g.g==u)&&ju(g),!x(f))for(M=g.Ba.g.parse(f),f=0;f<M.length;f++){let Re=M[f];const gt=Re[0];if(!(gt<=g.K))if(g.K=gt,Re=Re[1],g.I==2)if(Re[0]=="c"){g.M=Re[1],g.ba=Re[2];const zn=Re[3];zn!=null&&(g.ka=zn,g.j.info("VER="+g.ka));const Os=Re[4];Os!=null&&(g.za=Os,g.j.info("SVER="+g.za));const Ur=Re[5];Ur!=null&&typeof Ur=="number"&&Ur>0&&(I=1.5*Ur,g.O=I,g.j.info("backChannelRequestTimeoutMs_="+I)),I=g;const Br=u.g;if(Br){const Vu=Br.g?Br.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vu){var O=I.h;O.g||Vu.indexOf("spdy")==-1&&Vu.indexOf("quic")==-1&&Vu.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(Wd(O,O.h),O.h=null))}if(I.G){const Zd=Br.g?Br.g.getResponseHeader("X-HTTP-Session-Id"):null;Zd&&(I.wa=Zd,De(I.J,I.G,Zd))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-u.F,g.j.info("Handshake RTT: "+g.T+"ms")),I=g;var Q=u;if(I.na=D_(I,I.L?I.ba:null,I.W),Q.L){u_(I.h,Q);var fe=Q,lt=I.O;lt&&(fe.H=lt),fe.D&&($d(fe),Au(fe)),I.g=Q}else A_(I);g.i.length>0&&Du(g)}else Re[0]!="stop"&&Re[0]!="close"||Ms(g,7);else g.I==3&&(Re[0]=="stop"||Re[0]=="close"?Re[0]=="stop"?Ms(g,7):Xd(g):Re[0]!="noop"&&g.l&&g.l.qa(Re),g.A=0)}}aa(4)}catch{}}var sC=class{constructor(u,f){this.g=u,this.map=f}};function o_(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function a_(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function l_(u){return u.h?1:u.g?u.g.size:0}function qd(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function Wd(u,f){u.g?u.g.add(f):u.h=f}function u_(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}o_.prototype.cancel=function(){if(this.i=c_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function c_(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let f=u.i;for(const g of u.g.values())f=f.concat(g.G);return f}return _(u.i)}var h_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function iC(u,f){if(u){u=u.split("&");for(let g=0;g<u.length;g++){const I=u[g].indexOf("=");let M,O=null;I>=0?(M=u[g].substring(0,I),O=u[g].substring(I+1)):M=u[g],f(M,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function Mr(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;u instanceof Mr?(this.l=u.l,da(this,u.j),this.o=u.o,this.g=u.g,fa(this,u.u),this.h=u.h,Kd(this,y_(u.i)),this.m=u.m):u&&(f=String(u).match(h_))?(this.l=!1,da(this,f[1]||"",!0),this.o=pa(f[2]||""),this.g=pa(f[3]||"",!0),fa(this,f[4]),this.h=pa(f[5]||"",!0),Kd(this,f[6]||"",!0),this.m=pa(f[7]||"")):(this.l=!1,this.i=new ga(null,this.l))}Mr.prototype.toString=function(){const u=[];var f=this.j;f&&u.push(ma(f,d_,!0),":");var g=this.g;return(g||f=="file")&&(u.push("//"),(f=this.o)&&u.push(ma(f,d_,!0),"@"),u.push(ca(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&u.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&u.push("/"),u.push(ma(g,g.charAt(0)=="/"?lC:aC,!0))),(g=this.i.toString())&&u.push("?",g),(g=this.m)&&u.push("#",ma(g,cC)),u.join("")},Mr.prototype.resolve=function(u){const f=Bn(this);let g=!!u.j;g?da(f,u.j):g=!!u.o,g?f.o=u.o:g=!!u.g,g?f.g=u.g:g=u.u!=null;var I=u.h;if(g)fa(f,u.u);else if(g=!!u.h){if(I.charAt(0)!="/")if(this.g&&!this.h)I="/"+I;else{var M=f.h.lastIndexOf("/");M!=-1&&(I=f.h.slice(0,M+1)+I)}if(M=I,M==".."||M==".")I="";else if(M.indexOf("./")!=-1||M.indexOf("/.")!=-1){I=M.lastIndexOf("/",0)==0,M=M.split("/");const O=[];for(let Q=0;Q<M.length;){const fe=M[Q++];fe=="."?I&&Q==M.length&&O.push(""):fe==".."?((O.length>1||O.length==1&&O[0]!="")&&O.pop(),I&&Q==M.length&&O.push("")):(O.push(fe),I=!0)}I=O.join("/")}else I=M}return g?f.h=I:g=u.i.toString()!=="",g?Kd(f,y_(u.i)):g=!!u.m,g&&(f.m=u.m),f};function Bn(u){return new Mr(u)}function da(u,f,g){u.j=g?pa(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function fa(u,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);u.u=f}else u.u=null}function Kd(u,f,g){f instanceof ga?(u.i=f,hC(u.i,u.l)):(g||(f=ma(f,uC)),u.i=new ga(f,u.l))}function De(u,f,g){u.i.set(f,g)}function bu(u){return De(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function pa(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function ma(u,f,g){return typeof u=="string"?(u=encodeURI(u).replace(f,oC),g&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function oC(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var d_=/[#\/\?@]/g,aC=/[#\?:]/g,lC=/[#\?]/g,uC=/[#\?@]/g,cC=/#/g;function ga(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function Vs(u){u.g||(u.g=new Map,u.h=0,u.i&&iC(u.i,function(f,g){u.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}t=ga.prototype,t.add=function(u,f){Vs(this),this.i=null,u=Mi(this,u);let g=this.g.get(u);return g||this.g.set(u,g=[]),g.push(f),this.h+=1,this};function f_(u,f){Vs(u),f=Mi(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function p_(u,f){return Vs(u),f=Mi(u,f),u.g.has(f)}t.forEach=function(u,f){Vs(this),this.g.forEach(function(g,I){g.forEach(function(M){u.call(f,M,I,this)},this)},this)};function m_(u,f){Vs(u);let g=[];if(typeof f=="string")p_(u,f)&&(g=g.concat(u.g.get(Mi(u,f))));else for(u=Array.from(u.g.values()),f=0;f<u.length;f++)g=g.concat(u[f]);return g}t.set=function(u,f){return Vs(this),this.i=null,u=Mi(this,u),p_(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},t.get=function(u,f){return u?(u=m_(this,u),u.length>0?String(u[0]):f):f};function g_(u,f,g){f_(u,f),g.length>0&&(u.i=null,u.g.set(Mi(u,f),_(g)),u.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],f=Array.from(this.g.keys());for(let I=0;I<f.length;I++){var g=f[I];const M=ca(g);g=m_(this,g);for(let O=0;O<g.length;O++){let Q=M;g[O]!==""&&(Q+="="+ca(g[O])),u.push(Q)}}return this.i=u.join("&")};function y_(u){const f=new ga;return f.i=u.i,u.g&&(f.g=new Map(u.g),f.h=u.h),f}function Mi(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function hC(u,f){f&&!u.j&&(Vs(u),u.i=null,u.g.forEach(function(g,I){const M=I.toLowerCase();I!=M&&(f_(this,I),g_(this,M,g))},u)),u.j=f}function dC(u,f){const g=new ua;if(o.Image){const I=new Image;I.onload=d(Or,g,"TestLoadImage: loaded",!0,f,I),I.onerror=d(Or,g,"TestLoadImage: error",!1,f,I),I.onabort=d(Or,g,"TestLoadImage: abort",!1,f,I),I.ontimeout=d(Or,g,"TestLoadImage: timeout",!1,f,I),o.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=u}else f(!1)}function fC(u,f){const g=new ua,I=new AbortController,M=setTimeout(()=>{I.abort(),Or(g,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:I.signal}).then(O=>{clearTimeout(M),O.ok?Or(g,"TestPingServer: ok",!0,f):Or(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(M),Or(g,"TestPingServer: error",!1,f)})}function Or(u,f,g,I,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),I(g)}catch{}}function pC(){this.g=new Xk}function Gd(u){this.i=u.Sb||null,this.h=u.ab||!1}p(Gd,Ky),Gd.prototype.g=function(){return new Ru(this.i,this.h)};function Ru(u,f){Me.call(this),this.H=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(Ru,Me),t=Ru.prototype,t.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=f,this.readyState=1,_a(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(f.body=u),(this.H||o).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ya(this)),this.readyState=0},t.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,_a(this)),this.g&&(this.readyState=3,_a(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;__(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function __(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}t.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?ya(this):_a(this),this.readyState==3&&__(this)}},t.Oa=function(u){this.g&&(this.response=this.responseText=u,ya(this))},t.Na=function(u){this.g&&(this.response=u,ya(this))},t.ga=function(){this.g&&ya(this)};function ya(u){u.readyState=4,u.l=null,u.j=null,u.B=null,_a(u)}t.setRequestHeader=function(u,f){this.A.append(u,f)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,u.push(g[0]+": "+g[1]),g=f.next();return u.join(`\r
`)};function _a(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ru.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function v_(u){let f="";return se(u,function(g,I){f+=I,f+=":",f+=g,f+=`\r
`}),f}function Qd(u,f,g){e:{for(I in g){var I=!1;break e}I=!0}I||(g=v_(g),typeof u=="string"?g!=null&&ca(g):De(u,f,g))}function Qe(u){Me.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Qe,Me);var mC=/^https?$/i,gC=["POST","PUT"];t=Qe.prototype,t.Fa=function(u){this.H=u},t.ea=function(u,f,g,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():e_.g(),this.g.onreadystatechange=m(h(this.Ca,this));try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(O){w_(this,O);return}if(u=g||"",g=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var M in I)g.set(M,I[M]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const O of I.keys())g.set(O,I.get(O));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(g.keys()).find(O=>O.toLowerCase()=="content-type"),M=o.FormData&&u instanceof o.FormData,!(Array.prototype.indexOf.call(gC,f,void 0)>=0)||I||M||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[O,Q]of g)this.g.setRequestHeader(O,Q);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(O){w_(this,O)}};function w_(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.o=5,E_(u),Pu(u)}function E_(u){u.A||(u.A=!0,q(u,"complete"),q(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,q(this,"complete"),q(this,"abort"),Pu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Pu(this,!0)),Qe.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?T_(this):this.Xa())},t.Xa=function(){T_(this)};function T_(u){if(u.h&&typeof i<"u"){if(u.v&&Fr(u)==4)setTimeout(u.Ca.bind(u),0);else if(q(u,"readystatechange"),Fr(u)==4){u.h=!1;try{const O=u.ca();e:switch(O){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var g;if(!(g=f)){var I;if(I=O===0){let Q=String(u.D).match(h_)[1]||null;!Q&&o.self&&o.self.location&&(Q=o.self.location.protocol.slice(0,-1)),I=!mC.test(Q?Q.toLowerCase():"")}g=I}if(g)q(u,"complete"),q(u,"success");else{u.o=6;try{var M=Fr(u)>2?u.g.statusText:""}catch{M=""}u.l=M+" ["+u.ca()+"]",E_(u)}}finally{Pu(u)}}}}function Pu(u,f){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);const g=u.g;u.g=null,f||q(u,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Fr(u){return u.g?u.g.readyState:0}t.ca=function(){try{return Fr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),Li(f)}};function I_(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function yC(u){const f={};u=(u.g&&Fr(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<u.length;I++){if(x(u[I]))continue;var g=tC(u[I]);const M=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const O=f[M]||[];f[M]=O,O.push(g)}L(f,function(I){return I.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function va(u,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[u]||f}function x_(u){this.za=0,this.i=[],this.j=new ua,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=va("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=va("baseRetryDelayMs",5e3,u),this.Za=va("retryDelaySeedMs",1e4,u),this.Ta=va("forwardChannelMaxRetries",2,u),this.va=va("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new o_(u&&u.concurrentRequestLimit),this.Ba=new pC,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=x_.prototype,t.ka=8,t.I=1,t.connect=function(u,f,g,I){Ot(0),this.W=u,this.H=f||{},g&&I!==void 0&&(this.H.OSID=g,this.H.OAID=I),this.F=this.X,this.J=D_(this,null,this.W),Du(this)};function Xd(u){if(S_(u),u.I==3){var f=u.V++,g=Bn(u.J);if(De(g,"SID",u.M),De(g,"RID",f),De(g,"TYPE","terminate"),wa(u,g),f=new Vr(u,u.j,f),f.M=2,f.A=bu(Bn(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(f.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=f.A,g=!0),g||(f.g=j_(f.j,null),f.g.ea(f.A)),f.F=Date.now(),Au(f)}N_(u)}function Nu(u){u.g&&(Jd(u),u.g.cancel(),u.g=null)}function S_(u){Nu(u),u.v&&(o.clearTimeout(u.v),u.v=null),ju(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&o.clearTimeout(u.m),u.m=null)}function Du(u){if(!a_(u.h)&&!u.m){u.m=!0;var f=u.Ea;j||y(),F||(j(),F=!0),S.add(f,u),u.D=0}}function _C(u,f){return l_(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=f.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=la(h(u.Ea,u,f),P_(u,u.D)),u.D++,!0)}t.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;const M=new Vr(this,this.j,u);let O=this.o;if(this.U&&(O?(O=G(O),Y(O,this.U)):O=this.U),this.u!==null||this.R||(M.J=O,O=null),this.S)e:{for(var f=0,g=0;g<this.i.length;g++){t:{var I=this.i[g];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(f+=I,f>4096){f=g;break e}if(f===4096||g===this.i.length-1){f=g+1;break e}}f=1e3}else f=1e3;f=C_(this,M,f),g=Bn(this.J),De(g,"RID",u),De(g,"CVER",22),this.G&&De(g,"X-HTTP-Session-Id",this.G),wa(this,g),O&&(this.R?f="headers="+ca(v_(O))+"&"+f:this.u&&Qd(g,this.u,O)),Wd(this.h,M),this.Ra&&De(g,"TYPE","init"),this.S?(De(g,"$req",f),De(g,"SID","null"),M.U=!0,zd(M,g,null)):zd(M,g,f),this.I=2}}else this.I==3&&(u?k_(this,u):this.i.length==0||a_(this.h)||k_(this))};function k_(u,f){var g;f?g=f.l:g=u.V++;const I=Bn(u.J);De(I,"SID",u.M),De(I,"RID",g),De(I,"AID",u.K),wa(u,I),u.u&&u.o&&Qd(I,u.u,u.o),g=new Vr(u,u.j,g,u.D+1),u.u===null&&(g.J=u.o),f&&(u.i=f.G.concat(u.i)),f=C_(u,g,1e3),g.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),Wd(u.h,g),zd(g,I,f)}function wa(u,f){u.H&&se(u.H,function(g,I){De(f,I,g)}),u.l&&se({},function(g,I){De(f,I,g)})}function C_(u,f,g){g=Math.min(u.i.length,g);const I=u.l?h(u.l.Ka,u.l,u):null;e:{var M=u.i;let fe=-1;for(;;){const lt=["count="+g];fe==-1?g>0?(fe=M[0].g,lt.push("ofs="+fe)):fe=0:lt.push("ofs="+fe);let Re=!0;for(let gt=0;gt<g;gt++){var O=M[gt].g;const zn=M[gt].map;if(O-=fe,O<0)fe=Math.max(0,M[gt].g-100),Re=!1;else try{O="req"+O+"_"||"";try{var Q=zn instanceof Map?zn:Object.entries(zn);for(const[Os,Ur]of Q){let Br=Ur;a(Ur)&&(Br=ia(Ur)),lt.push(O+Os+"="+encodeURIComponent(Br))}}catch(Os){throw lt.push(O+"type="+encodeURIComponent("_badmap")),Os}}catch{I&&I(zn)}}if(Re){Q=lt.join("&");break e}}Q=void 0}return u=u.i.splice(0,g),f.G=u,Q}function A_(u){if(!u.g&&!u.v){u.Y=1;var f=u.Da;j||y(),F||(j(),F=!0),S.add(f,u),u.A=0}}function Yd(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=la(h(u.Da,u),P_(u,u.A)),u.A++,!0)}t.Da=function(){if(this.v=null,b_(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=la(h(this.Wa,this),u)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ot(10),Nu(this),b_(this))};function Jd(u){u.B!=null&&(o.clearTimeout(u.B),u.B=null)}function b_(u){u.g=new Vr(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var f=Bn(u.na);De(f,"RID","rpc"),De(f,"SID",u.M),De(f,"AID",u.K),De(f,"CI",u.F?"0":"1"),!u.F&&u.ia&&De(f,"TO",u.ia),De(f,"TYPE","xmlhttp"),wa(u,f),u.u&&u.o&&Qd(f,u.u,u.o),u.O&&(u.g.H=u.O);var g=u.g;u=u.ba,g.M=1,g.A=bu(Bn(f)),g.u=null,g.R=!0,r_(g,u)}t.Va=function(){this.C!=null&&(this.C=null,Nu(this),Yd(this),Ot(19))};function ju(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function R_(u,f){var g=null;if(u.g==f){ju(u),Jd(u),u.g=null;var I=2}else if(qd(u.h,f))g=f.G,u_(u.h,f),I=1;else return;if(u.I!=0){if(f.o)if(I==1){g=f.u?f.u.length:0,f=Date.now()-f.F;var M=u.D;I=ku(),q(I,new Jy(I,g)),Du(u)}else A_(u);else if(M=f.m,M==3||M==0&&f.X>0||!(I==1&&_C(u,f)||I==2&&Yd(u)))switch(g&&g.length>0&&(f=u.h,f.i=f.i.concat(g)),M){case 1:Ms(u,5);break;case 4:Ms(u,10);break;case 3:Ms(u,6);break;default:Ms(u,2)}}}function P_(u,f){let g=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(g*=2),g*f}function Ms(u,f){if(u.j.info("Error code "+f),f==2){var g=h(u.bb,u),I=u.Ua;const M=!I;I=new Mr(I||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||da(I,"https"),bu(I),M?dC(I.toString(),g):fC(I.toString(),g)}else Ot(2);u.I=0,u.l&&u.l.pa(f),N_(u),S_(u)}t.bb=function(u){u?(this.j.info("Successfully pinged google.com"),Ot(2)):(this.j.info("Failed to ping google.com"),Ot(1))};function N_(u){if(u.I=0,u.ja=[],u.l){const f=c_(u.h);(f.length!=0||u.i.length!=0)&&(k(u.ja,f),k(u.ja,u.i),u.h.i.length=0,_(u.i),u.i.length=0),u.l.oa()}}function D_(u,f,g){var I=g instanceof Mr?Bn(g):new Mr(g);if(I.g!="")f&&(I.g=f+"."+I.g),fa(I,I.u);else{var M=o.location;I=M.protocol,f=f?f+"."+M.hostname:M.hostname,M=+M.port;const O=new Mr(null);I&&da(O,I),f&&(O.g=f),M&&fa(O,M),g&&(O.h=g),I=O}return g=u.G,f=u.wa,g&&f&&De(I,g,f),De(I,"VER",u.ka),wa(u,I),I}function j_(u,f,g){if(f&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Aa&&!u.ma?new Qe(new Gd({ab:g})):new Qe(u.ma),f.Fa(u.L),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function L_(){}t=L_.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Lu(){}Lu.prototype.g=function(u,f){return new nn(u,f)};function nn(u,f){Me.call(this),this.g=new x_(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(u?u["X-WebChannel-Client-Profile"]=f.sa:u={"X-WebChannel-Client-Profile":f.sa}),this.g.U=u,(u=f&&f.Qb)&&!x(u)&&(this.g.u=u),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!x(f)&&(this.g.G=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new Oi(this)}p(nn,Me),nn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},nn.prototype.close=function(){Xd(this.g)},nn.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var g={};g.__data__=u,u=g}else this.v&&(g={},g.__data__=ia(u),u=g);f.i.push(new sC(f.Ya++,u)),f.I==3&&Du(f)},nn.prototype.N=function(){this.g.l=null,delete this.j,Xd(this.g),delete this.g,nn.Z.N.call(this)};function V_(u){Od.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(const g in f){u=g;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}p(V_,Od);function M_(){Fd.call(this),this.status=1}p(M_,Fd);function Oi(u){this.g=u}p(Oi,L_),Oi.prototype.ra=function(){q(this.g,"a")},Oi.prototype.qa=function(u){q(this.g,new V_(u))},Oi.prototype.pa=function(u){q(this.g,new M_)},Oi.prototype.oa=function(){q(this.g,"b")},Lu.prototype.createWebChannel=Lu.prototype.g,nn.prototype.send=nn.prototype.o,nn.prototype.open=nn.prototype.m,nn.prototype.close=nn.prototype.close,Px=function(){return new Lu},Rx=function(){return ku()},bx=js,sm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Cu.NO_ERROR=0,Cu.TIMEOUT=8,Cu.HTTP_ERROR=6,bc=Cu,Zy.COMPLETE="complete",Ax=Zy,Gy.EventType=oa,oa.OPEN="a",oa.CLOSE="b",oa.ERROR="c",oa.MESSAGE="d",Me.prototype.listen=Me.prototype.J,qa=Gy,Qe.prototype.listenOnce=Qe.prototype.K,Qe.prototype.getLastError=Qe.prototype.Ha,Qe.prototype.getLastErrorCode=Qe.prototype.ya,Qe.prototype.getStatus=Qe.prototype.ca,Qe.prototype.getResponseJson=Qe.prototype.La,Qe.prototype.getResponseText=Qe.prototype.la,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Fa,Cx=Qe}).apply(typeof nc<"u"?nc:typeof self<"u"?self:typeof window<"u"?window:{});const gw="@firebase/firestore",yw="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}xt.UNAUTHENTICATED=new xt(null),xt.GOOGLE_CREDENTIALS=new xt("google-credentials-uid"),xt.FIRST_PARTY=new xt("first-party-uid"),xt.MOCK_USER=new xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zo="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gi=new Mg("@firebase/firestore");function Gi(){return gi.logLevel}function z(t,...e){if(gi.logLevel<=ye.DEBUG){const n=e.map(Ug);gi.debug(`Firestore (${Zo}): ${t}`,...n)}}function Bt(t,...e){if(gi.logLevel<=ye.ERROR){const n=e.map(Ug);gi.error(`Firestore (${Zo}): ${t}`,...n)}}function yi(t,...e){if(gi.logLevel<=ye.WARN){const n=e.map(Ug);gi.warn(`Firestore (${Zo}): ${t}`,...n)}}function Ug(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ne(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Nx(t,r,n)}function Nx(t,e,n){let r=`FIRESTORE (${Zo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Bt(r),new Error(r)}function ie(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||Nx(e,s,r)}function de(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W extends ar{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class P2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(xt.UNAUTHENTICATED))}shutdown(){}}class N2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class D2{constructor(e){this.t=e,this.currentUser=xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ie(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new er;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new er,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new er)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ie(typeof r.accessToken=="string",31837,{l:r}),new Dx(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ie(e===null||typeof e=="string",2055,{h:e}),new xt(e)}}class j2{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=xt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class L2{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new j2(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class _w{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class V2{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,on(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ie(this.o===void 0,3512);const r=i=>{i.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new _w(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ie(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new _w(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=M2(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function he(t,e){return t<e?-1:t>e?1:0}function im(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Of(s)===Of(i)?he(s,i):Of(s)?1:-1}return he(t.length,e.length)}const O2=55296,F2=57343;function Of(t){const e=t.charCodeAt(0);return e>=O2&&e<=F2}function jo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function jx(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vw="__name__";class Wn{constructor(e,n,r){n===void 0?n=0:n>e.length&&ne(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ne(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Wn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Wn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Wn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return he(e.length,n.length)}static compareSegments(e,n){const r=Wn.isNumericId(e),s=Wn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Wn.extractNumericId(e).compare(Wn.extractNumericId(n)):im(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ms.fromString(e.substring(4,e.length-2))}}class Ie extends Wn{construct(e,n,r){return new Ie(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new W(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ie(n)}static emptyPath(){return new Ie([])}}const U2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ze extends Wn{construct(e,n,r){return new ze(e,n,r)}static isValidIdentifier(e){return U2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ze.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===vw}static keyField(){return new ze([vw])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new W(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new W(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new W(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new W(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ze(n)}static emptyPath(){return new ze([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.path=e}static fromPath(e){return new X(Ie.fromString(e))}static fromName(e){return new X(Ie.fromString(e).popFirst(5))}static empty(){return new X(Ie.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ie.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ie.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new X(new Ie(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lx(t,e,n){if(!n)throw new W(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function B2(t,e,n,r){if(e===!0&&r===!0)throw new W(U.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function ww(t){if(!X.isDocumentKey(t))throw new W(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ew(t){if(X.isDocumentKey(t))throw new W(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Vx(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function ud(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ne(12329,{type:typeof t})}function Cn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new W(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ud(t);throw new W(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function z2(t,e){if(e<=0)throw new W(U.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function st(t,e){const n={typeString:t};return e&&(n.value=e),n}function uu(t,e){if(!Vx(t))throw new W(U.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new W(U.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tw=-62135596800,Iw=1e6;class ke{static now(){return ke.fromMillis(Date.now())}static fromDate(e){return ke.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*Iw);return new ke(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new W(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new W(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Tw)throw new W(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Iw}_compareTo(e){return this.seconds===e.seconds?he(this.nanoseconds,e.nanoseconds):he(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ke._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(uu(e,ke._jsonSchema))return new ke(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Tw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ke._jsonSchemaVersion="firestore/timestamp/1.0",ke._jsonSchema={type:st("string",ke._jsonSchemaVersion),seconds:st("number"),nanoseconds:st("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{static fromTimestamp(e){return new oe(e)}static min(){return new oe(new ke(0,0))}static max(){return new oe(new ke(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ml=-1;class vh{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function om(t){return t.fields.find(e=>e.kind===2)}function $s(t){return t.fields.filter(e=>e.kind!==2)}vh.UNKNOWN_ID=-1;class Rc{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ol{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ol(0,dn.min())}}function $2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=oe.fromTimestamp(r===1e9?new ke(n+1,0):new ke(n,r));return new dn(s,X.empty(),e)}function Mx(t){return new dn(t.readTime,t.key,Ml)}class dn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new dn(oe.min(),X.empty(),Ml)}static max(){return new dn(oe.max(),X.empty(),Ml)}}function zg(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=X.comparator(t.documentKey,e.documentKey),n!==0?n:he(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Fx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pi(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==Ox)throw t;z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ne(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new V((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof V?n:V.resolve(n)}catch(n){return V.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):V.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):V.reject(n)}static resolve(e){return new V((n,r)=>{n(e)})}static reject(e){return new V((n,r)=>{r(e)})}static waitFor(e){return new V((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=V.resolve(!1);for(const r of e)n=n.next(s=>s?V.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new V((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const h=l;n(e[h]).next(d=>{o[h]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new V((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn="SimpleDb";class cd{static open(e,n,r,s){try{return new cd(n,e.transaction(s,r))}catch(i){throw new ll(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new er,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new ll(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=$g(r.target.error);this.S.reject(new ll(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(z(sn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new q2(n)}}class gs{static delete(e){return z(sn,"Removing database:",e),qs(hx().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!wx())return!1;if(gs.F())return!0;const e=dt(),n=gs.M(e),r=0<n&&n<10,s=Ux(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,gs.M(dt())===12.2&&Bt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(z(sn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new ll(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new W(U.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new W(U.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ll(e,o))},s.onupgradeneeded=i=>{z(sn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{z(sn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=cd.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(h=>(a.C(),h)).catch(h=>(a.abort(h),V.reject(h))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,h=l.name!=="FirebaseError"&&o<3;if(z(sn,"Transaction failed with error:",l.message,"Retrying:",h),this.close(),!h)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Ux(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class H2{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return qs(this.U.delete())}}class ll extends W{constructor(e,n){super(U.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function bs(t){return t.name==="IndexedDbTransactionError"}class q2{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(z(sn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(z(sn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),qs(r)}add(e){return z(sn,"ADD",this.store.name,e,e),qs(this.store.add(e))}get(e){return qs(this.store.get(e)).next(n=>(n===void 0&&(n=null),z(sn,"GET",this.store.name,e,n),n))}delete(e){return z(sn,"DELETE",this.store.name,e),qs(this.store.delete(e))}count(){return z(sn,"COUNT",this.store.name),qs(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new V((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.H(i,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new V((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}Z(e,n){z(sn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const s=this.cursor(r);return this.H(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.H(s,n)}te(e){const n=this.cursor({});return new V((r,s)=>{n.onerror=i=>{const o=$g(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new V((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new H2(a),h=n(a.primaryKey,a.value,l);if(h instanceof V){const d=h.catch(p=>(l.done(),V.reject(p)));r.push(d)}l.isDone?s():l.G===null?a.continue():a.continue(l.G)}}).next(()=>V.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function qs(t){return new V((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=$g(r.target.error);n(s)}})}let xw=!1;function $g(t){const e=gs.M(dt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new W("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return xw||(xw=!0,setTimeout(()=>{throw r},0)),r}}return t}const ul="IndexBackfiller";class W2{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){z(ul,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();z(ul,`Documents written: ${n}`)}catch(n){bs(n)?z(ul,"Ignoring IndexedDB error during index backfill: ",n):await Pi(n)}await this.re(6e4)})}}class K2{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return V.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return z(ul,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(z(ul,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=Mx(i);zg(o,r)>0&&(r=o)}),new dn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}En.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si=-1;function hd(t){return t==null}function Fl(t){return t===0&&1/t==-1/0}function G2(t){return typeof t=="number"&&Number.isInteger(t)&&!Fl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh="";function Lt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Sw(e)),e=Q2(t.get(n),e);return Sw(e)}function Q2(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case wh:n+="";break;default:n+=i}}return n}function Sw(t){return t+wh+""}function Gn(t){const e=t.length;if(ie(e>=2,64408,{path:t}),e===2)return ie(t.charAt(0)===wh&&t.charAt(1)==="",56145,{path:t}),Ie.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(wh,i);switch((o<0||o>n)&&ne(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:ne(61167,{path:t})}i=o+2}return new Ie(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs="remoteDocuments",cu="owner",Bi="owner",Ul="mutationQueues",X2="userId",Dn="mutations",kw="batchId",ei="userMutationsIndex",Cw=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(t,e){return[t,Lt(e)]}function Bx(t,e,n){return[t,Lt(e),n]}const Y2={},Lo="documentMutations",Eh="remoteDocumentsV14",J2=["prefixPath","collectionGroup","readTime","documentId"],Nc="documentKeyIndex",Z2=["prefixPath","collectionGroup","documentId"],zx="collectionGroupIndex",eD=["collectionGroup","readTime","prefixPath","documentId"],Bl="remoteDocumentGlobal",am="remoteDocumentGlobalKey",Vo="targets",$x="queryTargetsIndex",tD=["canonicalId","targetId"],Mo="targetDocuments",nD=["targetId","path"],Hg="documentTargetsIndex",rD=["path","targetId"],Th="targetGlobalKey",ii="targetGlobal",zl="collectionParents",sD=["collectionId","parent"],Oo="clientMetadata",iD="clientId",dd="bundles",oD="bundleId",fd="namedQueries",aD="name",qg="indexConfiguration",lD="indexId",lm="collectionGroupIndex",uD="collectionGroup",cl="indexState",cD=["indexId","uid"],Hx="sequenceNumberIndex",hD=["uid","sequenceNumber"],hl="indexEntries",dD=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],qx="documentKeyIndex",fD=["indexId","uid","orderedDocumentKey"],pd="documentOverlays",pD=["userId","collectionPath","documentId"],um="collectionPathOverlayIndex",mD=["userId","collectionPath","largestBatchId"],Wx="collectionGroupOverlayIndex",gD=["userId","collectionGroup","largestBatchId"],Wg="globals",yD="name",Kx=[Ul,Dn,Lo,Hs,Vo,cu,ii,Mo,Oo,Bl,zl,dd,fd],_D=[...Kx,pd],Gx=[Ul,Dn,Lo,Eh,Vo,cu,ii,Mo,Oo,Bl,zl,dd,fd,pd],Qx=Gx,Kg=[...Qx,qg,cl,hl],vD=Kg,Xx=[...Kg,Wg],wD=Xx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm extends Fx{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function ft(t,e){const n=de(t);return gs.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aw(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Rs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Yx(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,n){this.comparator=e,this.root=n||St.EMPTY}insert(e,n){return new Ue(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,St.BLACK,null,null))}remove(e){return new Ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,St.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rc(this.root,e,this.comparator,!1)}getReverseIterator(){return new rc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rc(this.root,e,this.comparator,!0)}}class rc{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class St{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??St.RED,this.left=s??St.EMPTY,this.right=i??St.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new St(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return St.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return St.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,St.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,St.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ne(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ne(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ne(27949);return e+(this.isRed()?0:1)}}St.EMPTY=null,St.RED=!0,St.BLACK=!1;St.EMPTY=new class{constructor(){this.size=0}get key(){throw ne(57766)}get value(){throw ne(16141)}get color(){throw ne(16727)}get left(){throw ne(29726)}get right(){throw ne(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new St(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.comparator=e,this.data=new Ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new bw(this.data.getIterator())}getIteratorFrom(e){return new bw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof be)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new be(this.comparator);return n.data=e,n}}class bw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function zi(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new Jt([])}unionWith(e){let n=new be(ze.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Jt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return jo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Jx("Invalid base64 string: "+i):i}}(e);return new it(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new it(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return he(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}it.EMPTY_BYTE_STRING=new it("");const ED=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ar(t){if(ie(!!t,39018),typeof t=="string"){let e=0;const n=ED.exec(t);if(ie(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Oe(t.seconds),nanos:Oe(t.nanos)}}function Oe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function br(t){return typeof t=="string"?it.fromBase64String(t):it.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx="server_timestamp",eS="__type__",tS="__previous_value__",nS="__local_write_time__";function Gg(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[eS])==null?void 0:r.stringValue)===Zx}function md(t){const e=t.mapValue.fields[tS];return Gg(e)?md(e):e}function $l(t){const e=Ar(t.mapValue.fields[nS].timestampValue);return new ke(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e,n,r,s,i,o,a,l,h,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=d}}const Ih="(default)";class _i{constructor(e,n){this.projectId=e,this.database=n||Ih}static empty(){return new _i("","")}get isDefaultDatabase(){return this.database===Ih}isEqual(e){return e instanceof _i&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg="__type__",rS="__max__",ss={mapValue:{fields:{__type__:{stringValue:rS}}}},Xg="__vector__",Fo="value",Dc={nullValue:"NULL_VALUE"};function Es(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Gg(t)?4:sS(t)?9007199254740991:gd(t)?10:11:ne(28295,{value:t})}function ir(t,e){if(t===e)return!0;const n=Es(t);if(n!==Es(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return $l(t).isEqual($l(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ar(s.timestampValue),a=Ar(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return br(s.bytesValue).isEqual(br(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Oe(s.geoPointValue.latitude)===Oe(i.geoPointValue.latitude)&&Oe(s.geoPointValue.longitude)===Oe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Oe(s.integerValue)===Oe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Oe(s.doubleValue),a=Oe(i.doubleValue);return o===a?Fl(o)===Fl(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return jo(t.arrayValue.values||[],e.arrayValue.values||[],ir);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(Aw(o)!==Aw(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!ir(o[l],a[l])))return!1;return!0}(t,e);default:return ne(52216,{left:t})}}function Hl(t,e){return(t.values||[]).find(n=>ir(n,e))!==void 0}function Ts(t,e){if(t===e)return 0;const n=Es(t),r=Es(e);if(n!==r)return he(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return he(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Oe(i.integerValue||i.doubleValue),l=Oe(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return Rw(t.timestampValue,e.timestampValue);case 4:return Rw($l(t),$l(e));case 5:return im(t.stringValue,e.stringValue);case 6:return function(i,o){const a=br(i),l=br(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let h=0;h<a.length&&h<l.length;h++){const d=he(a[h],l[h]);if(d!==0)return d}return he(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=he(Oe(i.latitude),Oe(o.latitude));return a!==0?a:he(Oe(i.longitude),Oe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Pw(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,_,k,A;const a=i.fields||{},l=o.fields||{},h=(m=a[Fo])==null?void 0:m.arrayValue,d=(_=l[Fo])==null?void 0:_.arrayValue,p=he(((k=h==null?void 0:h.values)==null?void 0:k.length)||0,((A=d==null?void 0:d.values)==null?void 0:A.length)||0);return p!==0?p:Pw(h,d)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===ss.mapValue&&o===ss.mapValue)return 0;if(i===ss.mapValue)return 1;if(o===ss.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),h=o.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let p=0;p<l.length&&p<d.length;++p){const m=im(l[p],d[p]);if(m!==0)return m;const _=Ts(a[l[p]],h[d[p]]);if(_!==0)return _}return he(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ne(23264,{he:n})}}function Rw(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return he(t,e);const n=Ar(t),r=Ar(e),s=he(n.seconds,r.seconds);return s!==0?s:he(n.nanos,r.nanos)}function Pw(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ts(n[s],r[s]);if(i)return i}return he(n.length,r.length)}function Uo(t){return hm(t)}function hm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ar(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return br(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return X.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=hm(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${hm(n.fields[o])}`;return s+"}"}(t.mapValue):ne(61005,{value:t})}function jc(t){switch(Es(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=md(t);return e?16+jc(e):16;case 5:return 2*t.stringValue.length;case 6:return br(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+jc(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Rs(r.fields,(i,o)=>{s+=i.length+jc(o)}),s}(t.mapValue);default:throw ne(13486,{value:t})}}function ql(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function dm(t){return!!t&&"integerValue"in t}function Wl(t){return!!t&&"arrayValue"in t}function Nw(t){return!!t&&"nullValue"in t}function Dw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Lc(t){return!!t&&"mapValue"in t}function gd(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Qg])==null?void 0:r.stringValue)===Xg}function dl(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Rs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=dl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=dl(t.arrayValue.values[n]);return e}return{...t}}function sS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===rS}const iS={mapValue:{fields:{[Qg]:{stringValue:Xg},[Fo]:{arrayValue:{}}}}};function ID(t){return"nullValue"in t?Dc:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ql(_i.empty(),X.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?gd(t)?iS:{mapValue:{}}:ne(35942,{value:t})}function xD(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ql(_i.empty(),X.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?iS:"mapValue"in t?gd(t)?{mapValue:{}}:ss:ne(61959,{value:t})}function jw(t,e){const n=Ts(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Lw(t,e){const n=Ts(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.value=e}static empty(){return new Dt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Lc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=dl(n)}setAll(e){let n=ze.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=dl(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Lc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ir(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Lc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Rs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Dt(dl(this.value))}}function oS(t){const e=[];return Rs(t.fields,(n,r)=>{const s=new ze([n]);if(Lc(r)){const i=oS(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Jt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ye(e,0,oe.min(),oe.min(),oe.min(),Dt.empty(),0)}static newFoundDocument(e,n,r,s){return new Ye(e,1,n,oe.min(),r,s,0)}static newNoDocument(e,n){return new Ye(e,2,n,oe.min(),oe.min(),Dt.empty(),0)}static newUnknownDocument(e,n){return new Ye(e,3,n,oe.min(),oe.min(),Dt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ye&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ye(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,n){this.position=e,this.inclusive=n}}function Vw(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=X.comparator(X.fromName(o.referenceValue),n.key):r=Ts(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Mw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ir(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,n="asc"){this.field=e,this.dir=n}}function SD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{}class _e extends aS{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new kD(e,n,r):n==="array-contains"?new bD(e,r):n==="in"?new fS(e,r):n==="not-in"?new RD(e,r):n==="array-contains-any"?new PD(e,r):new _e(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new CD(e,r):new AD(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ts(n,this.value)):n!==null&&Es(this.value)===Es(n)&&this.matchesComparison(Ts(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ne(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ce extends aS{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ce(e,n)}matches(e){return zo(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function zo(t){return t.op==="and"}function fm(t){return t.op==="or"}function Yg(t){return lS(t)&&zo(t)}function lS(t){for(const e of t.filters)if(e instanceof Ce)return!1;return!0}function pm(t){if(t instanceof _e)return t.field.canonicalString()+t.op.toString()+Uo(t.value);if(Yg(t))return t.filters.map(e=>pm(e)).join(",");{const e=t.filters.map(n=>pm(n)).join(",");return`${t.op}(${e})`}}function uS(t,e){return t instanceof _e?function(r,s){return s instanceof _e&&r.op===s.op&&r.field.isEqual(s.field)&&ir(r.value,s.value)}(t,e):t instanceof Ce?function(r,s){return s instanceof Ce&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&uS(o,s.filters[a]),!0):!1}(t,e):void ne(19439)}function cS(t,e){const n=t.filters.concat(e);return Ce.create(n,t.op)}function hS(t){return t instanceof _e?function(n){return`${n.field.canonicalString()} ${n.op} ${Uo(n.value)}`}(t):t instanceof Ce?function(n){return n.op.toString()+" {"+n.getFilters().map(hS).join(" ,")+"}"}(t):"Filter"}class kD extends _e{constructor(e,n,r){super(e,n,r),this.key=X.fromName(r.referenceValue)}matches(e){const n=X.comparator(e.key,this.key);return this.matchesComparison(n)}}class CD extends _e{constructor(e,n){super(e,"in",n),this.keys=dS("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class AD extends _e{constructor(e,n){super(e,"not-in",n),this.keys=dS("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function dS(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>X.fromName(r.referenceValue))}class bD extends _e{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Wl(n)&&Hl(n.arrayValue,this.value)}}class fS extends _e{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Hl(this.value.arrayValue,n)}}class RD extends _e{constructor(e,n){super(e,"not-in",n)}matches(e){if(Hl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Hl(this.value.arrayValue,n)}}class PD extends _e{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Wl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Hl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function mm(t,e=null,n=[],r=[],s=null,i=null,o=null){return new ND(t,e,n,r,s,i,o)}function vi(t){const e=de(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>pm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),hd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Uo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Uo(r)).join(",")),e.Te=n}return e.Te}function hu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!SD(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!uS(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Mw(t.startAt,e.startAt)&&Mw(t.endAt,e.endAt)}function xh(t){return X.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Sh(t,e){return t.filters.filter(n=>n instanceof _e&&n.field.isEqual(e))}function Ow(t,e,n){let r=Dc,s=!0;for(const i of Sh(t,e)){let o=Dc,a=!0;switch(i.op){case"<":case"<=":o=ID(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Dc}jw({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];jw({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function Fw(t,e,n){let r=ss,s=!0;for(const i of Sh(t,e)){let o=ss,a=!0;switch(i.op){case">=":case">":o=xD(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=ss}Lw({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];Lw({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function DD(t,e,n,r,s,i,o,a){return new ea(t,e,n,r,s,i,o,a)}function yd(t){return new ea(t)}function Uw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function pS(t){return t.collectionGroup!==null}function fl(t){const e=de(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new be(ze.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(h=>{h.isInequality()&&(a=a.add(h.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Kl(i,r))}),n.has(ze.keyField().canonicalString())||e.Ie.push(new Kl(ze.keyField(),r))}return e.Ie}function In(t){const e=de(t);return e.Ee||(e.Ee=jD(e,fl(t))),e.Ee}function jD(t,e){if(t.limitType==="F")return mm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Kl(s.field,i)});const n=t.endAt?new Bo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Bo(t.startAt.position,t.startAt.inclusive):null;return mm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function gm(t,e){const n=t.filters.concat([e]);return new ea(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function kh(t,e,n){return new ea(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function _d(t,e){return hu(In(t),In(e))&&t.limitType===e.limitType}function mS(t){return`${vi(In(t))}|lt:${t.limitType}`}function Qi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>hS(s)).join(", ")}]`),hd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Uo(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Uo(s)).join(",")),`Target(${r})`}(In(t))}; limitType=${t.limitType})`}function du(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):X.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of fl(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const h=Vw(o,a,l);return o.inclusive?h<=0:h<0}(r.startAt,fl(r),s)||r.endAt&&!function(o,a,l){const h=Vw(o,a,l);return o.inclusive?h>=0:h>0}(r.endAt,fl(r),s))}(t,e)}function LD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function gS(t){return(e,n)=>{let r=!1;for(const s of fl(t)){const i=VD(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function VD(t,e,n){const r=t.field.isKeyField()?X.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),h=a.data.field(i);return l!==null&&h!==null?Ts(l,h):ne(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ne(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Rs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Yx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD=new Ue(X.comparator);function ln(){return MD}const yS=new Ue(X.comparator);function Wa(...t){let e=yS;for(const n of t)e=e.insert(n.key,n);return e}function _S(t){let e=yS;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Qn(){return pl()}function vS(){return pl()}function pl(){return new Dr(t=>t.toString(),(t,e)=>t.isEqual(e))}const OD=new Ue(X.comparator),FD=new be(X.comparator);function pe(...t){let e=FD;for(const n of t)e=e.add(n);return e}const UD=new be(he);function BD(){return UD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fl(e)?"-0":e}}function wS(t){return{integerValue:""+t}}function ES(t,e){return G2(e)?wS(e):Jg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(){this._=void 0}}function zD(t,e,n){return t instanceof Gl?function(s,i){const o={fields:{[eS]:{stringValue:Zx},[nS]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Gg(i)&&(i=md(i)),i&&(o.fields[tS]=i),{mapValue:o}}(n,e):t instanceof $o?IS(t,e):t instanceof Ho?xS(t,e):function(s,i){const o=TS(s,i),a=Bw(o)+Bw(s.Ae);return dm(o)&&dm(s.Ae)?wS(a):Jg(s.serializer,a)}(t,e)}function $D(t,e,n){return t instanceof $o?IS(t,e):t instanceof Ho?xS(t,e):n}function TS(t,e){return t instanceof qo?function(r){return dm(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Gl extends vd{}class $o extends vd{constructor(e){super(),this.elements=e}}function IS(t,e){const n=SS(e);for(const r of t.elements)n.some(s=>ir(s,r))||n.push(r);return{arrayValue:{values:n}}}class Ho extends vd{constructor(e){super(),this.elements=e}}function xS(t,e){let n=SS(e);for(const r of t.elements)n=n.filter(s=>!ir(s,r));return{arrayValue:{values:n}}}class qo extends vd{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Bw(t){return Oe(t.integerValue||t.doubleValue)}function SS(t){return Wl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,n){this.field=e,this.transform=n}}function HD(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof $o&&s instanceof $o||r instanceof Ho&&s instanceof Ho?jo(r.elements,s.elements,ir):r instanceof qo&&s instanceof qo?ir(r.Ae,s.Ae):r instanceof Gl&&s instanceof Gl}(t.transform,e.transform)}class qD{constructor(e,n){this.version=e,this.transformResults=n}}class jt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new jt}static exists(e){return new jt(void 0,e)}static updateTime(e){return new jt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Vc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class wd{}function CS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ed(t.key,jt.none()):new ta(t.key,t.data,jt.none());{const n=t.data,r=Dt.empty();let s=new be(ze.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new jr(t.key,r,new Jt(s.toArray()),jt.none())}}function WD(t,e,n){t instanceof ta?function(s,i,o){const a=s.value.clone(),l=$w(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof jr?function(s,i,o){if(!Vc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=$w(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(AS(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ml(t,e,n,r){return t instanceof ta?function(i,o,a,l){if(!Vc(i.precondition,o))return a;const h=i.value.clone(),d=Hw(i.fieldTransforms,l,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof jr?function(i,o,a,l){if(!Vc(i.precondition,o))return a;const h=Hw(i.fieldTransforms,l,o),d=o.data;return d.setAll(AS(i)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,o,a){return Vc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function KD(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=TS(r.transform,s||null);i!=null&&(n===null&&(n=Dt.empty()),n.set(r.field,i))}return n||null}function zw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&jo(r,s,(i,o)=>HD(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ta extends wd{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class jr extends wd{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function AS(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function $w(t,e,n){const r=new Map;ie(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,$D(o,a,n[s]))}return r}function Hw(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,zD(i,o,e))}return r}class Ed extends wd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bS extends wd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&WD(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ml(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ml(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=vS();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=CS(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(oe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),pe())}isEqual(e){return this.batchId===e.batchId&&jo(this.mutations,e.mutations,(n,r)=>zw(n,r))&&jo(this.baseMutations,e.baseMutations,(n,r)=>zw(n,r))}}class ey{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ie(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return OD}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new ey(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nt,ve;function QD(t){switch(t){case U.OK:return ne(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return ne(15467,{code:t})}}function RS(t){if(t===void 0)return Bt("GRPC error has no .code"),U.UNKNOWN;switch(t){case nt.OK:return U.OK;case nt.CANCELLED:return U.CANCELLED;case nt.UNKNOWN:return U.UNKNOWN;case nt.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case nt.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case nt.INTERNAL:return U.INTERNAL;case nt.UNAVAILABLE:return U.UNAVAILABLE;case nt.UNAUTHENTICATED:return U.UNAUTHENTICATED;case nt.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case nt.NOT_FOUND:return U.NOT_FOUND;case nt.ALREADY_EXISTS:return U.ALREADY_EXISTS;case nt.PERMISSION_DENIED:return U.PERMISSION_DENIED;case nt.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case nt.ABORTED:return U.ABORTED;case nt.OUT_OF_RANGE:return U.OUT_OF_RANGE;case nt.UNIMPLEMENTED:return U.UNIMPLEMENTED;case nt.DATA_LOSS:return U.DATA_LOSS;default:return ne(39323,{code:t})}}(ve=nt||(nt={}))[ve.OK=0]="OK",ve[ve.CANCELLED=1]="CANCELLED",ve[ve.UNKNOWN=2]="UNKNOWN",ve[ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ve[ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ve[ve.NOT_FOUND=5]="NOT_FOUND",ve[ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",ve[ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",ve[ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",ve[ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ve[ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ve[ve.ABORTED=10]="ABORTED",ve[ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",ve[ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",ve[ve.INTERNAL=13]="INTERNAL",ve[ve.UNAVAILABLE=14]="UNAVAILABLE",ve[ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD=new ms([4294967295,4294967295],0);function qw(t){const e=XD().encode(t),n=new kx;return n.update(e),new Uint8Array(n.digest())}function Ww(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ms([n,r],0),new ms([s,i],0)]}class ny{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ka(`Invalid padding: ${n}`);if(r<0)throw new Ka(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ka(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ka(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ms.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(ms.fromNumber(r)));return s.compare(YD)===1&&(s=new ms([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=qw(e),[r,s]=Ww(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new ny(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=qw(e),[r,s]=Ww(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ka extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,fu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Td(oe.min(),s,new Ue(he),ln(),pe())}}class fu{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new fu(r,n,pe(),pe(),pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class PS{constructor(e,n){this.targetId=e,this.Ce=n}}class NS{constructor(e,n,r=it.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Kw{constructor(){this.ve=0,this.Fe=Gw(),this.Me=it.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=pe(),n=pe(),r=pe();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ne(38017,{changeType:i})}}),new fu(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=Gw()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ie(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class JD{constructor(e){this.Ge=e,this.ze=new Map,this.je=ln(),this.Je=sc(),this.He=sc(),this.Ye=new Ue(he)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ne(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(xh(i))if(r===0){const o=new X(i.path);this.et(n,o,Ye.newNoDocument(o,oe.min()))}else ie(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,h)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=br(r).toUint8Array()}catch(l){if(l instanceof Jx)return yi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new ny(o,s,i)}catch(l){return yi(l instanceof Ka?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&xh(a.target)){const l=new X(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Ye.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=pe();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Td(e,n,this.Ye,this.je,r);return this.je=ln(),this.Je=sc(),this.He=sc(),this.Ye=new Ue(he),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Kw,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new be(he),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new be(he),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||z("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Kw),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function sc(){return new Ue(X.comparator)}function Gw(){return new Ue(X.comparator)}const ZD={asc:"ASCENDING",desc:"DESCENDING"},ej={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},tj={and:"AND",or:"OR"};class nj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ym(t,e){return t.useProto3Json||hd(e)?e:{value:e}}function Wo(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function DS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function rj(t,e){return Wo(t,e.toTimestamp())}function Ht(t){return ie(!!t,49232),oe.fromTimestamp(function(n){const r=Ar(n);return new ke(r.seconds,r.nanos)}(t))}function ry(t,e){return _m(t,e).canonicalString()}function _m(t,e){const n=function(s){return new Ie(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function jS(t){const e=Ie.fromString(t);return ie($S(e),10190,{key:e.toString()}),e}function Ch(t,e){return ry(t.databaseId,e.path)}function oi(t,e){const n=jS(e);if(n.get(1)!==t.databaseId.projectId)throw new W(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new W(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new X(MS(n))}function LS(t,e){return ry(t.databaseId,e)}function VS(t){const e=jS(t);return e.length===4?Ie.emptyPath():MS(e)}function vm(t){return new Ie(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function MS(t){return ie(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Qw(t,e,n){return{name:Ch(t,e),fields:n.value.mapValue.fields}}function sj(t,e,n){const r=oi(t,e.name),s=Ht(e.updateTime),i=e.createTime?Ht(e.createTime):oe.min(),o=new Dt({mapValue:{fields:e.fields}}),a=Ye.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function ij(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ne(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,d){return h.useProto3Json?(ie(d===void 0||typeof d=="string",58123),it.fromBase64String(d||"")):(ie(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),it.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(h){const d=h.code===void 0?U.UNKNOWN:RS(h.code);return new W(d,h.message||"")}(o);n=new NS(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=oi(t,r.document.name),i=Ht(r.document.updateTime),o=r.document.createTime?Ht(r.document.createTime):oe.min(),a=new Dt({mapValue:{fields:r.document.fields}}),l=Ye.newFoundDocument(s,i,o,a),h=r.targetIds||[],d=r.removedTargetIds||[];n=new Mc(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=oi(t,r.document),i=r.readTime?Ht(r.readTime):oe.min(),o=Ye.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Mc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=oi(t,r.document),i=r.removedTargetIds||[];n=new Mc([],i,s,null)}else{if(!("filter"in e))return ne(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new GD(s,i),a=r.targetId;n=new PS(a,o)}}return n}function Ah(t,e){let n;if(e instanceof ta)n={update:Qw(t,e.key,e.value)};else if(e instanceof Ed)n={delete:Ch(t,e.key)};else if(e instanceof jr)n={update:Qw(t,e.key,e.data),updateMask:hj(e.fieldMask)};else{if(!(e instanceof bS))return ne(16599,{Vt:e.type});n={verify:Ch(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Gl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof $o)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ho)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof qo)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw ne(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:rj(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ne(27497)}(t,e.precondition)),n}function wm(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?jt.updateTime(Ht(i.updateTime)):i.exists!==void 0?jt.exists(i.exists):jt.none()}(e.currentDocument):jt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)ie(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new Gl;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new $o(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new Ho(d)}else"increment"in a?l=new qo(o,a.increment):ne(16584,{proto:a});const h=ze.fromServerFormat(a.fieldPath);return new kS(h,l)}(t,s)):[];if(e.update){e.update.name;const s=oi(t,e.update.name),i=new Dt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const h=l.fieldPaths||[];return new Jt(h.map(d=>ze.fromServerFormat(d)))}(e.updateMask);return new jr(s,i,o,n,r)}return new ta(s,i,n,r)}if(e.delete){const s=oi(t,e.delete);return new Ed(s,n)}if(e.verify){const s=oi(t,e.verify);return new bS(s,n)}return ne(1463,{proto:e})}function oj(t,e){return t&&t.length>0?(ie(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Ht(s.updateTime):Ht(i);return o.isEqual(oe.min())&&(o=Ht(i)),new qD(o,s.transformResults||[])}(n,e))):[]}function OS(t,e){return{documents:[LS(t,e.path)]}}function FS(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=LS(t,s);const i=function(h){if(h.length!==0)return zS(Ce.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(h){if(h.length!==0)return h.map(d=>function(m){return{field:Xi(m.field),direction:lj(m.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=ym(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:n,parent:s}}function US(t){let e=VS(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ie(r===1,65062);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(p){const m=BS(p);return m instanceof Ce&&Yg(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(k){return new Kl(Yi(k.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,hd(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(p){const m=!!p.before,_=p.values||[];return new Bo(_,m)}(n.startAt));let h=null;return n.endAt&&(h=function(p){const m=!p.before,_=p.values||[];return new Bo(_,m)}(n.endAt)),DD(e,s,o,i,a,"F",l,h)}function aj(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ne(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function BS(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Yi(n.unaryFilter.field);return _e.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Yi(n.unaryFilter.field);return _e.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Yi(n.unaryFilter.field);return _e.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Yi(n.unaryFilter.field);return _e.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ne(61313);default:return ne(60726)}}(t):t.fieldFilter!==void 0?function(n){return _e.create(Yi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ne(58110);default:return ne(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ce.create(n.compositeFilter.filters.map(r=>BS(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ne(1026)}}(n.compositeFilter.op))}(t):ne(30097,{filter:t})}function lj(t){return ZD[t]}function uj(t){return ej[t]}function cj(t){return tj[t]}function Xi(t){return{fieldPath:t.canonicalString()}}function Yi(t){return ze.fromServerFormat(t.fieldPath)}function zS(t){return t instanceof _e?function(n){if(n.op==="=="){if(Dw(n.value))return{unaryFilter:{field:Xi(n.field),op:"IS_NAN"}};if(Nw(n.value))return{unaryFilter:{field:Xi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Dw(n.value))return{unaryFilter:{field:Xi(n.field),op:"IS_NOT_NAN"}};if(Nw(n.value))return{unaryFilter:{field:Xi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xi(n.field),op:uj(n.op),value:n.value}}}(t):t instanceof Ce?function(n){const r=n.getFilters().map(s=>zS(s));return r.length===1?r[0]:{compositeFilter:{op:cj(n.op),filters:r}}}(t):ne(54877,{filter:t})}function hj(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function $S(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e,n,r,s,i=oe.min(),o=oe.min(),a=it.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new mr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new mr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new mr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new mr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e){this.yt=e}}function dj(t,e){let n;if(e.document)n=sj(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=X.fromSegments(e.noDocument.path),s=Ei(e.noDocument.readTime);n=Ye.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return ne(56709);{const r=X.fromSegments(e.unknownDocument.path),s=Ei(e.unknownDocument.version);n=Ye.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new ke(s[0],s[1]);return oe.fromTimestamp(i)}(e.readTime)),n}function Xw(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:bh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Ch(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Wo(i,o.version.toTimestamp()),createTime:Wo(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:wi(e.version)};else{if(!e.isUnknownDocument())return ne(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:wi(e.version)}}return r}function bh(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function wi(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ei(t){const e=new ke(t.seconds,t.nanoseconds);return oe.fromTimestamp(e)}function Ws(t,e){const n=(e.baseMutations||[]).map(i=>wm(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>wm(t.yt,i)),s=ke.fromMillis(e.localWriteTimeMs);return new Zg(e.batchId,s,n,r)}function Ga(t){const e=Ei(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ei(t.lastLimboFreeSnapshotVersion):oe.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return ie(o===1,1966,{count:o}),In(yd(VS(i.documents[0])))}(t.query):function(i){return In(US(i))}(t.query),new mr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,it.fromBase64String(t.resumeToken))}function qS(t,e){const n=wi(e.snapshotVersion),r=wi(e.lastLimboFreeSnapshotVersion);let s;s=xh(e.target)?OS(t.yt,e.target):FS(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:vi(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function WS(t){const e=US({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?kh(e,e.limit,"L"):e}function Ff(t,e){return new ty(e.largestBatchId,wm(t.yt,e.overlayMutation))}function Yw(t,e){const n=e.path.lastSegment();return[t,Lt(e.path.popLast()),n]}function Jw(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:wi(r.readTime),documentKey:Lt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{getBundleMetadata(e,n){return Zw(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Ei(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return Zw(e).put(function(s){return{bundleId:s.id,createTime:wi(Ht(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return e0(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:WS(i.bundledQuery),readTime:Ei(i.readTime)}}(r)})}saveNamedQuery(e,n){return e0(e).put(function(s){return{name:s.name,readTime:wi(Ht(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function Zw(t){return ft(t,dd)}function e0(t){return ft(t,fd)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Id(e,r)}getOverlay(e,n){return Da(e).get(Yw(this.userId,n)).next(r=>r?Ff(this.serializer,r):null)}getOverlays(e,n){const r=Qn();return V.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new ty(n,o);s.push(this.St(e,a))}),V.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Lt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Da(e).Z(um,a))}),V.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Qn(),i=Lt(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Da(e).J(um,o).next(a=>{for(const l of a){const h=Ff(this.serializer,l);s.set(h.getKey(),h)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Qn();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Da(e).ee({index:Wx,range:a},(l,h,d)=>{const p=Ff(this.serializer,h);i.size()<s||p.largestBatchId===o?(i.set(p.getKey(),p),o=p.largestBatchId):d.done()}).next(()=>i)}St(e,n){return Da(e).put(function(s,i,o){const[a,l,h]=Yw(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ah(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Da(t){return ft(t,pd)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pj{bt(e){return ft(e,Wg)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?it.fromUint8Array(r):it.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(Oe(e.integerValue));else if("doubleValue"in e){const r=Oe(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Fl(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Ar(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(br(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?sS(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):gd(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):ne(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=Fo,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(Oe(i)),this.Ot(s,n),this.Ct(r[s],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),X.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Ks.Kt=new Ks;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $i=255;function mj(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function t0(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=mj(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class gj{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const n=this.en(e),r=t0(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=t0(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn($i),this.sn(255)}_n(){this.an($i),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===$i?(this.sn($i),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===$i?(this.an($i),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class yj{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class _j{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class ja{constructor(){this.cn=new gj,this.ln=new yj(this.cn),this.hn=new _j(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,n,r,s){this.Tn=e,this.In=n,this.En=r,this.dn=s}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Gs(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Oc(this.En),directionalValue:Oc(this.dn),orderedDocumentKey:Oc(n),documentKey:r.path.toArray()}}Vn(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function $r(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=n0(t.En,e.En),n!==0?n:(n=n0(t.dn,e.dn),n!==0?n:X.comparator(t.In,e.In)))}function n0(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Oc(t){return vx()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function r0(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class s0{constructor(e){this.mn=new be((n,r)=>ze.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(ie(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=om(e);if(n!==void 0&&!this.wn(n))return!1;const r=$s(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.wn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new be(ze.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Rc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Rc(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Rc(r.field,r.dir==="asc"?0:1)));return new vh(vh.UNKNOWN_ID,this.collectionId,n,Ol.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(t){var n,r;if(ie(t instanceof _e||t instanceof Ce,20012),t instanceof _e){if(t instanceof fS){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>_e.create(t.field,"==",i)))||[];return Ce.create(s,"or")}return t}const e=t.filters.map(s=>KS(s));return Ce.create(e,t.op)}function vj(t){if(t.getFilters().length===0)return[];const e=Im(KS(t));return ie(GS(e),7391),Em(e)||Tm(e)?[e]:e.getFilters()}function Em(t){return t instanceof _e}function Tm(t){return t instanceof Ce&&Yg(t)}function GS(t){return Em(t)||Tm(t)||function(n){if(n instanceof Ce&&fm(n)){for(const r of n.getFilters())if(!Em(r)&&!Tm(r))return!1;return!0}return!1}(t)}function Im(t){if(ie(t instanceof _e||t instanceof Ce,34018),t instanceof _e)return t;if(t.filters.length===1)return Im(t.filters[0]);const e=t.filters.map(r=>Im(r));let n=Ce.create(e,t.op);return n=Rh(n),GS(n)?n:(ie(n instanceof Ce,64498),ie(zo(n),40251),ie(n.filters.length>1,57927),n.filters.reduce((r,s)=>sy(r,s)))}function sy(t,e){let n;return ie(t instanceof _e||t instanceof Ce,38388),ie(e instanceof _e||e instanceof Ce,25473),n=t instanceof _e?e instanceof _e?function(s,i){return Ce.create([s,i],"and")}(t,e):i0(t,e):e instanceof _e?i0(e,t):function(s,i){if(ie(s.filters.length>0&&i.filters.length>0,48005),zo(s)&&zo(i))return cS(s,i.getFilters());const o=fm(s)?s:i,a=fm(s)?i:s,l=o.filters.map(h=>sy(h,a));return Ce.create(l,"or")}(t,e),Rh(n)}function i0(t,e){if(zo(e))return cS(e,t.getFilters());{const n=e.filters.map(r=>sy(t,r));return Ce.create(n,"or")}}function Rh(t){if(ie(t instanceof _e||t instanceof Ce,11850),t instanceof _e)return t;const e=t.getFilters();if(e.length===1)return Rh(e[0]);if(lS(t))return t;const n=e.map(s=>Rh(s)),r=[];return n.forEach(s=>{s instanceof _e?r.push(s):s instanceof Ce&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Ce.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(){this.Cn=new iy}addToCollectionParentIndex(e,n){return this.Cn.add(n),V.resolve()}getCollectionParents(e,n){return V.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return V.resolve()}deleteFieldIndex(e,n){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,n){return V.resolve()}getDocumentsMatchingTarget(e,n){return V.resolve(null)}getIndexType(e,n){return V.resolve(0)}getFieldIndexes(e,n){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,n){return V.resolve(dn.min())}getMinOffsetFromCollectionGroup(e,n){return V.resolve(dn.min())}updateCollectionGroup(e,n,r){return V.resolve()}updateIndexEntries(e,n){return V.resolve()}}class iy{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new be(Ie.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new be(Ie.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0="IndexedDbIndexManager",ic=new Uint8Array(0);class Ej{constructor(e,n){this.databaseId=n,this.vn=new iy,this.Fn=new Dr(r=>vi(r),(r,s)=>hu(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const i={collectionId:r,parent:Lt(s)};return a0(e).put(i)}return V.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[jx(n),""],!1,!0);return a0(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Gn(o.parent))}return r})}addFieldIndex(e,n){const r=La(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=qi(e);return i.next(a=>{o.put(Jw(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=La(e),s=qi(e),i=Hi(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=La(e),r=Hi(e),s=qi(e);return n.Z().next(()=>r.Z()).next(()=>s.Z())}createTargetIndexes(e,n){return V.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new s0(r).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Hi(e);let s=!0;const i=new Map;return V.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=pe();const a=[];return V.forEach(i,(l,h)=>{z(o0,`Using index ${function(E){return`id=${E.indexId}|cg=${E.collectionGroup}|f=${E.fields.map(N=>`${N.fieldPath}:${N.kind}`).join(",")}`}(l)} to execute ${vi(n)}`);const d=function(E,N){const j=om(N);if(j===void 0)return null;for(const F of Sh(E,j.fieldPath))switch(F.op){case"array-contains-any":return F.value.arrayValue.values||[];case"array-contains":return[F.value]}return null}(h,l),p=function(E,N){const j=new Map;for(const F of $s(N))for(const S of Sh(E,F.fieldPath))switch(S.op){case"==":case"in":j.set(F.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return j.set(F.fieldPath.canonicalString(),S.value),Array.from(j.values())}return null}(h,l),m=function(E,N){const j=[];let F=!0;for(const S of $s(N)){const y=S.kind===0?Ow(E,S.fieldPath,E.startAt):Fw(E,S.fieldPath,E.startAt);j.push(y.value),F&&(F=y.inclusive)}return new Bo(j,F)}(h,l),_=function(E,N){const j=[];let F=!0;for(const S of $s(N)){const y=S.kind===0?Fw(E,S.fieldPath,E.endAt):Ow(E,S.fieldPath,E.endAt);j.push(y.value),F&&(F=y.inclusive)}return new Bo(j,F)}(h,l),k=this.On(l,h,m),A=this.On(l,h,_),b=this.Nn(l,h,p),T=this.Bn(l.indexId,d,k,m.inclusive,A,_.inclusive,b);return V.forEach(T,w=>r.Y(w,n.limit).next(E=>{E.forEach(N=>{const j=X.fromSegments(N.documentKey);o.has(j)||(o=o.add(j),a.push(j))})}))}).next(()=>a)}return V.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=vj(Ce.create(e.filters,"and")).map(r=>mm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,s,i,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,i.length),h=l/(n!=null?n.length:1),d=[];for(let p=0;p<l;++p){const m=n?this.Ln(n[p/h]):ic,_=this.kn(e,m,r[p%h],s),k=this.qn(e,m,i[p%h],o),A=a.map(b=>this.kn(e,m,b,!0));d.push(...this.createRange(_,k,A))}return d}kn(e,n,r,s){const i=new Gs(e,X.empty(),n,r);return s?i:i.An()}qn(e,n,r,s){const i=new Gs(e,X.empty(),n,r);return s?i.An():i}xn(e,n){const r=new s0(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.Mn(n);return V.forEach(s,i=>this.xn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let h=new be(ze.comparator),d=!1;for(const p of l.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:h=h.add(m.field));for(const p of l.orderBy)p.field.isKeyField()||(h=h.add(p.field));return h.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Qn(e,n){const r=new ja;for(const s of $s(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Pn(s.kind);Ks.Kt.Dt(i,o)}return r.un()}Ln(e){const n=new ja;return Ks.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new ja;return Ks.Kt.Dt(ql(this.databaseId,n),r.Pn(function(i){const o=$s(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let s=[];s.push(new ja);let i=0;for(const o of $s(e)){const a=r[i++];for(const l of s)if(this.Un(n,o.fieldPath)&&Wl(a))s=this.Kn(s,o,a);else{const h=l.Pn(o.kind);Ks.Kt.Dt(a,h)}}return this.Wn(s)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new ja;l.seed(a.un()),Ks.Kt.Dt(o,l.Pn(n.kind)),i.push(l)}return i}Un(e,n){return!!e.filters.find(r=>r instanceof _e&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=La(e),s=qi(e);return(n?r.J(lm,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return V.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(d,p){const m=p?new Ol(p.sequenceNumber,new dn(Ei(p.readTime),new X(Gn(p.documentKey)),p.largestBatchId)):Ol.empty(),_=d.fields.map(([k,A])=>new Rc(ze.fromServerFormat(k),A));return new vh(d.indexId,d.collectionGroup,_,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:he(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=La(e),i=qi(e);return this.Gn(e).next(o=>s.J(lm,IDBKeyRange.bound(n,n)).next(a=>V.forEach(a,l=>i.put(Jw(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return V.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?V.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),V.forEach(a,l=>this.zn(e,s,l).next(h=>{const d=this.jn(i,l);return h.isEqual(d)?V.resolve():this.Jn(e,i,l,h,d)}))))})}Hn(e,n,r,s){return Hi(e).put(s.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,s){return Hi(e).delete(s.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const s=Hi(e);let i=new be($r);return s.ee({index:qx,range:IDBKeyRange.only([r.indexId,this.uid,Oc(this.$n(r,n))])},(o,a)=>{i=i.add(new Gs(r.indexId,n,r0(a.arrayValue),r0(a.directionalValue)))}).next(()=>i)}jn(e,n){let r=new be($r);const s=this.Qn(n,e);if(s==null)return r;const i=om(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Wl(o))for(const a of o.arrayValue.values||[])r=r.add(new Gs(n.indexId,e.key,this.Ln(a),s))}else r=r.add(new Gs(n.indexId,e.key,ic,s));return r}Jn(e,n,r,s,i){z(o0,"Updating index entries for document '%s'",n.key);const o=[];return function(l,h,d,p,m){const _=l.getIterator(),k=h.getIterator();let A=zi(_),b=zi(k);for(;A||b;){let T=!1,w=!1;if(A&&b){const E=d(A,b);E<0?w=!0:E>0&&(T=!0)}else A!=null?w=!0:T=!0;T?(p(b),b=zi(k)):w?(m(A),A=zi(_)):(A=zi(_),b=zi(k))}}(s,i,$r,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),V.waitFor(o)}Gn(e){let n=1;return qi(e).ee({index:Hx,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>$r(o,a)).filter((o,a,l)=>!a||$r(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=$r(o,e),l=$r(o,n);if(a===0)s[0]=e.An();else if(a>0&&l<0)s.push(o),s.push(o.An());else if(l>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Zn(s[o],s[o+1]))return[];const a=s[o].Vn(this.uid,ic,X.empty()),l=s[o+1].Vn(this.uid,ic,X.empty());i.push(IDBKeyRange.bound(a,l))}return i}Zn(e,n){return $r(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(l0)}getMinOffset(e,n){return V.mapArray(this.Mn(n),r=>this.xn(e,r).next(s=>s||ne(44426))).next(l0)}}function a0(t){return ft(t,zl)}function Hi(t){return ft(t,hl)}function La(t){return ft(t,qg)}function qi(t){return ft(t,cl)}function l0(t){ie(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;zg(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new dn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},QS=41943040;class Pt{static withCacheSize(e){return new Pt(e,Pt.DEFAULT_COLLECTION_PERCENTILE,Pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(t,e,n){const r=t.store(Dn),s=t.store(Lo),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(d,p,m)=>(a++,m.delete()));i.push(l.next(()=>{ie(a===1,47070,{batchId:n.batchId})}));const h=[];for(const d of n.mutations){const p=Bx(e,d.key.path,n.batchId);i.push(s.delete(p)),h.push(d.key)}return V.waitFor(i).next(()=>h)}function Ph(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ne(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pt.DEFAULT_COLLECTION_PERCENTILE=10,Pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pt.DEFAULT=new Pt(QS,Pt.DEFAULT_COLLECTION_PERCENTILE,Pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pt.DISABLED=new Pt(-1,0,0);class xd{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Xn={}}static wt(e,n,r,s){ie(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new xd(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Hr(e).ee({index:ei,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Ji(e),o=Hr(e);return o.add({}).next(a=>{ie(typeof a=="number",49019);const l=new Zg(a,n,r,s),h=function(_,k,A){const b=A.baseMutations.map(w=>Ah(_.yt,w)),T=A.mutations.map(w=>Ah(_.yt,w));return{userId:k,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:b,mutations:T}}(this.serializer,this.userId,l),d=[];let p=new be((m,_)=>he(m.canonicalString(),_.canonicalString()));for(const m of s){const _=Bx(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),d.push(o.put(h)),d.push(i.put(_,Y2))}return p.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),V.waitFor(d).next(()=>l)})}lookupMutationBatch(e,n){return Hr(e).get(n).next(r=>r?(ie(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Ws(this.serializer,r)):null)}er(e,n){return this.Xn[n]?V.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Xn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Hr(e).ee({index:ei,range:s},(o,a,l)=>{a.userId===this.userId&&(ie(a.batchId>=r,47524,{tr:r}),i=Ws(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=si;return Hr(e).ee({index:ei,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,si],[this.userId,Number.POSITIVE_INFINITY]);return Hr(e).J(ei,n).next(r=>r.map(s=>Ws(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Pc(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Ji(e).ee({range:s},(o,a,l)=>{const[h,d,p]=o,m=Gn(d);if(h===this.userId&&n.path.isEqual(m))return Hr(e).get(p).next(_=>{if(!_)throw ne(61480,{nr:o,batchId:p});ie(_.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:_.userId,batchId:p}),i.push(Ws(this.serializer,_))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new be(he);const s=[];return n.forEach(i=>{const o=Pc(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=Ji(e).ee({range:a},(h,d,p)=>{const[m,_,k]=h,A=Gn(_);m===this.userId&&i.path.isEqual(A)?r=r.add(k):p.done()});s.push(l)}),V.waitFor(s).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Pc(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new be(he);return Ji(e).ee({range:o},(l,h,d)=>{const[p,m,_]=l,k=Gn(m);p===this.userId&&r.isPrefixOf(k)?k.length===s&&(a=a.add(_)):d.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Hr(e).get(i).next(o=>{if(o===null)throw ne(35274,{batchId:i});ie(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(Ws(this.serializer,o))}))}),V.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return XS(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),V.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return V.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Ji(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=Gn(i[1]);s.push(l)}else a.done()}).next(()=>{ie(s.length===0,56720,{sr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return YS(e,this.userId,n)}_r(e){return JS(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:si,lastStreamToken:""})}}function YS(t,e,n){const r=Pc(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Ji(t).ee({range:i,X:!0},(a,l,h)=>{const[d,p,m]=a;d===e&&p===s&&(o=!0),h.done()}).next(()=>o)}function Hr(t){return ft(t,Dn)}function Ji(t){return ft(t,Lo)}function JS(t){return ft(t,Ul)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ti(0)}static cr(){return new Ti(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new Ti(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>oe.fromTimestamp(new ke(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.hr(e,s)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Wi(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(ie(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Wi(e).ee((o,a)=>{const l=Ga(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>V.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Wi(e).ee((r,s)=>{const i=Ga(s);n(i)})}lr(e){return c0(e).get(Th).next(n=>(ie(n!==null,2888),n))}hr(e,n){return c0(e).put(Th,n)}Pr(e,n){return Wi(e).put(qS(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=vi(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Wi(e).ee({range:s,index:$x},(o,a,l)=>{const h=Ga(a);hu(n,h.target)&&(i=h,l.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Jr(e);return n.forEach(o=>{const a=Lt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),V.waitFor(s)}removeMatchingKeys(e,n,r){const s=Jr(e);return V.forEach(n,i=>{const o=Lt(i.path);return V.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Jr(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Jr(e);let i=pe();return s.ee({range:r,X:!0},(o,a,l)=>{const h=Gn(o[1]),d=new X(h);i=i.add(d)}).next(()=>i)}containsKey(e,n){const r=Lt(n.path),s=IDBKeyRange.bound([r],[jx(r)],!1,!0);let i=0;return Jr(e).ee({index:Hg,X:!0,range:s},([o,a],l,h)=>{o!==0&&(i++,h.done())}).next(()=>i>0)}At(e,n){return Wi(e).get(n).next(r=>r?Ga(r):null)}}function Wi(t){return ft(t,Vo)}function c0(t){return ft(t,ii)}function Jr(t){return ft(t,Mo)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h0="LruGarbageCollector",Ij=1048576;function d0([t,e],[n,r]){const s=he(t,n);return s===0?he(e,r):s}class xj{constructor(e){this.Ir=e,this.buffer=new be(d0),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();d0(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ZS{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){z(h0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){bs(n)?z(h0,"Ignoring IndexedDB error during garbage collection: ",n):await Pi(n)}await this.Vr(3e5)})}}class Sj{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return V.resolve(En.ce);const r=new xj(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(z("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(u0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),u0):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,o=Date.now(),this.nthSequenceNumber(e,s))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,n))).next(p=>(i=p,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(h=Date.now(),Gi()<=ye.DEBUG&&z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${p} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:p})))}}function e1(t,e){return new Sj(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(e,n){this.db=e,this.garbageCollector=e1(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,s)=>n(s))}addReference(e,n,r){return oc(e,r)}removeReference(e,n,r){return oc(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return oc(e,n)}br(e,n){return function(s,i){let o=!1;return JS(s).te(a=>YS(s,a,i).next(l=>(l&&(o=!0),V.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(h=>{if(!h)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,oe.min()),Jr(e).delete(function(p){return[0,Lt(p.path)]}(o))))});s.push(l)}}).next(()=>V.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return oc(e,n)}Sr(e,n){const r=Jr(e);let s,i=En.ce;return r.ee({index:Hg},([o,a],{path:l,sequenceNumber:h})=>{o===0?(i!==En.ce&&n(new X(Gn(s)),i),i=h,s=l):i=En.ce}).next(()=>{i!==En.ce&&n(new X(Gn(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function oc(t,e){return Jr(t).put(function(r,s){return{targetId:0,path:Lt(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(){this.changes=new Dr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ye.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?V.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Fs(e).put(r)}removeEntry(e,n,r){return Fs(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],bh(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=Ye.newInvalidDocument(n);return Fs(e).ee({index:Nc,range:IDBKeyRange.only(Va(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}vr(e,n){let r={size:0,document:Ye.newInvalidDocument(n)};return Fs(e).ee({index:Nc,range:IDBKeyRange.only(Va(n))},(s,i)=>{r={document:this.Cr(n,i),size:Ph(i)}}).next(()=>r)}getEntries(e,n){let r=ln();return this.Fr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Mr(e,n){let r=ln(),s=new Ue(X.comparator);return this.Fr(e,n,(i,o)=>{const a=this.Cr(i,o);r=r.insert(i,a),s=s.insert(i,Ph(o))}).next(()=>({documents:r,Or:s}))}Fr(e,n,r){if(n.isEmpty())return V.resolve();let s=new be(m0);n.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(Va(s.first()),Va(s.last())),o=s.getIterator();let a=o.getNext();return Fs(e).ee({index:Nc,range:i},(l,h,d)=>{const p=X.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;a&&m0(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,h),a=o.hasNext()?o.getNext():null),a?d.j(Va(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),bh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fs(e).J(IDBKeyRange.bound(a,l,!0)).next(h=>{i==null||i.incrementDocumentReadCount(h.length);let d=ln();for(const p of h){const m=this.Cr(X.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(du(n,m)||s.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,n,r,s){let i=ln();const o=p0(n,r),a=p0(n,dn.max());return Fs(e).ee({index:zx,range:IDBKeyRange.bound(o,a,!0)},(l,h,d)=>{const p=this.Cr(X.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);i=i.insert(p.key,p),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new Aj(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return f0(e).get(am).next(n=>(ie(!!n,20021),n))}Dr(e,n){return f0(e).put(am,n)}Cr(e,n){if(n){const r=dj(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(oe.min())))return r}return Ye.newInvalidDocument(e)}}function n1(t){return new Cj(t)}class Aj extends t1{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new Dr(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new be((i,o)=>he(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Br.get(i);if(n.push(this.Nr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=Xw(this.Nr.serializer,o);s=s.add(i.path.popLast());const h=Ph(l);r+=h-a.size,n.push(this.Nr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=Xw(this.Nr.serializer,o.convertToNoDocument(oe.min()));n.push(this.Nr.addEntry(e,i,l))}}),s.forEach(i=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Nr.updateMetadata(e,r)),V.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:s})=>(s.forEach((i,o)=>{this.Br.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function f0(t){return ft(t,Bl)}function Fs(t){return ft(t,Eh)}function Va(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function p0(t,e){const n=e.documentKey.path.toArray();return[t,bh(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function m0(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=he(n[i],r[i]),s)return s;return s=he(n.length,r.length),s||(s=he(n[n.length-2],r[r.length-2]),s||he(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ml(r.mutation,s,Jt.empty(),ke.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=pe()){const s=Qn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Wa();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Qn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,pe()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=ln();const o=pl(),a=function(){return pl()}();return n.forEach((l,h)=>{const d=r.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof jr)?i=i.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),ml(d.mutation,h,d.mutation.getFieldMask(),ke.now())):o.set(h.key,Jt.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((h,d)=>o.set(h,d)),n.forEach((h,d)=>a.set(h,new bj(d,o.get(h)??null))),a))}recalculateAndSaveOverlays(e,n){const r=pl();let s=new Ue((o,a)=>o-a),i=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const h=n.get(l);if(h===null)return;let d=r.get(l)||Jt.empty();d=a.applyToLocalView(h,d),r.set(l,d);const p=(s.get(a.batchId)||pe()).add(l);s=s.insert(a.batchId,p)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),h=l.key,d=l.value,p=vS();d.forEach(m=>{if(!i.has(m)){const _=CS(n.get(m),r.get(m));_!==null&&p.set(m,_),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return X.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):pS(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):V.resolve(Qn());let a=Ml,l=i;return o.next(h=>V.forEach(h,(d,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),i.get(d)?V.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{l=l.insert(d,m)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,l,h,pe())).next(d=>({batchId:a,changes:_S(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new X(n)).next(r=>{let s=Wa();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Wa();return this.indexManager.getCollectionParents(e,i).next(a=>V.forEach(a,l=>{const h=function(p,m){return new ea(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(d=>{d.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,Ye.newInvalidDocument(d)))});let a=Wa();return o.forEach((l,h)=>{const d=i.get(l);d!==void 0&&ml(d.mutation,h,Jt.empty(),ke.now()),du(n,h)&&(a=a.insert(l,h))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return V.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Ht(s.createTime)}}(n)),V.resolve()}getNamedQuery(e,n){return V.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:WS(s.bundledQuery),readTime:Ht(s.readTime)}}(n)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pj{constructor(){this.overlays=new Ue(X.comparator),this.qr=new Map}getOverlay(e,n){return V.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Qn();return V.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),V.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),V.resolve()}getOverlaysForCollection(e,n,r){const s=Qn(),i=n.length+1,o=new X(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,h=l.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return V.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ue((h,d)=>h-d);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let d=i.get(h.largestBatchId);d===null&&(d=Qn(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const a=Qn(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((h,d)=>a.set(h,d)),!(a.size()>=s)););return V.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new ty(n,r));let i=this.qr.get(n);i===void 0&&(i=pe(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{constructor(){this.sessionToken=it.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,V.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(){this.Qr=new be(_t.$r),this.Ur=new be(_t.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new _t(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new _t(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new X(new Ie([])),r=new _t(n,e),s=new _t(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new X(new Ie([])),r=new _t(n,e),s=new _t(n,e+1);let i=pe();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new _t(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class _t{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return X.comparator(e.key,n.key)||he(e.Yr,n.Yr)}static Kr(e,n){return he(e.Yr,n.Yr)||X.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new be(_t.$r)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Zg(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new _t(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,n){return V.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return V.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?si:this.tr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new _t(n,0),s=new _t(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),V.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new be(he);return n.forEach(s=>{const i=new _t(s,0),o=new _t(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),V.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;X.isDocumentKey(i)||(i=i.child(""));const o=new _t(new X(i),0);let a=new be(he);return this.Zr.forEachWhile(l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(a=a.add(l.Yr)),!0)},o),V.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ie(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return V.forEach(n.mutations,s=>{const i=new _t(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new _t(n,0),s=this.Zr.firstAfterOrEqual(r);return V.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jj{constructor(e){this.ri=e,this.docs=function(){return new Ue(X.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return V.resolve(r?r.document.mutableCopy():Ye.newInvalidDocument(n))}getEntries(e,n){let r=ln();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ye.newInvalidDocument(s))}),V.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=ln();const o=n.path,a=new X(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||zg(Mx(d),r)<=0||(s.has(d.key)||du(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return V.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ne(9500)}ii(e,n){return V.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Lj(this)}getSize(e){return V.resolve(this.size)}}class Lj extends t1{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),V.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vj{constructor(e){this.persistence=e,this.si=new Dr(n=>vi(n),hu),this.lastRemoteSnapshotVersion=oe.min(),this.highestTargetId=0,this.oi=0,this._i=new oy,this.targetCount=0,this.ai=Ti.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),V.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Ti(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,V.resolve()}updateTargetData(e,n){return this.Pr(n),V.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),V.waitFor(i).next(()=>s)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return V.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),V.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),V.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),V.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return V.resolve(r)}containsKey(e,n){return V.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e,n){this.ui={},this.overlays={},this.ci=new En(0),this.li=!1,this.li=!0,this.hi=new Nj,this.referenceDelegate=e(this),this.Pi=new Vj(this),this.indexManager=new wj,this.remoteDocumentCache=function(s){return new jj(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new HS(n),this.Ii=new Rj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Pj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new Dj(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){z("MemoryPersistence","Starting transaction:",e);const s=new Mj(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return V.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class Mj extends Fx{constructor(e){super(),this.currentSequenceNumber=e}}class Sd{constructor(e){this.persistence=e,this.Ri=new oy,this.Vi=null}static mi(e){return new Sd(e)}get fi(){if(this.Vi)return this.Vi;throw ne(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),V.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),V.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.fi,r=>{const s=X.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,oe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return V.or([()=>V.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Nh{constructor(e,n){this.persistence=e,this.pi=new Dr(r=>Lt(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=e1(this,n)}static mi(e,n){return new Nh(e,n)}Ei(){}di(e){return V.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return V.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?V.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,oe.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),V.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),V.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),V.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),V.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=jc(e.data.value)),n}br(e,n,r){return V.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return V.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(e){this.serializer=e}k(e,n,r,s){const i=new cd("createOrUpgrade",n);r<1&&s>=1&&(function(l){l.createObjectStore(cu)}(e),function(l){l.createObjectStore(Ul,{keyPath:X2}),l.createObjectStore(Dn,{keyPath:kw,autoIncrement:!0}).createIndex(ei,Cw,{unique:!0}),l.createObjectStore(Lo)}(e),g0(e),function(l){l.createObjectStore(Hs)}(e));let o=V.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore(Mo),l.deleteObjectStore(Vo),l.deleteObjectStore(ii)}(e),g0(e)),o=o.next(()=>function(l){const h=l.store(ii),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:oe.min().toTimestamp(),targetCount:0};return h.put(Th,d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,h){return h.store(Dn).J().next(p=>{l.deleteObjectStore(Dn),l.createObjectStore(Dn,{keyPath:kw,autoIncrement:!0}).createIndex(ei,Cw,{unique:!0});const m=h.store(Dn),_=p.map(k=>m.put(k));return V.waitFor(_)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore(Oo,{keyPath:iD})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.yi(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore(Bl)}(e),this.wi(i)))),r<7&&s>=7&&(o=o.next(()=>this.Si(i))),r<8&&s>=8&&(o=o.next(()=>this.bi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Di(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(dd,{keyPath:oD})})(e),function(l){l.createObjectStore(fd,{keyPath:aD})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const h=l.createObjectStore(pd,{keyPath:pD});h.createIndex(um,mD,{unique:!1}),h.createIndex(Wx,gD,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const h=l.createObjectStore(Eh,{keyPath:J2});h.createIndex(Nc,Z2),h.createIndex(zx,eD)}(e)).next(()=>this.Ci(e,i)).next(()=>e.deleteObjectStore(Hs))),r<14&&s>=14&&(o=o.next(()=>this.Fi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore(qg,{keyPath:lD,autoIncrement:!0}).createIndex(lm,uD,{unique:!1}),l.createObjectStore(cl,{keyPath:cD}).createIndex(Hx,hD,{unique:!1}),l.createObjectStore(hl,{keyPath:dD}).createIndex(qx,fD,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(cl).clear()}).next(()=>{n.objectStore(hl).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(Wg,{keyPath:yD})})(e)})),r<18&&s>=18&&vx()&&(o=o.next(()=>{n.objectStore(cl).clear()}).next(()=>{n.objectStore(hl).clear()})),o}wi(e){let n=0;return e.store(Hs).ee((r,s)=>{n+=Ph(s)}).next(()=>{const r={byteSize:n};return e.store(Bl).put(am,r)})}yi(e){const n=e.store(Ul),r=e.store(Dn);return n.J().next(s=>V.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,si],[i.userId,i.lastAcknowledgedBatchId]);return r.J(ei,o).next(a=>V.forEach(a,l=>{ie(l.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const h=Ws(this.serializer,l);return XS(e,i.userId,h).next(()=>{})}))}))}Si(e){const n=e.store(Mo),r=e.store(Hs);return e.store(ii).get(Th).next(s=>{const i=[];return r.ee((o,a)=>{const l=new Ie(o),h=function(p){return[0,Lt(p)]}(l);i.push(n.get(h).next(d=>d?V.resolve():(p=>n.put({targetId:0,path:Lt(p),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>V.waitFor(i))})}bi(e,n){e.createObjectStore(zl,{keyPath:sD});const r=n.store(zl),s=new iy,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Lt(l)})}};return n.store(Hs).ee({X:!0},(o,a)=>{const l=new Ie(o);return i(l.popLast())}).next(()=>n.store(Lo).ee({X:!0},([o,a,l],h)=>{const d=Gn(a);return i(d.popLast())}))}Di(e){const n=e.store(Vo);return n.ee((r,s)=>{const i=Ga(s),o=qS(this.serializer,i);return n.put(o)})}Ci(e,n){const r=n.store(Hs),s=[];return r.ee((i,o)=>{const a=n.store(Eh),l=function(p){return p.document?new X(Ie.fromString(p.document.name).popFirst(5)):p.noDocument?X.fromSegments(p.noDocument.path):p.unknownDocument?X.fromSegments(p.unknownDocument.path):ne(36783)}(o).path.toArray(),h={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(h))}).next(()=>V.waitFor(s))}Fi(e,n){const r=n.store(Dn),s=n1(this.serializer),i=new ay(Sd.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let h=a.get(l.userId)??pe();Ws(this.serializer,l).keys().forEach(d=>h=h.add(d)),a.set(l.userId,h)}),V.forEach(a,(l,h)=>{const d=new xt(h),p=Id.wt(this.serializer,d),m=i.getIndexManager(d),_=xd.wt(d,this.serializer,m,i.referenceDelegate);return new r1(s,_,p,m).recalculateAndSaveOverlaysForDocumentKeys(new cm(n,En.ce),l).next()})})}}function g0(t){t.createObjectStore(Mo,{keyPath:nD}).createIndex(Hg,rD,{unique:!0}),t.createObjectStore(Vo,{keyPath:"targetId"}).createIndex($x,tD,{unique:!0}),t.createObjectStore(ii)}const qr="IndexedDbPersistence",Uf=18e5,Bf=5e3,zf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Fj="main";class ly{constructor(e,n,r,s,i,o,a,l,h,d,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=i,this.window=o,this.document=a,this.xi=h,this.Oi=d,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!ly.v())throw new W(U.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new kj(this,s),this.$i=n+Fj,this.serializer=new HS(l),this.Ui=new gs(this.$i,this.Ni,new Oj(this.serializer)),this.hi=new pj,this.Pi=new Tj(this.referenceDelegate,this.serializer),this.remoteDocumentCache=n1(this.serializer),this.Ii=new fj,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&Bt(qr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new W(U.FAILED_PRECONDITION,zf);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new En(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ac(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(bs(e))return z(qr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return z(qr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return Ma(e).get(Bi).next(n=>V.resolve(this.es(n)))}ts(e){return ac(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Uf)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=ft(n,Oo);return r.J().next(s=>{const i=this.ss(s,Uf),o=s.filter(a=>i.indexOf(a)===-1);return V.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?V.resolve(!0):Ma(e).get(Bi).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Bf)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new W(U.FAILED_PRECONDITION,zf);return!1}}return!(!this.networkEnabled||!this.inForeground)||ac(e).J().next(r=>this.ss(r,Bf).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&z(qr,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[cu,Oo],e=>{const n=new cm(e,En.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>ac(e).J().next(n=>this.ss(n,Uf).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return xd.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Ej(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Id.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){z(qr,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(l){return l===18?wD:l===17?Xx:l===16?vD:l===15?Kg:l===14?Qx:l===13?Gx:l===12?_D:l===11?Kx:void ne(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,s,i,a=>(o=new cm(a,this.ci?this.ci.next():En.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw Bt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new W(U.FAILED_PRECONDITION,Ox);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return Ma(e).get(Bi).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Bf)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new W(U.FAILED_PRECONDITION,zf)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ma(e).put(Bi,n)}static v(){return gs.v()}Zi(e){const n=Ma(e);return n.get(Bi).next(r=>this.es(r)?(z(qr,"Releasing primary lease."),n.delete(Bi)):V.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Bt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;_x()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return z(qr,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Bt(qr,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Bt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ma(t){return ft(t,cu)}function ac(t){return ft(t,Oo)}function Uj(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=pe(),s=pe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new uy(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return _x()?8:Ux(dt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new Bj;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(Gi()<=ye.DEBUG&&z("QueryEngine","SDK will not create cache indexes for query:",Qi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),V.resolve()):(Gi()<=ye.DEBUG&&z("QueryEngine","Query:",Qi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Gi()<=ye.DEBUG&&z("QueryEngine","The SDK decides to create cache indexes for query:",Qi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,In(n))):V.resolve())}ys(e,n){if(Uw(n))return V.resolve(null);let r=In(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=kh(n,null,"F"),r=In(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=pe(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const h=this.Ds(n,a);return this.Cs(n,h,o,l.readTime)?this.ys(e,kh(n,null,"F")):this.vs(e,h,n,l)}))})))}ws(e,n,r,s){return Uw(n)||s.isEqual(oe.min())?V.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?V.resolve(null):(Gi()<=ye.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Qi(n)),this.vs(e,o,n,$2(s,Ml)).next(a=>a))})}Ds(e,n){let r=new be(gS(e));return n.forEach((s,i)=>{du(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return Gi()<=ye.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",Qi(n)),this.ps.getDocumentsMatchingQuery(e,n,dn.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy="LocalStore",zj=3e8;class $j{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new Ue(he),this.xs=new Dr(i=>vi(i),hu),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new r1(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function i1(t,e,n,r){return new $j(t,e,n,r)}async function o1(t,e){const n=de(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=pe();for(const h of s){o.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of i){a.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(h=>({Ls:h,removedBatchIds:o,addedBatchIds:a}))})})}function Hj(t,e){const n=de(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,h,d){const p=h.batch,m=p.keys();let _=V.resolve();return m.forEach(k=>{_=_.next(()=>d.getEntry(l,k)).next(A=>{const b=h.docVersions.get(k);ie(b!==null,48541),A.version.compareTo(b)<0&&(p.applyToRemoteDocument(A,h),A.isValidDocument()&&(A.setReadTime(h.commitVersion),d.addEntry(A)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(l,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=pe();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(l=l.add(a.batch.mutations[h].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function a1(t){const e=de(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function qj(t,e){const n=de(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((d,p)=>{const m=s.get(p);if(!m)return;a.push(n.Pi.removeMatchingKeys(i,d.removedDocuments,p).next(()=>n.Pi.addMatchingKeys(i,d.addedDocuments,p)));let _=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?_=_.withResumeToken(it.EMPTY_BYTE_STRING,oe.min()).withLastLimboFreeSnapshotVersion(oe.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),s=s.insert(p,_),function(A,b,T){return A.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=zj?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(m,_,d)&&a.push(n.Pi.updateTargetData(i,_))});let l=ln(),h=pe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(Wj(i,o,e.documentUpdates).next(d=>{l=d.ks,h=d.qs})),!r.isEqual(oe.min())){const d=n.Pi.getLastRemoteSnapshotVersion(i).next(p=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return V.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,h)).next(()=>l)}).then(i=>(n.Ms=s,i))}function Wj(t,e,n){let r=pe(),s=pe();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=ln();return n.forEach((a,l)=>{const h=i.get(a);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(oe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):z(cy,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",l.version)}),{ks:o,qs:s}})}function Kj(t,e){const n=de(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=si),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Gj(t,e){const n=de(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,V.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new mr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function xm(t,e,n){const r=de(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!bs(o))throw o;z(cy,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function y0(t,e,n){const r=de(t);let s=oe.min(),i=pe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,h,d){const p=de(l),m=p.xs.get(d);return m!==void 0?V.resolve(p.Ms.get(m)):p.Pi.getTargetData(h,d)}(r,o,In(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:oe.min(),n?i:pe())).next(a=>(Qj(r,LD(e),a),{documents:a,Qs:i})))}function Qj(t,e,n){let r=t.Os.get(e)||oe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class _0{constructor(){this.activeTargetIds=BD()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class l1{constructor(){this.Mo=new _0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new _0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xj{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v0="ConnectivityMonitor";class w0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){z(v0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){z(v0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lc=null;function Sm(){return lc===null?lc=function(){return 268435456+Math.round(2147483648*Math.random())}():lc++,"0x"+lc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $f="RestConnection",Yj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Jj{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Ih?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=Sm(),a=this.zo(e,n.toUriEncodedString());z($f,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:h}=new URL(a),d=As(h);return this.Jo(e,a,l,r,d).then(p=>(z($f,`Received RPC '${e}' ${o}: `,p),p),p=>{throw yi($f,`RPC '${e}' ${o} failed with error: `,p,"url: ",a,"request:",r),p})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Zo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=Yj[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zj{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rt="WebChannelConnection";class eL extends Jj{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=Sm();return new Promise((a,l)=>{const h=new Cx;h.setWithCredentials(!0),h.listenOnce(Ax.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case bc.NO_ERROR:const p=h.getResponseJson();z(Rt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case bc.TIMEOUT:z(Rt,`RPC '${e}' ${o} timed out`),l(new W(U.DEADLINE_EXCEEDED,"Request time out"));break;case bc.HTTP_ERROR:const m=h.getStatus();if(z(Rt,`RPC '${e}' ${o} failed with status:`,m,"response text:",h.getResponseText()),m>0){let _=h.getResponseJson();Array.isArray(_)&&(_=_[0]);const k=_==null?void 0:_.error;if(k&&k.status&&k.message){const A=function(T){const w=T.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(w)>=0?w:U.UNKNOWN}(k.status);l(new W(A,k.message))}else l(new W(U.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new W(U.UNAVAILABLE,"Connection failed."));break;default:ne(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{z(Rt,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);z(Rt,`RPC '${e}' ${o} sending request:`,s),h.send(n,"POST",d,r,15)})}T_(e,n,r){const s=Sm(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Px(),a=Rx(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=i.join("");z(Rt,`Creating RPC '${e}' stream ${s}: ${d}`,l);const p=o.createWebChannel(d,l);this.I_(p);let m=!1,_=!1;const k=new Zj({Yo:b=>{_?z(Rt,`Not sending because RPC '${e}' stream ${s} is closed:`,b):(m||(z(Rt,`Opening RPC '${e}' stream ${s} transport.`),p.open(),m=!0),z(Rt,`RPC '${e}' stream ${s} sending:`,b),p.send(b))},Zo:()=>p.close()}),A=(b,T,w)=>{b.listen(T,E=>{try{w(E)}catch(N){setTimeout(()=>{throw N},0)}})};return A(p,qa.EventType.OPEN,()=>{_||(z(Rt,`RPC '${e}' stream ${s} transport opened.`),k.o_())}),A(p,qa.EventType.CLOSE,()=>{_||(_=!0,z(Rt,`RPC '${e}' stream ${s} transport closed`),k.a_(),this.E_(p))}),A(p,qa.EventType.ERROR,b=>{_||(_=!0,yi(Rt,`RPC '${e}' stream ${s} transport errored. Name:`,b.name,"Message:",b.message),k.a_(new W(U.UNAVAILABLE,"The operation could not be completed")))}),A(p,qa.EventType.MESSAGE,b=>{var T;if(!_){const w=b.data[0];ie(!!w,16349);const E=w,N=(E==null?void 0:E.error)||((T=E[0])==null?void 0:T.error);if(N){z(Rt,`RPC '${e}' stream ${s} received error:`,N);const j=N.status;let F=function(v){const C=nt[v];if(C!==void 0)return RS(C)}(j),S=N.message;F===void 0&&(F=U.INTERNAL,S="Unknown error status: "+j+" with message "+N.message),_=!0,k.a_(new W(F,S)),p.close()}else z(Rt,`RPC '${e}' stream ${s} received:`,w),k.u_(w)}}),A(a,bx.STAT_EVENT,b=>{b.stat===sm.PROXY?z(Rt,`RPC '${e}' stream ${s} detected buffering proxy`):b.stat===sm.NOPROXY&&z(Rt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{k.__()},0),k}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tL(){return typeof window<"u"?window:null}function Fc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kd(t){return new nj(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&z("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E0="PersistentStream";class c1{constructor(e,n,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new u1(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===U.RESOURCE_EXHAUSTED?(Bt(n.toString()),Bt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new W(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return z(E0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(z(E0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nL extends c1{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=ij(this.serializer,e),r=function(i){if(!("targetChange"in i))return oe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?oe.min():o.readTime?Ht(o.readTime):oe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=vm(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=xh(l)?{documents:OS(i,l)}:{query:FS(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=DS(i,o.resumeToken);const h=ym(i,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(oe.min())>0){a.readTime=Wo(i,o.snapshotVersion.toTimestamp());const h=ym(i,o.expectedCount);h!==null&&(a.expectedCount=h)}return a}(this.serializer,e);const r=aj(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=vm(this.serializer),n.removeTarget=e,this.q_(n)}}class rL extends c1{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ie(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ie(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ie(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=oj(e.writeResults,e.commitTime),r=Ht(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=vm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Ah(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sL{}class iL extends sL{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new W(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,_m(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new W(U.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,_m(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new W(U.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class oL{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Bt(n),this.aa=!1):z("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii="RemoteStore";class aL{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Ni(this)&&(z(Ii,"Restarting streams for network reachability change."),await async function(l){const h=de(l);h.Ea.add(4),await pu(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Cd(h)}(this))})}),this.Ra=new oL(r,s)}}async function Cd(t){if(Ni(t))for(const e of t.da)await e(!0)}async function pu(t){for(const e of t.da)await e(!1)}function h1(t,e){const n=de(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),py(n)?fy(n):na(n).O_()&&dy(n,e))}function hy(t,e){const n=de(t),r=na(n);n.Ia.delete(e),r.O_()&&d1(n,e),n.Ia.size===0&&(r.O_()?r.L_():Ni(n)&&n.Ra.set("Unknown"))}function dy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(oe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}na(t).Y_(e)}function d1(t,e){t.Va.Ue(e),na(t).Z_(e)}function fy(t){t.Va=new JD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),na(t).start(),t.Ra.ua()}function py(t){return Ni(t)&&!na(t).x_()&&t.Ia.size>0}function Ni(t){return de(t).Ea.size===0}function f1(t){t.Va=void 0}async function lL(t){t.Ra.set("Online")}async function uL(t){t.Ia.forEach((e,n)=>{dy(t,e)})}async function cL(t,e){f1(t),py(t)?(t.Ra.ha(e),fy(t)):t.Ra.set("Unknown")}async function hL(t,e,n){if(t.Ra.set("Online"),e instanceof NS&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){z(Ii,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Dh(t,r)}else if(e instanceof Mc?t.Va.Ze(e):e instanceof PS?t.Va.st(e):t.Va.tt(e),!n.isEqual(oe.min()))try{const r=await a1(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,h)=>{const d=i.Ia.get(l);if(!d)return;i.Ia.set(l,d.withResumeToken(it.EMPTY_BYTE_STRING,d.snapshotVersion)),d1(i,l);const p=new mr(d.target,l,h,d.sequenceNumber);dy(i,p)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){z(Ii,"Failed to raise snapshot:",r),await Dh(t,r)}}async function Dh(t,e,n){if(!bs(e))throw e;t.Ea.add(1),await pu(t),t.Ra.set("Offline"),n||(n=()=>a1(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{z(Ii,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Cd(t)})}function p1(t,e){return e().catch(n=>Dh(t,n,e))}async function mu(t){const e=de(t),n=Is(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:si;for(;dL(e);)try{const s=await Kj(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,fL(e,s)}catch(s){await Dh(e,s)}m1(e)&&g1(e)}function dL(t){return Ni(t)&&t.Ta.length<10}function fL(t,e){t.Ta.push(e);const n=Is(t);n.O_()&&n.X_&&n.ea(e.mutations)}function m1(t){return Ni(t)&&!Is(t).x_()&&t.Ta.length>0}function g1(t){Is(t).start()}async function pL(t){Is(t).ra()}async function mL(t){const e=Is(t);for(const n of t.Ta)e.ea(n.mutations)}async function gL(t,e,n){const r=t.Ta.shift(),s=ey.from(r,e,n);await p1(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await mu(t)}async function yL(t,e){e&&Is(t).X_&&await async function(r,s){if(function(o){return QD(o)&&o!==U.ABORTED}(s.code)){const i=r.Ta.shift();Is(r).B_(),await p1(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await mu(r)}}(t,e),m1(t)&&g1(t)}async function T0(t,e){const n=de(t);n.asyncQueue.verifyOperationInProgress(),z(Ii,"RemoteStore received new credentials");const r=Ni(n);n.Ea.add(3),await pu(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Cd(n)}async function _L(t,e){const n=de(t);e?(n.Ea.delete(2),await Cd(n)):e||(n.Ea.add(2),await pu(n),n.Ra.set("Unknown"))}function na(t){return t.ma||(t.ma=function(n,r,s){const i=de(n);return i.sa(),new nL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:lL.bind(null,t),t_:uL.bind(null,t),r_:cL.bind(null,t),H_:hL.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),py(t)?fy(t):t.Ra.set("Unknown")):(await t.ma.stop(),f1(t))})),t.ma}function Is(t){return t.fa||(t.fa=function(n,r,s){const i=de(n);return i.sa(),new rL(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:pL.bind(null,t),r_:yL.bind(null,t),ta:mL.bind(null,t),na:gL.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await mu(t)):(await t.fa.stop(),t.Ta.length>0&&(z(Ii,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new my(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gy(t,e){if(Bt("AsyncQueue",`${e}: ${t}`),bs(t))return new W(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{static emptySet(e){return new Eo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||X.comparator(n.key,r.key):(n,r)=>X.comparator(n.key,r.key),this.keyedMap=Wa(),this.sortedSet=new Ue(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Eo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Eo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(){this.ga=new Ue(X.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ne(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ko{constructor(e,n,r,s,i,o,a,l,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ko(e,n,Eo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_d(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class wL{constructor(){this.queries=x0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=de(n),i=s.queries;s.queries=x0(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new W(U.ABORTED,"Firestore shutting down"))}}function x0(){return new Dr(t=>mS(t),_d)}async function y1(t,e){const n=de(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new vL,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=gy(o,`Initialization of query '${Qi(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&yy(n)}async function _1(t,e){const n=de(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function EL(t,e){const n=de(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&yy(n)}function TL(t,e,n){const r=de(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function yy(t){t.Ca.forEach(e=>{e.next()})}var km,S0;(S0=km||(km={})).Ma="default",S0.Cache="cache";class v1{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ko(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ko.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==km.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e){this.key=e}}class E1{constructor(e){this.key=e}}class IL{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=pe(),this.mutatedKeys=pe(),this.eu=gS(e),this.tu=new Eo(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new I0,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,p)=>{const m=s.get(d),_=du(this.query,p)?p:null,k=!!m&&this.mutatedKeys.has(m.key),A=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let b=!1;m&&_?m.data.isEqual(_.data)?k!==A&&(r.track({type:3,doc:_}),b=!0):this.su(m,_)||(r.track({type:2,doc:_}),b=!0,(l&&this.eu(_,l)>0||h&&this.eu(_,h)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),b=!0):m&&!_&&(r.track({type:1,doc:m}),b=!0,(l||h)&&(a=!0)),b&&(_?(o=o.add(_),i=A?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,p)=>function(_,k){const A=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ne(20277,{Rt:b})}};return A(_)-A(k)}(d.type,p.type)||this.eu(d.doc,p.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,h=l!==this.Za;return this.Za=l,o.length!==0||h?{snapshot:new Ko(this.query,e.tu,i,o,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new I0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=pe(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new E1(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new w1(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=pe();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ko.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const _y="SyncEngine";class xL{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class SL{constructor(e){this.key=e,this.hu=!1}}class kL{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Dr(a=>mS(a),_d),this.Iu=new Map,this.Eu=new Set,this.du=new Ue(X.comparator),this.Au=new Map,this.Ru=new oy,this.Vu={},this.mu=new Map,this.fu=Ti.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function CL(t,e,n=!0){const r=C1(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await T1(r,e,n,!0),s}async function AL(t,e){const n=C1(t);await T1(n,e,!0,!1)}async function T1(t,e,n,r){const s=await Gj(t.localStore,In(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await bL(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&h1(t.remoteStore,s),a}async function bL(t,e,n,r,s){t.pu=(p,m,_)=>async function(A,b,T,w){let E=b.view.ru(T);E.Cs&&(E=await y0(A.localStore,b.query,!1).then(({documents:S})=>b.view.ru(S,E)));const N=w&&w.targetChanges.get(b.targetId),j=w&&w.targetMismatches.get(b.targetId)!=null,F=b.view.applyChanges(E,A.isPrimaryClient,N,j);return C0(A,b.targetId,F.au),F.snapshot}(t,p,m,_);const i=await y0(t.localStore,e,!0),o=new IL(e,i.Qs),a=o.ru(i.documents),l=fu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=o.applyChanges(a,t.isPrimaryClient,l);C0(t,n,h.au);const d=new xL(e,n,o);return t.Tu.set(e,d),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),h.snapshot}async function RL(t,e,n){const r=de(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!_d(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await xm(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&hy(r.remoteStore,s.targetId),Cm(r,s.targetId)}).catch(Pi)):(Cm(r,s.targetId),await xm(r.localStore,s.targetId,!0))}async function PL(t,e){const n=de(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),hy(n.remoteStore,r.targetId))}async function NL(t,e,n){const r=A1(t);try{const s=await function(o,a){const l=de(o),h=ke.now(),d=a.reduce((_,k)=>_.add(k.key),pe());let p,m;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let k=ln(),A=pe();return l.Ns.getEntries(_,d).next(b=>{k=b,k.forEach((T,w)=>{w.isValidDocument()||(A=A.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,k)).next(b=>{p=b;const T=[];for(const w of a){const E=KD(w,p.get(w.key).overlayedDocument);E!=null&&T.push(new jr(w.key,E,oS(E.value.mapValue),jt.exists(!0)))}return l.mutationQueue.addMutationBatch(_,h,T,a)}).next(b=>{m=b;const T=b.applyToLocalDocumentSet(p,A);return l.documentOverlayCache.saveOverlays(_,b.batchId,T)})}).then(()=>({batchId:m.batchId,changes:_S(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let h=o.Vu[o.currentUser.toKey()];h||(h=new Ue(he)),h=h.insert(a,l),o.Vu[o.currentUser.toKey()]=h}(r,s.batchId,n),await gu(r,s.changes),await mu(r.remoteStore)}catch(s){const i=gy(s,"Failed to persist write");n.reject(i)}}async function I1(t,e){const n=de(t);try{const r=await qj(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(ie(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?ie(o.hu,14607):s.removedDocuments.size>0&&(ie(o.hu,42227),o.hu=!1))}),await gu(n,r,e)}catch(r){await Pi(r)}}function k0(t,e,n){const r=de(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=de(o);l.onlineState=a;let h=!1;l.queries.forEach((d,p)=>{for(const m of p.Sa)m.va(a)&&(h=!0)}),h&&yy(l)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function DL(t,e,n){const r=de(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Ue(X.comparator);o=o.insert(i,Ye.newNoDocument(i,oe.min()));const a=pe().add(i),l=new Td(oe.min(),new Map,new Ue(he),o,a);await I1(r,l),r.du=r.du.remove(i),r.Au.delete(e),vy(r)}else await xm(r.localStore,e,!1).then(()=>Cm(r,e,n)).catch(Pi)}async function jL(t,e){const n=de(t),r=e.batch.batchId;try{const s=await Hj(n.localStore,e);S1(n,r,null),x1(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await gu(n,s)}catch(s){await Pi(s)}}async function LL(t,e,n){const r=de(t);try{const s=await function(o,a){const l=de(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let d;return l.mutationQueue.lookupMutationBatch(h,a).next(p=>(ie(p!==null,37113),d=p.keys(),l.mutationQueue.removeMutationBatch(h,p))).next(()=>l.mutationQueue.performConsistencyCheck(h)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d)).next(()=>l.localDocuments.getDocuments(h,d))})}(r.localStore,e);S1(r,e,n),x1(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await gu(r,s)}catch(s){await Pi(s)}}function x1(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function S1(t,e,n){const r=de(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Cm(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||k1(t,r)})}function k1(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(hy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),vy(t))}function C0(t,e,n){for(const r of n)r instanceof w1?(t.Ru.addReference(r.key,e),VL(t,r)):r instanceof E1?(z(_y,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||k1(t,r.key)):ne(19791,{wu:r})}function VL(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(z(_y,"New document in limbo: "+n),t.Eu.add(r),vy(t))}function vy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new X(Ie.fromString(e)),r=t.fu.next();t.Au.set(r,new SL(n)),t.du=t.du.insert(n,r),h1(t.remoteStore,new mr(In(yd(n.path)),r,"TargetPurposeLimboResolution",En.ce))}}async function gu(t,e,n){const r=de(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(h=>{var d;if((h||n)&&r.isPrimaryClient){const p=h?!h.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(h){s.push(h);const p=uy.As(l.targetId,h);i.push(p)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(l,h){const d=de(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>V.forEach(h,m=>V.forEach(m.Es,_=>d.persistence.referenceDelegate.addReference(p,m.targetId,_)).next(()=>V.forEach(m.ds,_=>d.persistence.referenceDelegate.removeReference(p,m.targetId,_)))))}catch(p){if(!bs(p))throw p;z(cy,"Failed to update sequence numbers: "+p)}for(const p of h){const m=p.targetId;if(!p.fromCache){const _=d.Ms.get(m),k=_.snapshotVersion,A=_.withLastLimboFreeSnapshotVersion(k);d.Ms=d.Ms.insert(m,A)}}}(r.localStore,i))}async function ML(t,e){const n=de(t);if(!n.currentUser.isEqual(e)){z(_y,"User change. New user:",e.toKey());const r=await o1(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new W(U.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await gu(n,r.Ls)}}function OL(t,e){const n=de(t),r=n.Au.get(e);if(r&&r.hu)return pe().add(r.key);{let s=pe();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function C1(t){const e=de(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=I1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=OL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=DL.bind(null,e),e.Pu.H_=EL.bind(null,e.eventManager),e.Pu.yu=TL.bind(null,e.eventManager),e}function A1(t){const e=de(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=LL.bind(null,e),e}class Ql{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=kd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return i1(this.persistence,new s1,e.initialUser,this.serializer)}Cu(e){return new ay(Sd.mi,this.serializer)}Du(e){return new l1}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ql.provider={build:()=>new Ql};class FL extends Ql{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ie(this.persistence.referenceDelegate instanceof Nh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ZS(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Pt.withCacheSize(this.cacheSizeBytes):Pt.DEFAULT;return new ay(r=>Nh.mi(r,n),this.serializer)}}class UL extends Ql{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await A1(this.xu.syncEngine),await mu(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return i1(this.persistence,new s1,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new ZS(r,e.asyncQueue,n)}Mu(e,n){const r=new K2(n,this.persistence);return new W2(e.asyncQueue,r)}Cu(e){const n=Uj(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Pt.withCacheSize(this.cacheSizeBytes):Pt.DEFAULT;return new ly(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,tL(),Fc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new l1}}class jh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>k0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=ML.bind(null,this.syncEngine),await _L(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new wL}()}createDatastore(e){const n=kd(e.databaseInfo.databaseId),r=function(i){return new eL(i)}(e.databaseInfo);return function(i,o,a,l){return new iL(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new aL(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>k0(this.syncEngine,n,0),function(){return w0.v()?new w0:new Xj}())}createSyncEngine(e,n){return function(s,i,o,a,l,h,d){const p=new kL(s,i,o,a,l,h);return d&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=de(s);z(Ii,"RemoteStore shutting down."),i.Ea.add(5),await pu(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}jh.provider={build:()=>new jh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Bt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs="FirestoreClient";class BL{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=xt.UNAUTHENTICATED,this.clientId=Bg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{z(xs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(z(xs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=gy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Hf(t,e){t.asyncQueue.verifyOperationInProgress(),z(xs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await o1(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function A0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await zL(t);z(xs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>T0(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>T0(e.remoteStore,s)),t._onlineComponents=e}async function zL(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){z(xs,"Using user provided OfflineComponentProvider");try{await Hf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===U.FAILED_PRECONDITION||s.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;yi("Error using user provided cache. Falling back to memory cache: "+n),await Hf(t,new Ql)}}else z(xs,"Using default OfflineComponentProvider"),await Hf(t,new FL(void 0));return t._offlineComponents}async function R1(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(z(xs,"Using user provided OnlineComponentProvider"),await A0(t,t._uninitializedComponentsProvider._online)):(z(xs,"Using default OnlineComponentProvider"),await A0(t,new jh))),t._onlineComponents}function $L(t){return R1(t).then(e=>e.syncEngine)}async function P1(t){const e=await R1(t),n=e.eventManager;return n.onListen=CL.bind(null,e.syncEngine),n.onUnlisten=RL.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=AL.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=PL.bind(null,e.syncEngine),n}function HL(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,h){const d=new b1({next:m=>{d.Nu(),o.enqueueAndForget(()=>_1(i,p));const _=m.docs.has(a);!_&&m.fromCache?h.reject(new W(U.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&l&&l.source==="server"?h.reject(new W(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(m)},error:m=>h.reject(m)}),p=new v1(yd(a.path),d,{includeMetadataChanges:!0,qa:!0});return y1(i,p)}(await P1(t),t.asyncQueue,e,n,r)),r.promise}function qL(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,h){const d=new b1({next:m=>{d.Nu(),o.enqueueAndForget(()=>_1(i,p)),m.fromCache&&l.source==="server"?h.reject(new W(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(m)},error:m=>h.reject(m)}),p=new v1(a,d,{includeMetadataChanges:!0,qa:!0});return y1(i,p)}(await P1(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1="firestore.googleapis.com",R0=!0;class P0{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new W(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=D1,this.ssl=R0}else this.host=e.host,this.ssl=e.ssl??R0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=QS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ij)throw new W(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}B2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=N1(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new W(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new W(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new W(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ad{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new P0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new W(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new W(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new P0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new P2;switch(r.type){case"firstParty":return new L2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new W(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=b0.get(n);r&&(z("ComponentProvider","Removing Datastore"),b0.delete(n),r.terminate())}(this),Promise.resolve()}}function WL(t,e,n,r={}){var h;t=Cn(t,Ad);const s=As(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(Lg(`https://${a}`),Vg("Firestore",!0)),i.host!==D1&&i.host!==a&&yi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!pi(l,o)&&(t._setSettings(l),r.mockUserToken)){let d,p;if(typeof r.mockUserToken=="string")d=r.mockUserToken,p=xt.MOCK_USER;else{d=gx(r.mockUserToken,(h=t._app)==null?void 0:h.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new W(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new xt(m)}t._authCredentials=new N2(new Dx(d,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ps(this.firestore,e,this._query)}}class Ze{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ys(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ze(this.firestore,e,this._key)}toJSON(){return{type:Ze._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(uu(n,Ze._jsonSchema))return new Ze(e,r||null,new X(Ie.fromString(n.referencePath)))}}Ze._jsonSchemaVersion="firestore/documentReference/1.0",Ze._jsonSchema={type:st("string",Ze._jsonSchemaVersion),referencePath:st("string")};class ys extends Ps{constructor(e,n,r){super(e,n,yd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ze(this.firestore,null,new X(e))}withConverter(e){return new ys(this.firestore,e,this._path)}}function yu(t,e,...n){if(t=We(t),Lx("collection","path",e),t instanceof Ad){const r=Ie.fromString(e,...n);return Ew(r),new ys(t,null,r)}{if(!(t instanceof Ze||t instanceof ys))throw new W(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ie.fromString(e,...n));return Ew(r),new ys(t.firestore,null,r)}}function Gt(t,e,...n){if(t=We(t),arguments.length===1&&(e=Bg.newId()),Lx("doc","path",e),t instanceof Ad){const r=Ie.fromString(e,...n);return ww(r),new Ze(t,null,new X(r))}{if(!(t instanceof Ze||t instanceof ys))throw new W(U.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ie.fromString(e,...n));return ww(r),new Ze(t.firestore,t instanceof ys?t.converter:null,new X(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0="AsyncQueue";class D0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new u1(this,"async_queue_retry"),this._c=()=>{const r=Fc();r&&z(N0,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Fc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Fc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new er;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!bs(e))throw e;z(N0,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Bt("INTERNAL UNHANDLED ERROR: ",j0(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=my.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&ne(47125,{Pc:j0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function j0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Ns extends Ad{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new D0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new D0(e),this._firestoreClient=void 0,await e}}}function KL(t,e){const n=typeof t=="object"?t:Fg(),r=typeof t=="string"?t:Ih,s=ld(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=fx("firestore");i&&WL(s,...i)}return s}function wy(t){if(t._terminated)throw new W(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||j1(t),t._firestoreClient}function j1(t){var r,s,i;const e=t._freezeSettings(),n=function(a,l,h,d){return new TD(a,l,h,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,N1(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new BL(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function GL(t,e){yi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return QL(t,jh.provider,{build:r=>new UL(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function QL(t,e,n){if((t=Cn(t,Ns))._firestoreClient||t._terminated)throw new W(U.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new W(U.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},j1(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vn(it.fromBase64String(e))}catch(n){throw new W(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new vn(it.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:vn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(uu(e,vn._jsonSchema))return vn.fromBase64String(e.bytes)}}vn._jsonSchemaVersion="firestore/bytes/1.0",vn._jsonSchema={type:st("string",vn._jsonSchemaVersion),bytes:st("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new W(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new W(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new W(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return he(this._lat,e._lat)||he(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:tr._jsonSchemaVersion}}static fromJSON(e){if(uu(e,tr._jsonSchema))return new tr(e.latitude,e.longitude)}}tr._jsonSchemaVersion="firestore/geoPoint/1.0",tr._jsonSchema={type:st("string",tr._jsonSchemaVersion),latitude:st("number"),longitude:st("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:nr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(uu(e,nr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new nr(e.vectorValues);throw new W(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}nr._jsonSchemaVersion="firestore/vectorValue/1.0",nr._jsonSchema={type:st("string",nr._jsonSchemaVersion),vectorValues:st("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL=/^__.*__$/;class YL{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new jr(e,this.data,this.fieldMask,n,this.fieldTransforms):new ta(e,this.data,n,this.fieldTransforms)}}class L1{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new jr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function V1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ne(40011,{Ac:t})}}class Ey{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ey({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Lh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(V1(this.Ac)&&XL.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class JL{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||kd(e)}Cc(e,n,r,s=!1){return new Ey({Ac:e,methodName:n,Dc:r,path:ze.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pd(t){const e=t._freezeSettings(),n=kd(t._databaseId);return new JL(t._databaseId,!!e.ignoreUndefinedProperties,n)}function M1(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);Iy("Data must be an object, but it was:",o,r);const a=O1(r,o);let l,h;if(i.merge)l=new Jt(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const p of i.mergeFields){const m=Am(e,p,n);if(!o.contains(m))throw new W(U.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);U1(d,m)||d.push(m)}l=new Jt(d),h=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,h=o.fieldTransforms;return new YL(new Dt(a),l,h)}class Nd extends Rd{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Nd}}class Ty extends Rd{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new qo(e.serializer,ES(e.serializer,this.Fc));return new kS(e.path,n)}isEqual(e){return e instanceof Ty&&this.Fc===e.Fc}}function ZL(t,e,n,r){const s=t.Cc(1,e,n);Iy("Data must be an object, but it was:",s,r);const i=[],o=Dt.empty();Rs(r,(l,h)=>{const d=xy(e,l,n);h=We(h);const p=s.yc(d);if(h instanceof Nd)i.push(d);else{const m=_u(h,p);m!=null&&(i.push(d),o.set(d,m))}});const a=new Jt(i);return new L1(o,a,s.fieldTransforms)}function eV(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[Am(e,r,n)],l=[s];if(i.length%2!=0)throw new W(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(Am(e,i[m])),l.push(i[m+1]);const h=[],d=Dt.empty();for(let m=a.length-1;m>=0;--m)if(!U1(h,a[m])){const _=a[m];let k=l[m];k=We(k);const A=o.yc(_);if(k instanceof Nd)h.push(_);else{const b=_u(k,A);b!=null&&(h.push(_),d.set(_,b))}}const p=new Jt(h);return new L1(d,p,o.fieldTransforms)}function tV(t,e,n,r=!1){return _u(n,t.Cc(r?4:3,e))}function _u(t,e){if(F1(t=We(t)))return Iy("Unsupported field value:",e,t),O1(t,e);if(t instanceof Rd)return function(r,s){if(!V1(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=_u(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=We(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return ES(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ke.fromDate(r);return{timestampValue:Wo(s.serializer,i)}}if(r instanceof ke){const i=new ke(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Wo(s.serializer,i)}}if(r instanceof tr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof vn)return{bytesValue:DS(s.serializer,r._byteString)};if(r instanceof Ze){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ry(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof nr)return function(o,a){return{mapValue:{fields:{[Qg]:{stringValue:Xg},[Fo]:{arrayValue:{values:o.toArray().map(h=>{if(typeof h!="number")throw a.Sc("VectorValues must only contain numeric values.");return Jg(a.serializer,h)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${ud(r)}`)}(t,e)}function O1(t,e){const n={};return Yx(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Rs(t,(r,s)=>{const i=_u(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function F1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ke||t instanceof tr||t instanceof vn||t instanceof Ze||t instanceof Rd||t instanceof nr)}function Iy(t,e,n){if(!F1(n)||!Vx(n)){const r=ud(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Am(t,e,n){if((e=We(e))instanceof bd)return e._internalPath;if(typeof e=="string")return xy(t,e);throw Lh("Field path arguments must be of type string or ",t,!1,void 0,n)}const nV=new RegExp("[~\\*/\\[\\]]");function xy(t,e,n){if(e.search(nV)>=0)throw Lh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new bd(...e.split("."))._internalPath}catch{throw Lh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Lh(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new W(U.INVALID_ARGUMENT,a+t+l)}function U1(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new rV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Sy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class rV extends B1{data(){return super.data()}}function Sy(t,e){return typeof e=="string"?xy(t,e):e instanceof bd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sV(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new W(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ky{}class Cy extends ky{}function L0(t,e,...n){let r=[];e instanceof ky&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof by).length,a=i.filter(l=>l instanceof Ay).length;if(o>1||o>0&&a>0)throw new W(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Ay extends Cy{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Ay(e,n,r)}_apply(e){const n=this._parse(e);return z1(e._query,n),new Ps(e.firestore,e.converter,gm(e._query,n))}_parse(e){const n=Pd(e.firestore);return function(i,o,a,l,h,d,p){let m;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new W(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){F0(p,d);const k=[];for(const A of p)k.push(O0(l,i,A));m={arrayValue:{values:k}}}else m=O0(l,i,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||F0(p,d),m=tV(a,o,p,d==="in"||d==="not-in");return _e.create(h,d,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class by extends ky{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new by(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ce.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)z1(o,l),o=gm(o,l)}(e._query,n),new Ps(e.firestore,e.converter,gm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ry extends Cy{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Ry(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new W(U.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new W(U.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Kl(i,o)}(e._query,this._field,this._direction);return new Ps(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new ea(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function V0(t,e="asc"){const n=e,r=Sy("orderBy",t);return Ry._create(r,n)}class Py extends Cy{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Py(e,n,r)}_apply(e){return new Ps(e.firestore,e.converter,kh(e._query,this._limit,this._limitType))}}function M0(t){return z2("limit",t),Py._create("limit",t,"F")}function O0(t,e,n){if(typeof(n=We(n))=="string"){if(n==="")throw new W(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pS(e)&&n.indexOf("/")!==-1)throw new W(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ie.fromString(n));if(!X.isDocumentKey(r))throw new W(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ql(t,new X(r))}if(n instanceof Ze)return ql(t,n._key);throw new W(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ud(n)}.`)}function F0(t,e){if(!Array.isArray(t)||t.length===0)throw new W(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function z1(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new W(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new W(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class iV{convertValue(e,n="none"){switch(Es(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Oe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(br(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ne(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Rs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Fo].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>Oe(o.doubleValue));return new nr(n)}convertGeoPoint(e){return new tr(Oe(e.latitude),Oe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=md(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp($l(e));default:return null}}convertTimestamp(e){const n=Ar(e);return new ke(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ie.fromString(e);ie($S(r),9688,{name:e});const s=new _i(r.get(1),r.get(3)),i=new X(r.popFirst(5));return s.isEqual(n)||Bt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $1(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class Qa{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ai extends B1{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Uc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Sy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new W(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ai._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ai._jsonSchemaVersion="firestore/documentSnapshot/1.0",ai._jsonSchema={type:st("string",ai._jsonSchemaVersion),bundleSource:st("string","DocumentSnapshot"),bundleName:st("string"),bundle:st("string")};class Uc extends ai{data(e={}){return super.data(e)}}class To{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Qa(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Uc(this._firestore,this._userDataWriter,r.key,r,new Qa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new W(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Uc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Qa(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Uc(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Qa(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:oV(a.type),doc:l,oldIndex:h,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new W(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=To._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Bg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function oV(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ne(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(t){t=Cn(t,Ze);const e=Cn(t.firestore,Ns);return HL(wy(e),t._key).then(n=>lV(e,t,n))}To._jsonSchemaVersion="firestore/querySnapshot/1.0",To._jsonSchema={type:st("string",To._jsonSchemaVersion),bundleSource:st("string","QuerySnapshot"),bundleName:st("string"),bundle:st("string")};class H1 extends iV{constructor(e){super(),this.firestore=e}convertBytes(e){return new vn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ze(this.firestore,null,n)}}function U0(t){t=Cn(t,Ps);const e=Cn(t.firestore,Ns),n=wy(e),r=new H1(e);return sV(t._query),qL(n,t._query).then(s=>new To(e,r,t,s))}function aV(t,e,n){t=Cn(t,Ze);const r=Cn(t.firestore,Ns),s=$1(t.converter,e);return Dd(r,[M1(Pd(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,jt.none())])}function Kr(t,e,n,...r){t=Cn(t,Ze);const s=Cn(t.firestore,Ns),i=Pd(s);let o;return o=typeof(e=We(e))=="string"||e instanceof bd?eV(i,"updateDoc",t._key,e,n,r):ZL(i,"updateDoc",t._key,e),Dd(s,[o.toMutation(t._key,jt.exists(!0))])}function B0(t){return Dd(Cn(t.firestore,Ns),[new Ed(t._key,jt.none())])}function uc(t,e){const n=Cn(t.firestore,Ns),r=Gt(t),s=$1(t.converter,e);return Dd(n,[M1(Pd(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,jt.exists(!1))]).then(()=>r)}function Dd(t,e){return function(r,s){const i=new er;return r.asyncQueue.enqueueAndForget(async()=>NL(await $L(r),s,i)),i.promise}(wy(t),e)}function lV(t,e,n){const r=n.docs.get(e._key),s=new H1(t);return new ai(t,s,e._key,r,new Qa(n.hasPendingWrites,n.fromCache),e.converter)}function z0(t){return new Ty("increment",t)}(function(e,n=!0){(function(s){Zo=s})(Ri),mi(new ws("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Ns(new D2(r.getProvider("auth-internal")),new V2(o,r.getProvider("app-check-internal")),function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new W(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _i(h.options.projectId,d)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Zn(gw,yw,e),Zn(gw,yw,"esm2020")})();function q1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const uV=q1,W1=new au("auth","Firebase",q1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vh=new Mg("@firebase/auth");function cV(t,...e){Vh.logLevel<=ye.WARN&&Vh.warn(`Auth (${Ri}): ${t}`,...e)}function zc(t,...e){Vh.logLevel<=ye.ERROR&&Vh.error(`Auth (${Ri}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Un(t,...e){throw Ny(t,...e)}function rr(t,...e){return Ny(t,...e)}function K1(t,e,n){const r={...uV(),[e]:n};return new au("auth","Firebase",r).create(e,{appName:t.name})}function wr(t){return K1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ny(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return W1.create(t,...e)}function ae(t,e,...n){if(!t)throw Ny(e,...n)}function gr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw zc(e),new Error(e)}function Rr(t,e){t||gr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function hV(){return $0()==="http:"||$0()==="https:"}function $0(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(hV()||dN()||"connection"in navigator)?navigator.onLine:!0}function fV(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Rr(n>e,"Short delay should be less than long delay!"),this.isMobile=cN()||fN()}get(){return dV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dy(t,e){Rr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;gr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;gr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;gr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],gV=new vu(3e4,6e4);function Ds(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Lr(t,e,n,r,s={}){return Q1(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=lu({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:l,...i};return hN()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&As(t.emulatorConfig.host)&&(h.credentials="include"),G1.fetch()(await X1(t,t.config.apiHost,n,a),h)})}async function Q1(t,e,n){t._canInitEmulator=!1;const r={...pV,...e};try{const s=new _V(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw cc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,h]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw cc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw cc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw cc(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw K1(t,d,h);Un(t,d)}}catch(s){if(s instanceof ar)throw s;Un(t,"network-request-failed",{message:String(s)})}}async function wu(t,e,n,r,s={}){const i=await Lr(t,e,n,r,s);return"mfaPendingCredential"in i&&Un(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function X1(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Dy(t.config,s):`${t.config.apiScheme}://${s}`;return mV.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function yV(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class _V{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(rr(this.auth,"network-request-failed")),gV.get())})}}function cc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=rr(t,e,r);return s.customData._tokenResponse=n,s}function H0(t){return t!==void 0&&t.enterprise!==void 0}class vV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return yV(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function wV(t,e){return Lr(t,"GET","/v2/recaptchaConfig",Ds(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EV(t,e){return Lr(t,"POST","/v1/accounts:delete",e)}async function Mh(t,e){return Lr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function TV(t,e=!1){const n=We(t),r=await n.getIdToken(e),s=jy(r);ae(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:gl(qf(s.auth_time)),issuedAtTime:gl(qf(s.iat)),expirationTime:gl(qf(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function qf(t){return Number(t)*1e3}function jy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return zc("JWT malformed, contained fewer than 3 sections"),null;try{const s=cx(n);return s?JSON.parse(s):(zc("Failed to decode base64 JWT payload"),null)}catch(s){return zc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function q0(t){const e=jy(t);return ae(e,"internal-error"),ae(typeof e.exp<"u","internal-error"),ae(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Go(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ar&&IV(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function IV({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=gl(this.lastLoginAt),this.creationTime=gl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oh(t){var p;const e=t.auth,n=await t.getIdToken(),r=await Go(t,Mh(e,{idToken:n}));ae(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(p=s.providerUserInfo)!=null&&p.length?Y1(s.providerUserInfo):[],o=kV(t.providerData,i),a=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),h=a?l:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Rm(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,d)}async function SV(t){const e=We(t);await Oh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function kV(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Y1(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CV(t,e){const n=await Q1(t,{},async()=>{const r=lu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await X1(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&As(t.emulatorConfig.host)&&(l.credentials="include"),G1.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function AV(t,e){return Lr(t,"POST","/v2/accounts:revokeToken",Ds(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ae(e.idToken,"internal-error"),ae(typeof e.idToken<"u","internal-error"),ae(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):q0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ae(e.length!==0,"internal-error");const n=q0(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ae(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await CV(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Io;return r&&(ae(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ae(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ae(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Io,this.toJSON())}_performRefresh(){return gr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wr(t,e){ae(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Vn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new xV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Rm(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Go(this,this.stsTokenManager.getToken(this.auth,e));return ae(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return TV(this,e)}reload(){return SV(this)}_assign(e){this!==e&&(ae(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Vn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ae(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Oh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(on(this.auth.app))return Promise.reject(wr(this.auth));const e=await this.getIdToken();return await Go(this,EV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,h=n.createdAt??void 0,d=n.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:_,providerData:k,stsTokenManager:A}=n;ae(p&&A,e,"internal-error");const b=Io.fromJSON(this.name,A);ae(typeof p=="string",e,"internal-error"),Wr(r,e.name),Wr(s,e.name),ae(typeof m=="boolean",e,"internal-error"),ae(typeof _=="boolean",e,"internal-error"),Wr(i,e.name),Wr(o,e.name),Wr(a,e.name),Wr(l,e.name),Wr(h,e.name),Wr(d,e.name);const T=new Vn({uid:p,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:_,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:b,createdAt:h,lastLoginAt:d});return k&&Array.isArray(k)&&(T.providerData=k.map(w=>({...w}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,n,r=!1){const s=new Io;s.updateFromServerResponse(n);const i=new Vn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Oh(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ae(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Y1(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Io;a.updateFromIdToken(r);const l=new Vn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Rm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,h),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0=new Map;function yr(t){Rr(t instanceof Function,"Expected a class definition");let e=W0.get(t);return e?(Rr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,W0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}J1.type="NONE";const K0=J1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $c(t,e,n){return`firebase:${t}:${e}:${n}`}class xo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=$c(this.userKey,s.apiKey,i),this.fullPersistenceKey=$c("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Mh(this.auth,{idToken:e}).catch(()=>{});return n?Vn._fromGetAccountInfoResponse(this.auth,n,e):null}return Vn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new xo(yr(K0),e,r);const s=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||yr(K0);const o=$c(r,e.config.apiKey,e.name);let a=null;for(const h of n)try{const d=await h._get(o);if(d){let p;if(typeof d=="string"){const m=await Mh(e,{idToken:d}).catch(()=>{});if(!m)break;p=await Vn._fromGetAccountInfoResponse(e,m,d)}else p=Vn._fromJSON(e,d);h!==i&&(a=p),i=h;break}}catch{}const l=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new xo(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new xo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Z1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sk(e))return"Blackberry";if(ik(e))return"Webos";if(ek(e))return"Safari";if((e.includes("chrome/")||tk(e))&&!e.includes("edge/"))return"Chrome";if(rk(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Z1(t=dt()){return/firefox\//i.test(t)}function ek(t=dt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tk(t=dt()){return/crios\//i.test(t)}function nk(t=dt()){return/iemobile/i.test(t)}function rk(t=dt()){return/android/i.test(t)}function sk(t=dt()){return/blackberry/i.test(t)}function ik(t=dt()){return/webos/i.test(t)}function Ly(t=dt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function bV(t=dt()){var e;return Ly(t)&&!!((e=window.navigator)!=null&&e.standalone)}function RV(){return pN()&&document.documentMode===10}function ok(t=dt()){return Ly(t)||rk(t)||ik(t)||sk(t)||/windows phone/i.test(t)||nk(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ak(t,e=[]){let n;switch(t){case"Browser":n=G0(dt());break;case"Worker":n=`${G0(dt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ri}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NV(t,e={}){return Lr(t,"GET","/v2/passwordPolicy",Ds(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DV=6;class jV{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??DV,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Q0(this),this.idTokenSubscription=new Q0(this),this.beforeStateQueue=new PV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=W1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=yr(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await xo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Mh(this,{idToken:e}),r=await Vn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(on(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ae(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Oh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=fV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(on(this.app))return Promise.reject(wr(this));const n=e?We(e):null;return n&&ae(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ae(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return on(this.app)?Promise.reject(wr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return on(this.app)?Promise.reject(wr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(yr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await NV(this),n=new jV(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new au("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await AV(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&yr(e)||this._popupRedirectResolver;ae(n,this,"argument-error"),this.redirectPersistenceManager=await xo.create(this,[yr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ae(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ae(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ak(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(on(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&cV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Di(t){return We(t)}class Q0{constructor(e){this.auth=e,this.observer=null,this.addObserver=wN(n=>this.observer=n)}get next(){return ae(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function VV(t){jd=t}function lk(t){return jd.loadJS(t)}function MV(){return jd.recaptchaEnterpriseScript}function OV(){return jd.gapiScript}function FV(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class UV{constructor(){this.enterprise=new BV}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class BV{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const zV="recaptcha-enterprise",uk="NO_RECAPTCHA";class $V{constructor(e){this.type=zV,this.auth=Di(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{wV(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const h=new vV(l);return i.tenantId==null?i._agentRecaptchaConfig=h:i._tenantRecaptchaConfigs[i.tenantId]=h,o(h.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;H0(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(h=>{o(h)}).catch(()=>{o(uk)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new UV().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&H0(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=MV();l.length!==0&&(l+=a),lk(l).then(()=>{s(a,i,o)}).catch(h=>{o(h)})}}).catch(a=>{o(a)})})}}async function X0(t,e,n,r=!1,s=!1){const i=new $V(t);let o;if(s)o=uk;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,h=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Pm(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await X0(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await X0(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HV(t,e){const n=ld(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(pi(i,e??{}))return s;Un(s,"already-initialized")}return n.initialize({options:e})}function qV(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(yr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function WV(t,e,n){const r=Di(t);ae(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=ck(e),{host:o,port:a}=KV(e),l=a===null?"":`:${a}`,h={url:`${i}//${o}${l}/`},d=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ae(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ae(pi(h,r.config.emulator)&&pi(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,As(o)?(Lg(`${i}//${o}${l}`),Vg("Auth",!0)):GV()}function ck(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function KV(t){const e=ck(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Y0(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Y0(o)}}}function Y0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function GV(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return gr("not implemented")}_getIdTokenResponse(e){return gr("not implemented")}_linkToIdToken(e,n){return gr("not implemented")}_getReauthenticationResolver(e){return gr("not implemented")}}async function QV(t,e){return Lr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XV(t,e){return wu(t,"POST","/v1/accounts:signInWithPassword",Ds(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YV(t,e){return wu(t,"POST","/v1/accounts:signInWithEmailLink",Ds(t,e))}async function JV(t,e){return wu(t,"POST","/v1/accounts:signInWithEmailLink",Ds(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl extends Vy{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Xl(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Xl(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Pm(e,n,"signInWithPassword",XV);case"emailLink":return YV(e,{email:this._email,oobCode:this._password});default:Un(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Pm(e,r,"signUpPassword",QV);case"emailLink":return JV(e,{idToken:n,email:this._email,oobCode:this._password});default:Un(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function So(t,e){return wu(t,"POST","/v1/accounts:signInWithIdp",Ds(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZV="http://localhost";class xi extends Vy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new xi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Un("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new xi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return So(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,So(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,So(e,n)}buildRequest(){const e={requestUri:ZV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=lu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function tM(t){const e=$a(Ha(t)).link,n=e?$a(Ha(e)).deep_link_id:null,r=$a(Ha(t)).deep_link_id;return(r?$a(Ha(r)).link:null)||r||n||e||t}class My{constructor(e){const n=$a(Ha(e)),r=n.apiKey??null,s=n.oobCode??null,i=eM(n.mode??null);ae(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=tM(e);try{return new My(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(){this.providerId=ra.PROVIDER_ID}static credential(e,n){return Xl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=My.parseLink(n);return ae(r,"argument-error"),Xl._fromEmailAndCode(e,r.code,r.tenantId)}}ra.PROVIDER_ID="password";ra.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ra.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu extends hk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends Eu{constructor(){super("facebook.com")}static credential(e){return xi._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zr.credential(e.oauthAccessToken)}catch{return null}}}Zr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr extends Eu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return xi._fromParams({providerId:hr.PROVIDER_ID,signInMethod:hr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return hr.credentialFromTaggedObject(e)}static credentialFromError(e){return hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return hr.credential(n,r)}catch{return null}}}hr.GOOGLE_SIGN_IN_METHOD="google.com";hr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends Eu{constructor(){super("github.com")}static credential(e){return xi._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return es.credential(e.oauthAccessToken)}catch{return null}}}es.GITHUB_SIGN_IN_METHOD="github.com";es.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends Eu{constructor(){super("twitter.com")}static credential(e,n){return xi._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ts.credential(n,r)}catch{return null}}}ts.TWITTER_SIGN_IN_METHOD="twitter.com";ts.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nM(t,e){return wu(t,"POST","/v1/accounts:signUp",Ds(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Vn._fromIdTokenResponse(e,r,s),o=J0(r);return new Si({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=J0(r);return new Si({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function J0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh extends ar{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Fh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Fh(e,n,r,s)}}function dk(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Fh._fromErrorAndOperation(t,i,e,r):i})}async function rM(t,e,n=!1){const r=await Go(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Si._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sM(t,e,n=!1){const{auth:r}=t;if(on(r.app))return Promise.reject(wr(r));const s="reauthenticate";try{const i=await Go(t,dk(r,s,e,t),n);ae(i.idToken,r,"internal-error");const o=jy(i.idToken);ae(o,r,"internal-error");const{sub:a}=o;return ae(t.uid===a,r,"user-mismatch"),Si._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Un(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fk(t,e,n=!1){if(on(t.app))return Promise.reject(wr(t));const r="signIn",s=await dk(t,r,e),i=await Si._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function iM(t,e){return fk(Di(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pk(t){const e=Di(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function oM(t,e,n){if(on(t.app))return Promise.reject(wr(t));const r=Di(t),o=await Pm(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",nM).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&pk(t),l}),a=await Si._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function aM(t,e,n){return on(t.app)?Promise.reject(wr(t)):iM(We(t),ra.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&pk(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lM(t,e){return Lr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mk(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=We(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Go(r,lM(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function uM(t,e,n,r){return We(t).onIdTokenChanged(e,n,r)}function cM(t,e,n){return We(t).beforeAuthStateChanged(e,n)}function hM(t){return We(t).signOut()}const Uh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Uh,"1"),this.storage.removeItem(Uh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dM=1e3,fM=10;class yk extends gk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ok(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);RV()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,fM):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},dM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}yk.type="LOCAL";const pM=yk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k extends gk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}_k.type="SESSION";const vk=_k;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Ld(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async h=>h(n.origin,i)),l=await mM(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ld.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const h=Oy("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(p){const m=p;if(m.data.eventId===h)switch(m.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sr(){return window}function yM(t){sr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(){return typeof sr().WorkerGlobalScope<"u"&&typeof sr().importScripts=="function"}async function _M(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vM(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function wM(){return wk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek="firebaseLocalStorageDb",EM=1,Bh="firebaseLocalStorage",Tk="fbase_key";class Tu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Vd(t,e){return t.transaction([Bh],e?"readwrite":"readonly").objectStore(Bh)}function TM(){const t=indexedDB.deleteDatabase(Ek);return new Tu(t).toPromise()}function Nm(){const t=indexedDB.open(Ek,EM);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Bh,{keyPath:Tk})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Bh)?e(r):(r.close(),await TM(),e(await Nm()))})})}async function Z0(t,e,n){const r=Vd(t,!0).put({[Tk]:e,value:n});return new Tu(r).toPromise()}async function IM(t,e){const n=Vd(t,!1).get(e),r=await new Tu(n).toPromise();return r===void 0?null:r.value}function eE(t,e){const n=Vd(t,!0).delete(e);return new Tu(n).toPromise()}const xM=800,SM=3;class Ik{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Nm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>SM)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ld._getInstance(wM()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await _M(),!this.activeServiceWorker)return;this.sender=new gM(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||vM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Nm();return await Z0(e,Uh,"1"),await eE(e,Uh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Z0(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>IM(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>eE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Vd(s,!1).getAll();return new Tu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),xM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Ik.type="LOCAL";const kM=Ik;new vu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CM(t,e){return e?yr(e):(ae(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy extends Vy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return So(e,this._buildIdpRequest())}_linkToIdToken(e,n){return So(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return So(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function AM(t){return fk(t.auth,new Fy(t),t.bypassAuthState)}function bM(t){const{auth:e,user:n}=t;return ae(n,e,"internal-error"),sM(n,new Fy(t),t.bypassAuthState)}async function RM(t){const{auth:e,user:n}=t;return ae(n,e,"internal-error"),rM(n,new Fy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xk{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return AM;case"linkViaPopup":case"linkViaRedirect":return RM;case"reauthViaPopup":case"reauthViaRedirect":return bM;default:Un(this.auth,"internal-error")}}resolve(e){Rr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Rr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PM=new vu(2e3,1e4);class ho extends xk{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ho.currentPopupAction&&ho.currentPopupAction.cancel(),ho.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ae(e,this.auth,"internal-error"),e}async onExecution(){Rr(this.filter.length===1,"Popup operations only handle one event");const e=Oy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(rr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(rr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ho.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(rr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,PM.get())};e()}}ho.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NM="pendingRedirect",Hc=new Map;class DM extends xk{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Hc.get(this.auth._key());if(!e){try{const r=await jM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Hc.set(this.auth._key(),e)}return this.bypassAuthState||Hc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function jM(t,e){const n=MM(e),r=VM(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function LM(t,e){Hc.set(t._key(),e)}function VM(t){return yr(t._redirectPersistence)}function MM(t){return $c(NM,t.config.apiKey,t.name)}async function OM(t,e,n=!1){if(on(t.app))return Promise.reject(wr(t));const r=Di(t),s=CM(r,e),o=await new DM(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FM=10*60*1e3;class UM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!BM(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Sk(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(rr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=FM&&this.cachedEventUids.clear(),this.cachedEventUids.has(tE(e))}saveEventToCache(e){this.cachedEventUids.add(tE(e)),this.lastProcessedEventTime=Date.now()}}function tE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Sk({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function BM(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Sk(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zM(t,e={}){return Lr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $M=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HM=/^https?/;async function qM(t){if(t.config.emulator)return;const{authorizedDomains:e}=await zM(t);for(const n of e)try{if(WM(n))return}catch{}Un(t,"unauthorized-domain")}function WM(t){const e=bm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!HM.test(n))return!1;if($M.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM=new vu(3e4,6e4);function nE(){const t=sr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function GM(t){return new Promise((e,n)=>{var s,i,o;function r(){nE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{nE(),n(rr(t,"network-request-failed"))},timeout:KM.get()})}if((i=(s=sr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=sr().gapi)!=null&&o.load)r();else{const a=FV("iframefcb");return sr()[a]=()=>{gapi.load?r():n(rr(t,"network-request-failed"))},lk(`${OV()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw qc=null,e})}let qc=null;function QM(t){return qc=qc||GM(t),qc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XM=new vu(5e3,15e3),YM="__/auth/iframe",JM="emulator/auth/iframe",ZM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},eO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function tO(t){const e=t.config;ae(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Dy(e,JM):`https://${t.config.authDomain}/${YM}`,r={apiKey:e.apiKey,appName:t.name,v:Ri},s=eO.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${lu(r).slice(1)}`}async function nO(t){const e=await QM(t),n=sr().gapi;return ae(n,t,"internal-error"),e.open({where:document.body,url:tO(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ZM,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=rr(t,"network-request-failed"),a=sr().setTimeout(()=>{i(o)},XM.get());function l(){sr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},sO=500,iO=600,oO="_blank",aO="http://localhost";class rE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function lO(t,e,n,r=sO,s=iO){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...rO,width:r.toString(),height:s.toString(),top:i,left:o},h=dt().toLowerCase();n&&(a=tk(h)?oO:n),Z1(h)&&(e=e||aO,l.scrollbars="yes");const d=Object.entries(l).reduce((m,[_,k])=>`${m}${_}=${k},`,"");if(bV(h)&&a!=="_self")return uO(e||"",a),new rE(null);const p=window.open(e||"",a,d);ae(p,t,"popup-blocked");try{p.focus()}catch{}return new rE(p)}function uO(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cO="__/auth/handler",hO="emulator/auth/handler",dO=encodeURIComponent("fac");async function sE(t,e,n,r,s,i){ae(t.config.authDomain,t,"auth-domain-config-required"),ae(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ri,eventId:s};if(e instanceof hk){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",vN(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,p]of Object.entries({}))o[d]=p}if(e instanceof Eu){const d=e.getScopes().filter(p=>p!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),h=l?`#${dO}=${encodeURIComponent(l)}`:"";return`${fO(t)}?${lu(a).slice(1)}${h}`}function fO({config:t}){return t.emulator?Dy(t,hO):`https://${t.authDomain}/${cO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wf="webStorageSupport";class pO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vk,this._completeRedirectFn=OM,this._overrideRedirectResult=LM}async _openPopup(e,n,r,s){var o;Rr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await sE(e,n,r,bm(),s);return lO(e,i,Oy())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await sE(e,n,r,bm(),s);return yM(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Rr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await nO(e),r=new UM(e);return n.register("authEvent",s=>(ae(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Wf,{type:Wf},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Wf];i!==void 0&&n(!!i),Un(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=qM(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return ok()||ek()||Ly()}}const mO=pO;var iE="@firebase/auth",oE="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ae(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yO(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _O(t){mi(new ws("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ae(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ak(t)},h=new LV(r,s,i,l);return qV(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),mi(new ws("auth-internal",e=>{const n=Di(e.getProvider("auth").getImmediate());return(r=>new gO(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zn(iE,oE,yO(t)),Zn(iE,oE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO=5*60,wO=mx("authIdTokenMaxAge")||vO;let aE=null;const EO=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>wO)return;const s=n==null?void 0:n.token;aE!==s&&(aE=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function TO(t=Fg()){const e=ld(t,"auth");if(e.isInitialized())return e.getImmediate();const n=HV(t,{popupRedirectResolver:mO,persistence:[kM,pM,vk]}),r=mx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=EO(i.toString());cM(n,o,()=>o(n.currentUser)),uM(n,a=>o(a))}}const s=dx("auth");return s&&WV(n,`http://${s}`),n}function IO(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}VV({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=rr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",IO().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_O("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk="firebasestorage.googleapis.com",Ck="storageBucket",xO=2*60*1e3,SO=10*60*1e3,kO=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke extends ar{constructor(e,n,r=0){super(Kf(e),`Firebase Storage: ${n} (${Kf(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ke.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Kf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ve;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ve||(Ve={}));function Kf(t){return"storage/"+t}function Uy(){const t="An unknown error occurred, please check the error payload for server response.";return new Ke(Ve.UNKNOWN,t)}function CO(t){return new Ke(Ve.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function AO(t){return new Ke(Ve.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function bO(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ke(Ve.UNAUTHENTICATED,t)}function RO(){return new Ke(Ve.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function PO(t){return new Ke(Ve.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function Ak(){return new Ke(Ve.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function bk(){return new Ke(Ve.CANCELED,"User canceled the upload/download.")}function NO(t){return new Ke(Ve.INVALID_URL,"Invalid URL '"+t+"'.")}function DO(t){return new Ke(Ve.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function jO(){return new Ke(Ve.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ck+"' property when initializing the app?")}function Rk(){return new Ke(Ve.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function LO(){return new Ke(Ve.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function VO(){return new Ke(Ve.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function MO(t){return new Ke(Ve.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Dm(t){return new Ke(Ve.INVALID_ARGUMENT,t)}function Pk(){return new Ke(Ve.APP_DELETED,"The Firebase app was deleted.")}function OO(t){return new Ke(Ve.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function yl(t,e){return new Ke(Ve.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Oa(t){throw new Ke(Ve.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=un.makeFromUrl(e,n)}catch{return new un(e,"")}if(r.path==="")return r;throw DO(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function h(N){N.path_=decodeURIComponent(N.path)}const d="v[A-Za-z0-9_]+",p=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",_=new RegExp(`^https?://${p}/${d}/b/${s}/o${m}`,"i"),k={bucket:1,path:3},A=n===kk?"(?:storage.googleapis.com|storage.cloud.google.com)":n,b="([^?#]*)",T=new RegExp(`^https?://${A}/${s}/${b}`,"i"),E=[{regex:a,indices:l,postModify:i},{regex:_,indices:k,postModify:h},{regex:T,indices:{bucket:1,path:2},postModify:h}];for(let N=0;N<E.length;N++){const j=E[N],F=j.regex.exec(e);if(F){const S=F[j.indices.bucket];let y=F[j.indices.path];y||(y=""),r=new un(S,y),j.postModify(r);break}}if(r==null)throw NO(e);return r}}class FO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UO(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let h=!1;function d(...b){h||(h=!0,e.apply(null,b))}function p(b){s=setTimeout(()=>{s=null,t(_,l())},b)}function m(){i&&clearTimeout(i)}function _(b,...T){if(h){m();return}if(b){m(),d.call(null,b,...T);return}if(l()||o){m(),d.call(null,b,...T);return}r<64&&(r*=2);let E;a===1?(a=2,E=0):E=(r+Math.random())*1e3,p(E)}let k=!1;function A(b){k||(k=!0,m(),!h&&(s!==null?(b||(a=2),clearTimeout(s),p(0)):b||(a=1)))}return p(0),i=setTimeout(()=>{o=!0,A(!0)},n),A}function BO(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zO(t){return t!==void 0}function $O(t){return typeof t=="function"}function HO(t){return typeof t=="object"&&!Array.isArray(t)}function Md(t){return typeof t=="string"||t instanceof String}function lE(t){return By()&&t instanceof Blob}function By(){return typeof Blob<"u"}function uE(t,e,n,r){if(r<e)throw Dm(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Dm(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function Nk(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var li;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(li||(li={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dk(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(e,n,r,s,i,o,a,l,h,d,p,m=!0,_=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=h,this.progressCallback_=d,this.connectionFactory_=p,this.retry=m,this.isUsingEmulator=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((k,A)=>{this.resolve_=k,this.reject_=A,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new hc(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,h=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,h)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===li.NO_ERROR,l=i.getStatus();if(!a||Dk(l,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===li.ABORT;r(!1,new hc(!1,null,d));return}const h=this.successCodes_.indexOf(l)!==-1;r(!0,new hc(h,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());zO(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=Uy();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?Pk():bk();o(l)}else{const l=Ak();o(l)}};this.canceled_?n(!1,new hc(!1,null,!0)):this.backoffId_=UO(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&BO(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class hc{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function WO(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function KO(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function GO(t,e){e&&(t["X-Firebase-GMPID"]=e)}function QO(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function XO(t,e,n,r,s,i,o=!0,a=!1){const l=Nk(t.urlParams),h=t.url+l,d=Object.assign({},t.headers);return GO(d,e),WO(d,n),KO(d,i),QO(d,r),new qO(h,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YO(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function JO(...t){const e=YO();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(By())return new Blob(t);throw new Ke(Ve.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function ZO(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e4(t){if(typeof atob>"u")throw MO("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Gf{constructor(e,n){this.data=e,this.contentType=n||null}}function t4(t,e){switch(t){case Xn.RAW:return new Gf(jk(e));case Xn.BASE64:case Xn.BASE64URL:return new Gf(Lk(t,e));case Xn.DATA_URL:return new Gf(r4(e),s4(e))}throw Uy()}function jk(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function n4(t){let e;try{e=decodeURIComponent(t)}catch{throw yl(Xn.DATA_URL,"Malformed data URL.")}return jk(e)}function Lk(t,e){switch(t){case Xn.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw yl(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Xn.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw yl(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=e4(e)}catch(s){throw s.message.includes("polyfill")?s:yl(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class Vk{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw yl(Xn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=i4(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function r4(t){const e=new Vk(t);return e.base64?Lk(Xn.BASE64,e.rest):n4(e.rest)}function s4(t){return new Vk(t).contentType}function i4(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,n){let r=0,s="";lE(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(lE(this.data_)){const r=this.data_,s=ZO(r,e,n);return s===null?null:new dr(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new dr(r,!0)}}static getBlob(...e){if(By()){const n=e.map(r=>r instanceof dr?r.data_:r);return new dr(JO.apply(null,n))}else{const n=e.map(o=>Md(o)?t4(Xn.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new dr(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mk(t){let e;try{e=JSON.parse(t)}catch{return null}return HO(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o4(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function a4(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function Ok(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l4(t,e){return e}class Ft{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||l4}}let dc=null;function u4(t){return!Md(t)||t.length<2?t:Ok(t)}function zy(){if(dc)return dc;const t=[];t.push(new Ft("bucket")),t.push(new Ft("generation")),t.push(new Ft("metageneration")),t.push(new Ft("name","fullPath",!0));function e(i,o){return u4(o)}const n=new Ft("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new Ft("size");return s.xform=r,t.push(s),t.push(new Ft("timeCreated")),t.push(new Ft("updated")),t.push(new Ft("md5Hash",null,!0)),t.push(new Ft("cacheControl",null,!0)),t.push(new Ft("contentDisposition",null,!0)),t.push(new Ft("contentEncoding",null,!0)),t.push(new Ft("contentLanguage",null,!0)),t.push(new Ft("contentType",null,!0)),t.push(new Ft("metadata","customMetadata",!0)),dc=t,dc}function c4(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new un(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function h4(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return c4(r,t),r}function Fk(t,e,n){const r=Mk(e);return r===null?null:h4(t,r,n)}function d4(t,e,n,r){const s=Mk(e);if(s===null||!Md(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(h=>{const d=t.bucket,p=t.fullPath,m="/b/"+o(d)+"/o/"+o(p),_=Iu(m,n,r),k=Nk({alt:"media",token:h});return _+k})[0]}function Uk(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class sa{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Er(t){if(!t)throw Uy()}function $y(t,e){function n(r,s){const i=Fk(t,s,e);return Er(i!==null),i}return n}function f4(t,e){function n(r,s){const i=Fk(t,s,e);return Er(i!==null),d4(i,s,t.host,t._protocol)}return n}function xu(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=RO():s=bO():n.getStatus()===402?s=AO(t.bucket):n.getStatus()===403?s=PO(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function Bk(t){const e=xu(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=CO(t.path)),i.serverResponse=s.serverResponse,i}return n}function p4(t,e,n){const r=e.fullServerUrl(),s=Iu(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new sa(s,i,$y(t,n),o);return a.errorHandler=Bk(e),a}function m4(t,e,n){const r=e.fullServerUrl(),s=Iu(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new sa(s,i,f4(t,n),o);return a.errorHandler=Bk(e),a}function g4(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function zk(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=g4(null,e)),r}function $k(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let E="";for(let N=0;N<2;N++)E=E+Math.random().toString().slice(2);return E}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const h=zk(e,r,s),d=Uk(h,n),p="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+h.contentType+`\r
\r
`,m=`\r
--`+l+"--",_=dr.getBlob(p,r,m);if(_===null)throw Rk();const k={name:h.fullPath},A=Iu(i,t.host,t._protocol),b="POST",T=t.maxUploadRetryTime,w=new sa(A,b,$y(t,n),T);return w.urlParams=k,w.headers=o,w.body=_.uploadData(),w.errorHandler=xu(e),w}class zh{constructor(e,n,r,s){this.current=e,this.total=n,this.finalized=!!r,this.metadata=s||null}}function Hy(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Er(!1)}return Er(!!n&&(e||["active"]).indexOf(n)!==-1),n}function y4(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o=zk(e,r,s),a={name:o.fullPath},l=Iu(i,t.host,t._protocol),h="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},p=Uk(o,n),m=t.maxUploadRetryTime;function _(A){Hy(A);let b;try{b=A.getResponseHeader("X-Goog-Upload-URL")}catch{Er(!1)}return Er(Md(b)),b}const k=new sa(l,h,_,m);return k.urlParams=a,k.headers=d,k.body=p,k.errorHandler=xu(e),k}function _4(t,e,n,r){const s={"X-Goog-Upload-Command":"query"};function i(h){const d=Hy(h,["active","final"]);let p=null;try{p=h.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Er(!1)}p||Er(!1);const m=Number(p);return Er(!isNaN(m)),new zh(m,r.size(),d==="final")}const o="POST",a=t.maxUploadRetryTime,l=new sa(n,o,i,a);return l.headers=s,l.errorHandler=xu(e),l}const cE=256*1024;function v4(t,e,n,r,s,i,o,a){const l=new zh(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=r.size()),r.size()!==l.total)throw LO();const h=l.total-l.current;let d=h;s>0&&(d=Math.min(d,s));const p=l.current,m=p+d;let _="";d===0?_="finalize":h===d?_="upload, finalize":_="upload";const k={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${l.current}`},A=r.slice(p,m);if(A===null)throw Rk();function b(N,j){const F=Hy(N,["active","final"]),S=l.current+d,y=r.size();let v;return F==="final"?v=$y(e,i)(N,j):v=null,new zh(S,y,F==="final",v)}const T="POST",w=e.maxUploadRetryTime,E=new sa(n,T,b,w);return E.headers=k,E.body=A.uploadData(),E.progressCallback=a||null,E.errorHandler=xu(t),E}const Qt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Qf(t){switch(t){case"running":case"pausing":case"canceling":return Qt.RUNNING;case"paused":return Qt.PAUSED;case"success":return Qt.SUCCESS;case"canceled":return Qt.CANCELED;case"error":return Qt.ERROR;default:return Qt.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{constructor(e,n,r){if($O(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ki(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class E4{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=li.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=li.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=li.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw Oa("cannot .send() more than once");if(As(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Oa("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Oa("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Oa("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Oa("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class T4 extends E4{initXhr(){this.xhr_.responseType="text"}}function Qs(){return new T4}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=zy(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(Ve.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const i=this.isExponentialBackoffExpired();if(Dk(s.status,[]))if(i)s=Ak();else{this.sleepTime=Math.max(this.sleepTime*2,kO),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(Ve.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=y4(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Qs,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const s=_4(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(s,Qs,n,r);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=cE*this._chunkMultiplier,n=new zh(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,i)=>{let o;try{o=v4(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const a=this._ref.storage._makeRequest(o,Qs,s,i,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){cE*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=p4(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,Qs,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=$k(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Qs,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=bk(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Qf(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,s){const i=new w4(n||void 0,r||void 0,s||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Qf(this._state)){case Qt.SUCCESS:Ki(this._resolve.bind(null,this.snapshot))();break;case Qt.CANCELED:case Qt.ERROR:const n=this._reject;Ki(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Qf(this._state)){case Qt.RUNNING:case Qt.PAUSED:e.next&&Ki(e.next.bind(e,this.snapshot))();break;case Qt.SUCCESS:e.complete&&Ki(e.complete.bind(e))();break;case Qt.CANCELED:case Qt.ERROR:e.error&&Ki(e.error.bind(e,this._error))();break;default:e.error&&Ki(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e,n){this._service=e,n instanceof un?this._location=n:this._location=un.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ki(e,n)}get root(){const e=new un(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Ok(this._location.path)}get storage(){return this._service}get parent(){const e=o4(this._location.path);if(e===null)return null;const n=new un(this._location.bucket,e);return new ki(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw OO(e)}}function x4(t,e,n){t._throwIfRoot("uploadBytes");const r=$k(t.storage,t._location,zy(),new dr(e,!0),n);return t.storage.makeRequestWithTokens(r,Qs).then(s=>({metadata:s,ref:t}))}function S4(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new I4(t,new dr(e),n)}function k4(t){t._throwIfRoot("getDownloadURL");const e=m4(t.storage,t._location,zy());return t.storage.makeRequestWithTokens(e,Qs).then(n=>{if(n===null)throw VO();return n})}function C4(t,e){const n=a4(t._location.path,e),r=new un(t._location.bucket,n);return new ki(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A4(t){return/^[A-Za-z]+:\/\//.test(t)}function b4(t,e){return new ki(t,e)}function Hk(t,e){if(t instanceof qy){const n=t;if(n._bucket==null)throw jO();const r=new ki(n,n._bucket);return e!=null?Hk(r,e):r}else return e!==void 0?C4(t,e):t}function R4(t,e){if(e&&A4(e)){if(t instanceof qy)return b4(t,e);throw Dm("To use ref(service, url), the first argument must be a Storage instance.")}else return Hk(t,e)}function hE(t,e){const n=e==null?void 0:e[Ck];return n==null?null:un.makeFromBucketSpec(n,t)}function P4(t,e,n,r={}){t.host=`${e}:${n}`;const s=As(e);s&&(Lg(`https://${t.host}/b`),Vg("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:gx(i,t.app.options.projectId))}class qy{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=kk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=xO,this._maxUploadRetryTime=SO,this._requests=new Set,s!=null?this._bucket=un.makeFromBucketSpec(s,this._host):this._bucket=hE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=un.makeFromBucketSpec(this._url,e):this._bucket=hE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){uE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){uE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(on(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ki(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new FO(Pk());{const o=XO(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const dE="@firebase/storage",fE="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qk="storage";function N4(t,e,n){return t=We(t),x4(t,e,n)}function D4(t,e,n){return t=We(t),S4(t,e,n)}function pE(t){return t=We(t),k4(t)}function mE(t,e){return t=We(t),R4(t,e)}function j4(t=Fg(),e){t=We(t);const r=ld(t,qk).getImmediate({identifier:e}),s=fx("storage");return s&&L4(r,...s),r}function L4(t,e,n,r={}){P4(t,e,n,r)}function V4(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new qy(n,r,s,e,Ri)}function M4(){mi(new ws(qk,V4,"PUBLIC").setMultipleInstances(!0)),Zn(dE,fE,""),Zn(dE,fE,"esm2020")}M4();var O4="firebase",F4="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zn(O4,F4,"app");const U4={apiKey:"AIzaSyAlMyf_NFJ8xrQLt24EhxAzWZTnQbPr6aQ",authDomain:"desksetup-web.firebaseapp.com",projectId:"desksetup-web",storageBucket:"desksetup-web.firebasestorage.app",messagingSenderId:"540303783708",appId:"1:540303783708:web:ef169c5fb08b7d9a822cd9",measurementId:"G-N1ZDZ3JWF0"},Wy=Ix(U4),ko=TO(Wy),ut=KL(Wy);GL(ut).catch(t=>{t.code==="failed-precondition"?console.warn("Firestore persistence disabled: Multiple tabs open"):t.code==="unimplemented"&&console.warn("Firestore persistence disabled: Browser not supported")});const gE=j4(Wy);new hr;const B4=[],Xa=[],Ya={colorTone:[{value:"warm",label:"Tng Mu m",description:"G, be, nh sng du"},{value:"cool",label:"Tng Mu Lnh",description:"Trng, xm, nh sng xanh"},{value:"neutral",label:"Trung Tnh / Ti Gin",description:"Sch s v n gin"}],budget:[{value:"budget",label:"Tit Kim",description:"Di 10 triu"},{value:"mid-range",label:"Tm Trung",description:"10 - 50 triu"},{value:"premium",label:"Cao Cp",description:"Trn 50 triu"}],gender:[{value:"masculine",label:"Nam Tnh",description:"Mnh m v c tnh"},{value:"feminine",label:"N Tnh",description:"Nh nhng v thanh lch"},{value:"neutral",label:"Trung Tnh",description:"Ph hp mi ngi"}],purpose:[{value:"work-from-home",label:"Lm Vic Ti Nh",description:"Lm vic t xa chuyn nghip"},{value:"gaming",label:"Gaming",description:"Chi game v gii tr"},{value:"creative",label:"Sng To / Thit K",description:"Cng vic sng to"},{value:"productivity",label:"Nng Sut",description:"Hiu qu ti a"}],size:[{value:"small",label:"Khng Gian Nh",description:"Setup nh gn"},{value:"medium",label:"Trung Bnh",description:"Kch thc bn tiu chun"},{value:"large",label:"Ln / Studio",description:"Setup rng ri"}]},yE=yu(ut,"setups"),_E=yu(ut,"blogs");yu(ut,"users");const z4=yu(ut,"comments"),$4=yu(ut,"newsletter"),Xs=["admin@deskhub.com","thanhdat.rces@gmail.com"],yt={getData:async()=>{try{const t=L0(yE,V0("createdAt","desc"),M0(50)),n=(await U0(t)).docs.map(a=>({id:a.id,...a.data()})),r=L0(_E,V0("createdAt","desc"),M0(20)),i=(await U0(r)).docs.map(a=>({id:a.id,...a.data()}));return{setups:n,blogs:i,comments:{}}}catch(t){return console.error("Error getting data (using fallback):",t),{setups:B4,blogs:Xa,comments:{}}}},login:async(t,e)=>{try{const n=t.includes("@")?t:`${t}@deskhub.com`,s=(await aM(ko,n,e)).user;let i={};try{const o=await Bc(Gt(ut,"users",s.uid));o.exists()&&(i=o.data()),(Xs.includes(s.email)||Xs.includes(n))&&i.role!=="admin"&&(console.log(`Auto-promoting ${s.email} to Admin`),await Kr(Gt(ut,"users",s.uid),{role:"admin"}),i.role="admin")}catch(o){console.warn("Firestore access failed (offline?):",o),(Xs.includes(s.email)||Xs.includes(n))&&(i.role="admin")}return{id:s.uid,email:s.email,displayName:s.displayName||i.displayName||t,photoURL:s.photoURL||i.avatar,role:i.role||"user"}}catch(n){throw console.error(n),n}},register:async t=>{try{const{email:e,password:n,username:r,displayName:s}=t,o=(await oM(ko,e,n)).user;await mk(o,{displayName:s});const a={username:r,displayName:s,email:e,role:Xs.includes(e)?"admin":"user",avatar:`https://ui-avatars.com/api/?name=${s}`,createdAt:new Date().toISOString()};return await aV(Gt(ut,"users",o.uid),a),{success:!0,user:{id:o.uid,...a}}}catch(e){throw console.error(e),e}},logout:async()=>{await hM(ko)},toggleLike:async(t,e)=>{try{const n=Gt(ut,"setups",t),r=await Bc(n);if(r.exists()){const i=r.data().likes||[],o=i.some(l=>l.userId===e||l===e);let a;return o?a=i.filter(l=>l.userId!==e&&l!==e):a=[...i,{userId:e,timestamp:new Date().toISOString()}],await Kr(n,{likes:a}),{success:!0,likes:a}}}catch(n){console.error(n)}return{success:!1}},toggleSave:async(t,e)=>{try{const n=Gt(ut,"setups",t),r=await Bc(n);if(r.exists()){const i=r.data().saves||[],o=i.some(l=>l.userId===e||l===e);let a;return o?a=i.filter(l=>l.userId!==e&&l!==e):a=[...i,{userId:e,timestamp:new Date().toISOString()}],await Kr(n,{saves:a}),{success:!0,saves:a}}}catch(n){console.error(n)}return{success:!1}},addComment:async(t,e)=>{try{const n={setupId:t,text:e.text,author:e.author,userId:e.userId,avatar:e.avatar,timestamp:new Date().toISOString()},r=await uc(z4,n),s=Gt(ut,"setups",t);return await Kr(s,{comments:z0(1)}),{id:r.id,...n}}catch(n){throw console.error(n),n}},addSetup:async t=>{try{if(console.log(" addSetup called with data:",t),!t.title||!t.caption)throw new Error("Missing required fields: title or caption");const e={...t,likes:[],saves:[],comments:0,createdAt:new Date().toISOString()};console.log(" Calling addDoc with data:",JSON.stringify(e,null,2));const n=await uc(yE,e);return console.log(" Setup added successfully with ID:",n.id),{success:!0,setup:{id:n.id,...e}}}catch(e){return console.error(" addSetup FAILED:",e),console.error("Error code:",e.code),console.error("Error message:",e.message),console.error("Full error:",JSON.stringify(e,null,2)),e.code==="permission-denied"?{success:!1,message:"Permission denied. Check Firestore Security Rules."}:e.code==="unavailable"?{success:!1,message:"Network error. Check your internet connection."}:{success:!1,message:e.message||"Unknown error occurred"}}},deleteSetup:async t=>{try{return await B0(Gt(ut,"setups",t)),{success:!0}}catch(e){return{success:!1,message:e.message}}},updateSetup:async(t,e)=>{try{const n=Gt(ut,"setups",t);return await Kr(n,e),{success:!0,setup:{id:t,...e}}}catch(n){return{success:!1,message:n.message}}},addBlog:async t=>{try{if(console.log(" addBlog called with data:",t),!t.title||!t.excerpt||!t.content)throw new Error("Missing required fields: title, excerpt, or content");const e={...t,views:0,publishedAt:new Date().toISOString()};console.log(" Calling addDoc with data:",JSON.stringify(e,null,2));const n=await uc(_E,e);return console.log(" Blog added successfully with ID:",n.id),{...e,id:n.id}}catch(e){throw console.error(" addBlog FAILED:",e),console.error("Error code:",e.code),console.error("Error message:",e.message),e.code==="permission-denied"?new Error("Permission denied. Check Firestore Security Rules."):e}},subscribeNewsletter:async t=>{try{return await uc($4,{...t,timestamp:new Date().toISOString()}),{success:!0}}catch(e){return console.error(e),{success:!1}}},incrementBlogView:async t=>{try{const e=Gt(ut,"blogs",t);return await Kr(e,{views:z0(1)}),{success:!0}}catch{return{success:!1}}},deleteBlog:async t=>{try{return await B0(Gt(ut,"blogs",t)),{success:!0}}catch(e){return console.error(e),{success:!1}}},updateBlog:async(t,e)=>{try{const n=Gt(ut,"blogs",t);return await Kr(n,e),{success:!0,blog:{id:t,...e}}}catch{return{success:!1}}},_imgbbApiKey:"2a4945145b81f0e070078eeb4571403c",uploadFile:async t=>{var e;try{console.log(` Starting ImgBB upload for ${t.name}`);const r=await(a=>new Promise((l,h)=>{const d=new FileReader;d.readAsDataURL(a),d.onload=()=>{const p=d.result.split(",")[1];l(p)},d.onerror=h}))(t),s=new FormData;s.append("key",yt._imgbbApiKey),s.append("image",r),s.append("name",`desk_${Date.now()}`);const o=await(await fetch("https://api.imgbb.com/1/upload",{method:"POST",body:s})).json();if(o.success)return console.log(` ImgBB upload success: ${o.data.url}`),o.data.url;throw new Error(((e=o.error)==null?void 0:e.message)||"ImgBB upload failed")}catch(n){console.error("ImgBB upload failed:",n),console.log(" Trying Firebase Storage fallback...");try{const r=mE(gE,`uploads/${Date.now()}_${t.name}`),s={contentType:t.type},i=await N4(r,t,s);return await pE(i.ref)}catch(r){throw console.error("Firebase Storage fallback also failed:",r),new Error(`Upload tht bi: ${n.message}`)}}},uploadVideo:async(t,e)=>new Promise((n,r)=>{const s=mE(gE,`videos/${Date.now()}_${t.name}`),i={contentType:t.type},o=D4(s,t,i);o.on("state_changed",a=>{const l=a.bytesTransferred/a.totalBytes*100;e&&e(l)},a=>{console.error("Video upload failed:",a),a.code==="storage/unauthorized"?r(new Error("Khng c quyn ti ln video (Li Storage Rules)")):a.code==="storage/canceled"?r(new Error(" hy ti ln")):r(a)},async()=>{try{const a=await pE(o.snapshot.ref);n(a)}catch(a){r(a)}})})},Wk=P.createContext(),Xf="deskhub_cache_setups",vE="deskhub_cache_blogs",Kk="deskhub_cache_timestamp",H4=5*60*1e3,q4=()=>{try{const t=localStorage.getItem(Kk);return t&&Date.now()-parseInt(t)<H4}catch{return!1}},Mt=()=>{const t=P.useContext(Wk);if(!t)throw new Error("useApp must be used within AppProvider");return t},W4=({children:t})=>{const[e,n]=P.useState("light"),[r,s]=P.useState(()=>{try{const q=localStorage.getItem(Xf);if(q){const Z=JSON.parse(q);if(Z&&Z.length>0)return console.log(" Instant load:",Z.length,"setups from cache"),Z}}catch(q){console.warn("Cache parse error:",q)}return[]}),[i,o]=P.useState(()=>{try{const q=localStorage.getItem(vE);if(q){const Z=JSON.parse(q);if(Z&&Z.length>0)return Z}}catch(q){console.warn("Cache parse error:",q)}return[]}),[a,l]=P.useState(null),[h,d]=P.useState(!0),p=async()=>{let q=!1;try{const ee=localStorage.getItem(Xf);if(ee){const ue=JSON.parse(ee);q=ue&&ue.length>0}}catch{}const Z=q4();if(q&&Z){console.log(" Cache is fresh with data, skipping network"),d(!1);return}console.log(" Fetching data from Firestore...",{hasData:q,cacheFresh:Z});try{const ee=await yt.getData();if(ee.setups&&ee.setups.length>0){console.log(" Loaded",ee.setups.length,"setups from Firestore"),s(ee.setups);try{localStorage.setItem(Xf,JSON.stringify(ee.setups))}catch(ue){console.warn("Cache storage failed:",ue)}}if(ee.blogs&&ee.blogs.length>0){o(ee.blogs);try{localStorage.setItem(vE,JSON.stringify(ee.blogs))}catch(ue){console.warn("Cache storage failed:",ue)}}localStorage.setItem(Kk,Date.now().toString()),ot(ee.comments||{})}catch(ee){console.error(" Error loading data from Firestore:",ee)}finally{d(!1)}},[m,_]=P.useState({colorTone:[],budget:[],gender:[],purpose:[],size:[],search:""}),[k,A]=P.useState("gallery"),[b,T]=P.useState(null),[w,E]=P.useState(null),[N,j]=P.useState(!1),[F,S]=P.useState(!1),[y,v]=P.useState(!1),[C,R]=P.useState(!1),[D,x]=P.useState(!1),[le,me]=P.useState(!1),[et,ot]=P.useState({});P.useEffect(()=>{p(),K();const q=ko.onAuthStateChanged(async Z=>{var ee;if(Z){const ue=Xs.includes(Z.email),ce={id:Z.uid,email:Z.email,displayName:Z.displayName||((ee=Z.email)==null?void 0:ee.split("@")[0]),photoURL:Z.photoURL,role:ue?"admin":"user"};l(ce);try{const mt=Gt(ut,"users",Z.uid);Bc(mt).then(Tt=>{if(Tt.exists()){const bn=Tt.data(),ia=Xs.includes(Z.email);l(Li=>({...Li,displayName:bn.displayName||Li.displayName,photoURL:bn.avatar||Li.photoURL,role:ia?"admin":bn.role||Li.role}))}}).catch(Tt=>console.warn("Background user fetch failed:",Tt))}catch(mt){console.warn("Failed to initiate user fetch:",mt)}}else l(null)});return()=>q()},[]);const K=()=>{const q=localStorage.getItem("deskhub_theme")||"light";n(q),document.documentElement.setAttribute("data-theme",q)},Me={refreshData:p,theme:e,toggleTheme:()=>{const q=e==="light"?"dark":"light";n(q),localStorage.setItem("deskhub_theme",q),document.documentElement.setAttribute("data-theme",q)},setups:r,loading:h,blogs:i,currentUser:a,refreshUser:()=>{a&&!a.isGuest||l(Na())},filters:m,setFilters:_,currentView:k,setCurrentView:A,selectedSetup:b,setSelectedSetup:T,selectedBlog:w,setSelectedBlog:E,showAuthModal:N,setShowAuthModal:j,showProfileModal:F,setShowProfileModal:S,showNewsletterModal:y,setShowNewsletterModal:v,showCollectionsModal:C,setShowCollectionsModal:R,showAddSetupModal:D,setShowAddSetupModal:x,showMobileFilter:le,setShowMobileFilter:me,getFilteredSetups:()=>r.filter(q=>{if(m.search){const ee=m.search.toLowerCase();if(!(q.title.toLowerCase().includes(ee)||q.caption.toLowerCase().includes(ee)||q.tags.some(ce=>ce.toLowerCase().includes(ee))))return!1}const Z=["colorTone","budget","gender","purpose","size"];for(const ee of Z)if(m[ee].length>0&&!m[ee].includes(q.filters[ee]))return!1;return!0}),toggleLike:async q=>{if(!a){j(!0);return}const Z=a,ee=await yt.toggleLike(q,Z.id);ee.success&&s(ue=>ue.map(ce=>ce.id===q?{...ce,likes:ee.likes}:ce))},toggleSave:async q=>{if(!a){j(!0);return}const Z=a,ee=await yt.toggleSave(q,Z.id);ee.success&&s(ue=>ue.map(ce=>ce.id===q?{...ce,saves:ee.saves}:ce))},hasUserLiked:q=>{const Z=a||Na();if(!Z)return!1;const ee=r.find(ce=>ce.id===q);return ee?(ee.likes||[]).some(ce=>ce.userId===Z.id||ce===Z.id):!1},hasUserSaved:q=>{const Z=a||Na();if(!Z)return!1;const ee=r.find(ce=>ce.id===q);return ee?(ee.saves||[]).some(ce=>ce.userId===Z.id||ce===Z.id):!1},getSavedSetups:()=>{const q=a||Na();return q?r.filter(Z=>(Z.saves||[]).some(ue=>ue.userId===q.id||ue===q.id)):[]},addComment:async(q,Z,ee)=>{const ue=a||Na(),ce={text:Z,author:ee||ue.displayName,avatar:ue.avatar,userId:ue.id},mt=await yt.addComment(q,ce);ot(Tt=>({...Tt,[q]:[...Tt[q]||[],mt]})),s(Tt=>Tt.map(bn=>bn.id===q?{...bn,comments:(bn.comments||0)+1}:bn))},getComments:q=>et[q]||[],subscribeNewsletter:async q=>{const Z={email:q.email,name:q.name||"Khch"};return await yt.subscribeNewsletter(Z)},addBlog:async q=>{if(console.log(" AppContext.addBlog called"),(a==null?void 0:a.role)!=="admin")return console.warn(" Non-admin user attempted to add blog"),{success:!1,message:"Ch Admin mi c th vit blog!"};const Z=a,ee=Z.displayName||Z.email||"Admin",ue=Z.photoURL||Z.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(ee)}&background=random`,ce={...q,author:{name:ee,avatar:ue}};console.log(" Blog data prepared:",ce);const mt=await yt.addBlog(ce);return o([mt,...i]),{success:!0,blog:mt}},updateBlog:async(q,Z)=>{if((a==null?void 0:a.role)!=="admin")return{success:!1,message:"Ch Admin mi c th chnh sa blog!"};const ee=await yt.updateBlog(q,Z);return ee.success?(o(ue=>ue.map(ce=>ce.id===q?ee.blog:ce)),{success:!0,blog:ee.blog}):{success:!1,message:"Cp nht tht bi"}},deleteBlog:async q=>(a==null?void 0:a.role)!=="admin"?{success:!1,message:"Ch Admin mi c th xa blog!"}:(await yt.deleteBlog(q)).success?(o(ee=>ee.filter(ue=>ue.id!==q)),{success:!0}):{success:!1,message:"Xa tht bi"},addSetup:async q=>{if(console.log(" AppContext.addSetup called"),(a==null?void 0:a.role)!=="admin")return console.warn(" Non-admin user attempted to add setup"),{success:!1,message:"Ch Admin mi c th thm setup!"};const Z=a;console.log(" Current user:",{id:Z.id,displayName:Z.displayName,role:Z.role});const ee=Z.photoURL||Z.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(Z.displayName||"User")}`,ue={...q,author:{name:Z.displayName||Z.email||"Anonymous",avatar:ee}};console.log(" Calling api.addSetup with setupToSave:",ue);const ce=await yt.addSetup(ue);return console.log(" api.addSetup response:",ce),ce.success?(s(mt=>[ce.setup,...mt]),{success:!0,setup:ce.setup}):{success:!1,message:ce.message||"Thm setup tht bi"}},updateSetup:async(q,Z)=>{if((a==null?void 0:a.role)!=="admin")return{success:!1,message:"Ch Admin mi c th sa setup!"};const ee=await yt.updateSetup(q,Z);return ee.success?(s(ue=>ue.map(ce=>ce.id===q?ee.setup:ce)),{success:!0,setup:ee.setup}):{success:!1,message:"Cp nht tht bi"}},deleteSetup:async q=>(a==null?void 0:a.role)!=="admin"?{success:!1,message:"Ch Admin mi c th xa setup!"}:(await yt.deleteSetup(q)).success?(s(ee=>ee.filter(ue=>ue.id!==q)),{success:!0}):{success:!1,message:"Xa tht bi"},logout:async()=>{await yt.logout()},getSimilarSetups:(q,Z=4)=>{const ee=r.find(ue=>ue.id===q);return ee?r.filter(ue=>ue.id!==q).map(ue=>{let ce=0;Object.keys(ee.filters).forEach(Tt=>{ue.filters[Tt]===ee.filters[Tt]&&(ce+=1)});const mt=ue.tags.filter(Tt=>ee.tags.includes(Tt)).length;return ce+=mt*.5,{...ue,similarityScore:ce}}).sort((ue,ce)=>ce.similarityScore-ue.similarityScore).slice(0,Z):[]},setBlogs:o};return c.jsx(Wk.Provider,{value:Me,children:t})},K4=()=>{const{theme:t,toggleTheme:e,filters:n,setFilters:r,currentUser:s,setShowAuthModal:i,setShowProfileModal:o,setShowNewsletterModal:a,setShowCollectionsModal:l,setShowAddSetupModal:h,setShowMobileFilter:d}=Mt(),[p,m]=P.useState(!1),[_,k]=P.useState(!1),[A,b]=P.useState(!1),T=iu(),w=Nr(),E=w.pathname==="/"||w.pathname==="/gallery",N=y=>{r({...n,search:y.target.value}),w.pathname!=="/"&&w.pathname!=="/gallery"&&T("/")},j=()=>b(!1),S=Object.keys(n).reduce((y,v)=>v==="search"?y:y+n[v].length,0);return c.jsxs("header",{className:"header",children:[c.jsxs("div",{className:"container header-container",children:[c.jsxs(gn,{to:"/",className:"header-logo",onClick:j,children:[c.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",children:[c.jsx("rect",{width:"32",height:"32",rx:"8",fill:"url(#logo-gradient)"}),c.jsx("path",{d:"M8 12h16M8 16h16M8 20h12",stroke:"white",strokeWidth:"2",strokeLinecap:"round"}),c.jsx("defs",{children:c.jsxs("linearGradient",{id:"logo-gradient",x1:"0",y1:"0",x2:"32",y2:"32",children:[c.jsx("stop",{offset:"0%",stopColor:"hsl(220, 90%, 56%)"}),c.jsx("stop",{offset:"100%",stopColor:"hsl(280, 70%, 60%)"})]})})]}),c.jsx("span",{className:"header-logo-text",children:"DeskHub"})]}),c.jsxs("nav",{className:"header-nav desktop-only",children:[c.jsx(gn,{to:"/",className:`nav-link ${w.pathname==="/"||w.pathname==="/gallery"?"active":""}`,children:"B Su Tp"}),c.jsx(gn,{to:"/blog",className:`nav-link ${w.pathname.startsWith("/blog")?"active":""}`,children:"Blog"})]}),c.jsxs("div",{className:"header-actions",children:[(s==null?void 0:s.role)==="admin"&&c.jsxs("div",{className:"desktop-only",style:{display:"flex",alignItems:"center"},children:[c.jsx(gn,{to:"/blog/new",className:"btn",style:{padding:"0.5rem 1rem",fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem",backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)",marginRight:"0.5rem",textDecoration:"none",borderRadius:"8px"},children:" Blog"}),c.jsxs("button",{className:"btn btn-primary",style:{padding:"0.5rem 1rem",fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem"},onClick:()=>h(!0),children:[c.jsx("span",{children:"+"})," ng Gc"]})]}),c.jsxs("div",{className:`search-container ${p?"expanded":""}`,children:[c.jsx("input",{type:"text",className:"search-input",placeholder:"Tm kim...",value:n.search,onChange:N,onFocus:()=>m(!0),onBlur:()=>!n.search&&m(!1)}),c.jsx("svg",{className:"search-icon",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:c.jsx("path",{d:"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16zM19 19l-4.35-4.35",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})]}),E&&c.jsxs("button",{className:"btn-icon mobile-filter-btn mobile-only",onClick:()=>d(!0),title:"B lc",children:[c.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),S>0&&c.jsx("span",{className:"filter-badge",children:S})]}),c.jsx("button",{className:"btn-icon mobile-menu-toggle mobile-only",onClick:()=>b(!0),children:s?c.jsx("img",{src:s.avatar||`https://ui-avatars.com/api/?name=${s.displayName}`,alt:"",className:"mobile-avatar-btn"}):c.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),c.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),c.jsx("button",{className:"btn btn-icon desktop-only",onClick:()=>l(!0),title:"Setup  lu",children:c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:c.jsx("path",{d:"M5 3h10a2 2 0 012 2v14l-7-4-7 4V5a2 2 0 012-2z",stroke:"currentColor",strokeWidth:"2"})})}),c.jsx("button",{className:"btn btn-icon theme-toggle desktop-only",onClick:e,title:"i theme",children:t==="light"?c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[c.jsx("path",{d:"M10 3V1M10 19v-2M17 10h2M1 10h2M15.657 4.343l1.414-1.414M3.343 16.657l1.414-1.414M15.657 15.657l1.414 1.414M3.343 3.343l1.414 1.414",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),c.jsx("circle",{cx:"10",cy:"10",r:"4",stroke:"currentColor",strokeWidth:"2"})]}):c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})})}),c.jsxs("div",{className:"user-menu-container desktop-only",children:[c.jsx("button",{className:"user-avatar-btn",onClick:()=>k(!_),children:c.jsx("img",{src:(s==null?void 0:s.avatar)||`https://ui-avatars.com/api/?name=${(s==null?void 0:s.displayName)||"Guest"}`,alt:""})}),_&&c.jsxs("div",{className:"user-menu",children:[c.jsxs("div",{className:"user-menu-header",children:[c.jsx("img",{src:(s==null?void 0:s.avatar)||`https://ui-avatars.com/api/?name=${(s==null?void 0:s.displayName)||"Guest"}`,alt:""}),c.jsxs("div",{children:[c.jsx("p",{className:"user-menu-name",children:(s==null?void 0:s.displayName)||"Khch"}),c.jsx("p",{className:"user-menu-role",children:s?s.role==="admin"?"Qun tr vin":"Thnh vin":"Cha ng nhp"})]})]}),c.jsxs("div",{className:"user-menu-items",children:[c.jsxs("button",{onClick:()=>{o(!0),k(!1)},children:[c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 20 20",fill:"none",children:c.jsx("path",{d:"M10 10a4 4 0 100-8 4 4 0 000 8zM3 18a7 7 0 0114 0",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),"H S"]}),(s==null?void 0:s.role)==="admin"&&c.jsxs(gn,{to:"/admin",onClick:()=>k(!1),style:{display:"flex",alignItems:"center",gap:"0.75rem",width:"100%",textAlign:"left",padding:"0.75rem 1rem",color:"var(--color-text-primary)",textDecoration:"none",fontSize:"0.95rem",background:"none",border:"none",cursor:"pointer"},onMouseEnter:y=>y.target.style.background="var(--color-surface-hover)",onMouseLeave:y=>y.target.style.background="transparent",children:[c.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 20 20",fill:"none",children:[c.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1",stroke:"currentColor",strokeWidth:"2"}),c.jsx("rect",{x:"11",y:"3",width:"6",height:"6",rx:"1",stroke:"currentColor",strokeWidth:"2"}),c.jsx("rect",{x:"3",y:"11",width:"6",height:"6",rx:"1",stroke:"currentColor",strokeWidth:"2"}),c.jsx("rect",{x:"11",y:"11",width:"6",height:"6",rx:"1",stroke:"currentColor",strokeWidth:"2"})]}),"Dashboard"]}),c.jsxs("button",{onClick:()=>{l(!0),k(!1)},children:[c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 20 20",fill:"none",children:c.jsx("path",{d:"M5 3h10a2 2 0 012 2v14l-7-4-7 4V5a2 2 0 012-2z",stroke:"currentColor",strokeWidth:"2"})}),"Setup  Lu"]}),!s&&c.jsxs("button",{onClick:()=>{i(!0),k(!1)},children:[c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 20 20",fill:"none",children:c.jsx("path",{d:"M10 3v14M3 10h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),"ng Nhp / ng K"]})]})]})]})]})]}),_&&c.jsx("div",{className:"user-menu-overlay",onClick:()=>k(!1)}),c.jsxs(c.Fragment,{children:[c.jsx("div",{className:`mobile-menu-backdrop ${A?"open":""}`,onClick:()=>b(!1)}),c.jsxs("div",{className:`mobile-menu-drawer ${A?"open":""}`,children:[c.jsxs("div",{className:"mobile-menu-header",children:[c.jsx("h3",{children:"Menu"}),c.jsx("button",{className:"mobile-close-btn",onClick:()=>b(!1),children:c.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),c.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),s&&c.jsxs("div",{className:"mobile-user-profile",onClick:()=>{o(!0),j()},children:[c.jsx("img",{src:s.avatar,alt:"Avatar"}),c.jsxs("div",{children:[c.jsx("p",{className:"name",children:s.displayName}),c.jsx("p",{className:"role",children:s.role==="admin"?"Admin":"Member"})]})]}),c.jsxs("div",{className:"mobile-nav-links",children:[c.jsx(gn,{to:"/",className:`mobile-nav-item ${w.pathname==="/"?"active":""}`,onClick:j,children:"Trang Ch"}),c.jsx(gn,{to:"/blog",className:`mobile-nav-item ${w.pathname.startsWith("/blog")?"active":""}`,onClick:j,children:"Blog"}),(s==null?void 0:s.role)==="admin"&&c.jsx(gn,{to:"/admin",className:"mobile-nav-item",onClick:j,children:"Qun L (Admin)"})]}),c.jsxs("div",{className:"mobile-actions",children:[c.jsx("button",{className:"mobile-action-btn",onClick:()=>{l(!0),j()},children:"Setup  Lu"}),(s==null?void 0:s.role)==="admin"&&c.jsx("button",{className:"mobile-action-btn primary",onClick:()=>{h(!0),j()},children:"+ ng Setup"}),!s&&c.jsx("button",{className:"mobile-action-btn primary",onClick:()=>{i(!0),j()},children:"ng Nhp"}),c.jsx("button",{className:"mobile-action-btn",onClick:e,children:t==="light"?"Ch  Ti":"Ch  Sng"})]})]})]})]})},Gk=()=>{const{filters:t,setFilters:e,showMobileFilter:n,setShowMobileFilter:r}=Mt(),[s,i]=P.useState(!1),o=(p,m)=>{const _=t[p],k=_.includes(m)?_.filter(A=>A!==m):[..._,m];e({...t,[p]:k})},a=()=>{e({colorTone:[],budget:[],gender:[],purpose:[],size:[],search:""})},h=Object.keys(t).reduce((p,m)=>m==="search"?p:p+t[m].length,0),d=n;return c.jsxs(c.Fragment,{children:[d&&c.jsx("div",{className:"filter-backdrop mobile-only",onClick:()=>r(!1)}),c.jsx("aside",{className:`filter-sidebar ${s?"collapsed":""} ${d?"mobile-open":""}`,children:c.jsxs("div",{className:"sidebar-content",children:[c.jsxs("div",{className:"sidebar-header",children:[c.jsx("button",{className:"sidebar-toggle desktop-only",onClick:()=>i(!s),title:s?"Hin b lc":"n b lc",children:c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:c.jsx("path",{d:"M3 6h14M3 10h14M3 14h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),c.jsx("button",{className:"sidebar-close mobile-only",onClick:()=>r(!1),children:c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),c.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),c.jsxs("h3",{className:"sidebar-title",children:["B Lc",h>0&&c.jsx("span",{className:"filter-count",children:h})]}),h>0&&c.jsx("button",{className:"btn-clear-all",onClick:a,children:"Xa tt c"})]}),c.jsx("div",{className:"filter-groups",children:Object.entries(Ya).map(([p,m])=>c.jsx(G4,{category:p,options:m,selectedValues:t[p],onToggle:o},p))})]})})]})},G4=({category:t,options:e,selectedValues:n,onToggle:r})=>{const[s,i]=P.useState(!0),o={colorTone:"Tng Mu",budget:"Ngn Sch",gender:"Phong Cch",purpose:"Mc ch",size:"Kch Thc"};return c.jsxs("div",{className:"filter-group",children:[c.jsxs("button",{className:"filter-group-header",onClick:()=>i(!s),children:[c.jsx("span",{className:"filter-group-title",children:o[t]}),c.jsx("svg",{className:`expand-icon ${s?"expanded":""}`,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:c.jsx("path",{d:"M4 6l4 4 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})]}),s&&c.jsx("div",{className:"filter-options",children:e.map(a=>c.jsxs("label",{className:"filter-option",children:[c.jsx("input",{type:"checkbox",checked:n.includes(a.value),onChange:()=>r(t,a.value),className:"filter-checkbox"}),c.jsxs("span",{className:"filter-option-content",children:[c.jsx("span",{className:"filter-option-label",children:a.label}),c.jsx("span",{className:"filter-option-description",children:a.description})]})]},a.value))})]})},Q4=({setup:t,index:e})=>{var S,y;const{toggleLike:n,toggleSave:r,hasUserLiked:s,hasUserSaved:i}=Mt(),[o,a]=P.useState(!1),[l,h]=P.useState(!1),d=P.useRef(null),[p,m]=P.useState(!1),[_,k]=P.useState(!1),A=s(t.id),b=i(t.id),T=v=>{v.preventDefault(),v.stopPropagation(),n(t.id),k(!1)},w=v=>{v.preventDefault(),v.stopPropagation(),r(t.id),k(!1)},E=v=>{v.preventDefault(),v.stopPropagation();const C=`${window.location.origin}/setup/${t.id}`;navigator.share?navigator.share({title:t.title,text:t.caption,url:C}):(navigator.clipboard.writeText(C),alert(" copy link!")),k(!1)},N=v=>{v.preventDefault(),v.stopPropagation(),_||document.querySelectorAll(".setup-card").forEach(R=>{R.dispatchEvent(new CustomEvent("closeOtherMenus",{detail:{exceptId:t.id}}))}),k(!_)};zt.useEffect(()=>{const v=document.querySelector(`[data-setup-id="${t.id}"]`);if(v){const C=R=>{R.detail.exceptId!==t.id&&k(!1)};return v.addEventListener("closeOtherMenus",C),()=>v.removeEventListener("closeOtherMenus",C)}},[t.id]),zt.useEffect(()=>{if(_){const v=R=>{!R.target.closest(".mobile-menu-popup")&&!R.target.closest(".mobile-menu-btn")&&k(!1)},C=()=>{k(!1)};return document.addEventListener("click",v),window.addEventListener("scroll",C,{passive:!0}),()=>{document.removeEventListener("click",v),window.removeEventListener("scroll",C)}}},[_]);const j=()=>{if(t.thumbnailVideo&&d.current){const v=d.current.play();v!==void 0&&v.then(()=>m(!0)).catch(()=>{})}},F=()=>{t.thumbnailVideo&&d.current&&(d.current.pause(),d.current.currentTime=0,m(!1))};return c.jsxs(c.Fragment,{children:[c.jsx(gn,{to:`/setup/${t.id}`,className:"setup-card","data-setup-id":t.id,onMouseEnter:j,onMouseLeave:F,children:c.jsxs("div",{className:"setup-card-image-container",children:[t.thumbnailVideo&&c.jsx("video",{ref:d,className:"setup-card-image",muted:!0,loop:!0,playsInline:!0,style:{display:p?"block":"none"},children:c.jsx("source",{src:t.thumbnailVideo,type:"video/mp4"})}),t.images&&t.images.length>0?c.jsx("img",{src:typeof t.images[0]=="string"?t.images[0]:((S=t.images[0])==null?void 0:S.url)||((y=t.images[0])==null?void 0:y.src),alt:t.title||"Setup image",className:`setup-card-image ${o?"loaded":""}`,loading:"lazy",decoding:"async",onLoad:()=>a(!0),onError:v=>{var C;console.error("Image load error:",{raw:t.images[0],type:typeof t.images[0],url:typeof t.images[0]=="string"?t.images[0]:(C=t.images[0])==null?void 0:C.url}),h(!0)},style:{display:t.thumbnailVideo&&p?"none":"block"}}):c.jsxs("div",{className:"image-error",children:[c.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[c.jsx("path",{d:"M24 4L4 44h40L24 4z",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"M24 18v12M24 34v2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),c.jsx("span",{children:"Khng c nh"})]}),!o&&!l&&c.jsx("div",{className:"skeleton-image-placeholder"}),t.thumbnailVideo&&!p&&c.jsx("div",{className:"video-play-indicator",children:c.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"white",children:[c.jsx("circle",{cx:"24",cy:"24",r:"24",opacity:"0.9"}),c.jsx("path",{d:"M18 14l16 10-16 10V14z",fill:"black"})]})}),l&&!t.thumbnailVideo&&c.jsxs("div",{className:"image-error",children:[c.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[c.jsx("path",{d:"M24 4L4 44h40L24 4z",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"M24 18v12M24 34v2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),c.jsx("span",{children:"nh li"})]}),c.jsx("div",{className:"setup-card-overlay",style:{zIndex:4}}),c.jsxs("div",{className:"setup-card-actions",style:{zIndex:5},children:[c.jsx("button",{className:`action-btn ${A?"active":""}`,onClick:T,title:A?"B thch":"Thch",children:c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:A?"currentColor":"none",children:c.jsx("path",{d:"M10 17.5l-1.45-1.32C4.4 12.36 2 10.28 2 7.5 2 5.42 3.42 4 5.5 4c1.74 0 3.41.81 4.5 2.09C11.09 4.81 12.76 4 14.5 4 16.58 4 18 5.42 18 7.5c0 2.78-2.4 4.86-6.55 8.68L10 17.5z",stroke:"currentColor",strokeWidth:"1.5"})})}),c.jsx("button",{className:`action-btn ${b?"active":""}`,onClick:w,title:b?"B lu":"Lu",children:c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:b?"currentColor":"none",children:c.jsx("path",{d:"M5 3h10a2 2 0 012 2v14l-7-4-7 4V5a2 2 0 012-2z",stroke:"currentColor",strokeWidth:"1.5"})})}),c.jsx("button",{className:"action-btn",onClick:E,title:"Chia s",children:c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:c.jsx("path",{d:"M15 13v3a2 2 0 01-2 2H5a2 2 0 01-2-2v-3M10 3v10M10 3l-3 3M10 3l3 3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})})]}),c.jsx("div",{className:"setup-card-tags",style:{zIndex:5},children:t.tags.slice(0,3).map(v=>c.jsxs("span",{className:"tag",children:["#",v]},v))}),c.jsx("button",{className:"mobile-menu-btn",onClick:N,style:{zIndex:6},children:c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[c.jsx("circle",{cx:"10",cy:"4",r:"1.5",fill:"currentColor"}),c.jsx("circle",{cx:"10",cy:"10",r:"1.5",fill:"currentColor"}),c.jsx("circle",{cx:"10",cy:"16",r:"1.5",fill:"currentColor"})]})})]})}),_&&c.jsxs("div",{className:"mobile-menu-popup",children:[c.jsxs("div",{className:"mobile-menu-header",children:[c.jsx("button",{className:"mobile-menu-close",onClick:v=>{v.preventDefault(),v.stopPropagation(),k(!1)},children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),c.jsx("h3",{children:"Ty chn"}),c.jsx("div",{style:{width:"24px"}})]}),c.jsxs("div",{className:"mobile-menu-actions",children:[c.jsxs("button",{onClick:T,className:A?"active":"",children:[c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 20 20",fill:A?"currentColor":"none",children:c.jsx("path",{d:"M10 17.5l-1.45-1.32C4.4 12.36 2 10.28 2 7.5 2 5.42 3.42 4 5.5 4c1.74 0 3.41.81 4.5 2.09C11.09 4.81 12.76 4 14.5 4 16.58 4 18 5.42 18 7.5c0 2.78-2.4 4.86-6.55 8.68L10 17.5z",stroke:"currentColor",strokeWidth:"1.5"})}),c.jsx("span",{children:A?"B thch":"Thch"})]}),c.jsxs("button",{onClick:w,className:b?"active":"",children:[c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 20 20",fill:b?"currentColor":"none",children:c.jsx("path",{d:"M5 3h10a2 2 0 012 2v14l-7-4-7 4V5a2 2 0 012-2z",stroke:"currentColor",strokeWidth:"1.5"})}),c.jsx("span",{children:b?" lu":"Lu"})]}),c.jsxs("button",{onClick:E,children:[c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 20 20",fill:"none",children:c.jsx("path",{d:"M15 13v3a2 2 0 01-2 2H5a2 2 0 01-2-2v-3M10 3v10M10 3l-3 3M10 3l3 3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})}),c.jsx("span",{children:"Chia s"})]})]})]})]})},Su=({title:t,description:e,image:n,url:r,type:s="website",schema:i})=>{const o="DeskHub",a="DeskHub - Cng ng Chia S Gc Lm Vic p",l="Khm ph hng ngn  tng setup gc lm vic, bn gaming, v khng gian sng to t cng ng.",h="https://images.unsplash.com/photo-1498050108023-c5249f4df085?auto=format&fit=crop&w=1200&q=80",d=t?`${t} | ${o}`:a,p=e||l,m=n||h,_=r||window.location.href;return c.jsxs(XP,{children:[c.jsx("title",{children:d}),c.jsx("meta",{name:"description",content:p}),c.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),c.jsx("link",{rel:"canonical",href:_}),c.jsx("meta",{property:"og:site_name",content:o}),c.jsx("meta",{property:"og:title",content:d}),c.jsx("meta",{property:"og:description",content:p}),c.jsx("meta",{property:"og:image",content:m}),c.jsx("meta",{property:"og:url",content:_}),c.jsx("meta",{property:"og:type",content:s}),c.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),c.jsx("meta",{name:"twitter:title",content:d}),c.jsx("meta",{name:"twitter:description",content:p}),c.jsx("meta",{name:"twitter:image",content:m}),i&&c.jsx("script",{type:"application/ld+json",children:JSON.stringify(i)})]})},X4=()=>{var N,j,F,S,y;const{getFilteredSetups:t,loading:e,filters:n,setups:r}=Mt(),[s,i]=P.useState([]),[o,a]=P.useState(1),[l,h]=P.useState(!1),d=P.useRef(null),p=P.useRef(null),m=12,_=P.useMemo(()=>t(),[t]);P.useEffect(()=>{k(1)},[_]),P.useEffect(()=>{const v={root:null,rootMargin:"200px",threshold:.1};return d.current=new IntersectionObserver(C=>{C[0].isIntersecting&&!l&&A()},v),p.current&&d.current.observe(p.current),()=>{d.current&&d.current.disconnect()}},[l,o]);const k=v=>{h(!0);const C=0,R=v*m,D=_.slice(C,R);i(D),a(v),h(!1)},A=()=>{const v=o+1,C=v*m;if(s.length<_.length){h(!0);const R=_.slice(0,C);i(R),a(v),h(!1)}},b=s.length<_.length,T=n.search||((N=n.colorTone)==null?void 0:N.length)>0||((j=n.budget)==null?void 0:j.length)>0||((F=n.gender)==null?void 0:F.length)>0||((S=n.purpose)==null?void 0:S.length)>0||((y=n.size)==null?void 0:y.length)>0,w=e||r.length===0,E=!w&&T&&_.length===0;return c.jsxs("div",{className:"masonry-gallery",children:[c.jsx(Su,{title:"Khm Ph Gc Lm Vic - DeskHub",description:"B su tp nhng gc lm vic, setup bn phm, mn hnh p nht c chia s bi cng ng."}),w&&c.jsxs("div",{className:"loading-state",children:[c.jsx("div",{className:"loading-spinner"}),c.jsx("h3",{children:"Sp load xong cc gc setup, bn ng thot nh "}),c.jsx("p",{children:"ang ti d liu t server..."})]}),E&&c.jsxs("div",{className:"empty-state",children:[c.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[c.jsx("path",{d:"M60 20L20 100h80L60 20z",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{d:"M60 45v30M60 85v4",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),c.jsx("h3",{children:"Khng tm thy setup no"}),c.jsx("p",{children:"Th thay i b lc hoc tm kim vi t kha khc"})]}),!w&&s.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"masonry-grid",children:s.map((v,C)=>c.jsx(Q4,{setup:v,index:C},v.id))}),b&&c.jsx("div",{ref:p,className:"load-more-trigger",children:l&&c.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:c.jsx("p",{children:"ang ti..."})})}),!b&&s.length>0&&c.jsx("div",{className:"end-message",children:" Bn  xem ht tt c!"})]})]})},Y4=()=>{var we,tt,at;const{selectedSetup:t,setSelectedSetup:e,toggleLike:n,toggleSave:r,addComment:s,getComments:i,hasUserLiked:o,hasUserSaved:a,getSimilarSetups:l,currentUser:h,setups:d,setShowAuthModal:p}=Mt(),[m,_]=P.useState(null),[k,A]=P.useState(0),[b,T]=P.useState(""),[w,E]=P.useState(!0),[N,j]=P.useState(!1),[F,S]=P.useState(!1),[y,v]=P.useState(null),[C,R]=P.useState(null),D=50;if(zt.useEffect(()=>{const H=()=>j(window.innerWidth<=768);return H(),window.addEventListener("resize",H),()=>window.removeEventListener("resize",H)},[]),zt.useEffect(()=>{N&&t&&le.length>1&&(localStorage.getItem("hasSeenSwipeHint")||(S(!0),setTimeout(()=>{S(!1),localStorage.setItem("hasSeenSwipeHint","true")},3e3)))},[N,t]),!t)return null;const x=t,le=((we=x.images)==null?void 0:we.length)>0?[...x.images.map(H=>({type:"image",url:H.url,products:H.products||[]})),...x.youtubeVideo?[{type:"youtube",url:x.youtubeVideo,poster:x.mainImage}]:[]]:[{type:"image",url:x.mainImage,products:x.products||[]},...(x.moreImages||[]).map(H=>({type:"image",url:H})),...x.youtubeVideo?[{type:"youtube",url:x.youtubeVideo,poster:x.mainImage}]:[]],me=le[k]||le[0],et=o(x.id),ot=a(x.id),K=i(x.id),se=l(x.id),L=()=>{m&&_(null)},G=()=>{e(null),T("")},B=()=>{if(!h){p(!0);return}n(x.id)},Y=H=>{if(H.preventDefault(),!h){p(!0);return}b.trim()&&(s(x.id,b),T(""))},re=H=>{H.target===H.currentTarget&&G()},xe={"@context":"https://schema.org","@type":"CreativeWork",name:x.title,image:x.mainImage,creator:{"@type":"Person",name:x.author.name},description:x.caption,interactionStatistic:[{"@type":"InteractionCounter",interactionType:"https://schema.org/LikeAction",userInteractionCount:((tt=x.likes)==null?void 0:tt.length)||0}]},Se=H=>{R(null),v(H.targetTouches[0].clientX)},Ne=H=>{R(H.targetTouches[0].clientX)},Kt=()=>{if(!y||!C)return;const H=y-C,Ee=H>D,Et=H<-D;Ee&&k<le.length-1&&A(pt=>pt+1),Et&&k>0&&A(pt=>pt-1)};return c.jsxs("div",{className:"modal-overlay",onClick:re,children:[c.jsx(Su,{title:x.title,description:x.caption,image:x.mainImage,type:"article",schema:xe}),c.jsxs("div",{className:"setup-detail-modal modal-content",children:[c.jsx("button",{className:"modal-close-btn",onClick:G,children:c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),F&&N&&c.jsxs("div",{className:"swipe-hint-popup",children:[c.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M9 18l6-6-6-6",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),c.jsx("p",{children:"Vut  xem nh tip theo"})]}),c.jsxs("div",{className:"modal-layout",children:[c.jsxs("div",{className:"modal-gallery",children:[c.jsxs("div",{className:"main-image-container",onClick:L,onTouchStart:N?Se:void 0,onTouchMove:N?Ne:void 0,onTouchEnd:N?Kt:void 0,children:[me.type==="video"?c.jsx("video",{src:me.url,className:"main-image",controls:!0,autoPlay:!0,muted:!1,poster:me.poster,style:{objectFit:"contain",background:"#000"}}):me.type==="youtube"?c.jsx(J4,{url:me.url,poster:me.poster}):c.jsxs("div",{className:"image-wrapper-relative",children:[c.jsx("img",{src:me.url,alt:x.title,className:"main-image"}),w&&me.products&&Array.isArray(me.products)&&me.products.map((H,Ee)=>c.jsx(Z4,{product:H,isActive:m===H,onActivate:_},Ee)),c.jsx("button",{className:"toggle-products-btn",onClick:H=>{H.stopPropagation(),E(!w)},children:w?"n sn phm":"Hin sn phm"}),le.length>1&&c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"nav-arrow prev",onClick:H=>{H.stopPropagation(),A(Ee=>Math.max(0,Ee-1))},disabled:k===0,"aria-label":"Previous image",children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),c.jsx("button",{className:"nav-arrow next",onClick:H=>{H.stopPropagation(),A(Ee=>Math.min(le.length-1,Ee+1))},disabled:k===le.length-1,"aria-label":"Next image",children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M9 18l6-6-6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),le.length>1&&c.jsx("div",{className:"image-pagination-dots",children:le.slice(0,5).map((H,Ee)=>{let Et="pagination-dot";return Ee===k&&(Et+=" active"),Ee===3&&(Et+=" dot-small"),Ee===4&&(Et+=" dot-tiny"),c.jsx("button",{className:Et,onClick:pt=>{pt.stopPropagation(),A(Ee)},"aria-label":`Go to image ${Ee+1}`},Ee)})})]}),le.length>1&&c.jsx("div",{className:"image-thumbnails",children:le.map((H,Ee)=>c.jsx("button",{className:`thumbnail ${Ee===k?"active":""}`,onClick:()=>A(Ee),children:H.type==="video"?c.jsxs("div",{className:"thumbnail-video-wrapper",style:{position:"relative",width:"100%",height:"100%"},children:[c.jsx("img",{src:H.poster,alt:"Video",style:{width:"100%",height:"100%",objectFit:"cover"}}),c.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.3)"},children:c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"white",children:c.jsx("path",{d:"M8 5v14l11-7z"})})})]}):H.type==="youtube"?c.jsxs("div",{className:"thumbnail-video-wrapper",style:{position:"relative",width:"100%",height:"100%"},children:[c.jsx("img",{src:H.poster,alt:"YouTube",style:{width:"100%",height:"100%",objectFit:"cover"}}),c.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.3)"},children:c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"red",children:c.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})})})]}):c.jsx("img",{src:H.url,alt:`View ${Ee+1}`})},Ee))})]}),c.jsxs("div",{className:"modal-details",children:[c.jsxs("div",{className:"detail-header",children:[c.jsxs("div",{className:"author-info",children:[c.jsx("img",{src:x.author.avatar,alt:x.author.name,className:"author-avatar-large"}),c.jsxs("div",{children:[c.jsx("h2",{className:"detail-title",children:x.title}),c.jsx("p",{className:"author-name-large",children:x.author.name})]})]}),c.jsxs("div",{className:"detail-actions",children:[c.jsxs("button",{className:`action-btn-large ${et?"active":""}`,onClick:B,children:[c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 20 20",fill:et?"currentColor":"none",children:c.jsx("path",{d:"M10 17.5l-1.45-1.32C4.4 12.36 2 10.28 2 7.5 2 5.42 3.42 4 5.5 4c1.74 0 3.41.81 4.5 2.09C11.09 4.81 12.76 4 14.5 4 16.58 4 18 5.42 18 7.5c0 2.78-2.4 4.86-6.55 8.68L10 17.5z",stroke:"currentColor",strokeWidth:"1.5"})}),c.jsx("span",{children:(((at=x.likes)==null?void 0:at.length)||0).toLocaleString()})]}),c.jsxs("button",{className:`action-btn-large ${ot?"active":""}`,onClick:()=>r(x.id),children:[c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 20 20",fill:ot?"currentColor":"none",children:c.jsx("path",{d:"M5 3h10a2 2 0 012 2v14l-7-4-7 4V5a2 2 0 012-2z",stroke:"currentColor",strokeWidth:"1.5"})}),c.jsx("span",{children:ot?" Lu":"Lu"})]})]})]}),c.jsx("p",{className:"detail-caption",children:x.caption}),c.jsx("div",{className:"detail-tags",children:x.tags&&Array.isArray(x.tags)&&x.tags.map(H=>c.jsxs("span",{className:"detail-tag",children:["#",H]},H))}),c.jsxs("div",{className:"detail-filters",children:[c.jsx("h4",{children:"Chi Tit Setup"}),c.jsx("div",{className:"filter-badges",children:Object.entries(x.filters).map(([H,Ee])=>c.jsx("span",{className:"filter-badge",children:Ee.replace("-"," ")},H))})]}),c.jsxs("div",{className:"comments-section",children:[c.jsxs("h4",{children:["Bnh Lun (",K.length,")"]}),c.jsxs("form",{className:"comment-form",onSubmit:Y,children:[c.jsxs("div",{className:"comment-input-wrapper",children:[c.jsx("img",{src:(h==null?void 0:h.avatar)||"https://ui-avatars.com/api/?name=User&background=random",alt:"Avatar",className:"comment-user-avatar"}),c.jsx("input",{type:"text",className:"input comment-input",placeholder:h?`Bnh lun vi tn ${h.displayName}...`:"ng nhp  bnh lun...",value:b,onChange:H=>T(H.target.value),onClick:()=>!h&&p(!0)})]}),c.jsx("button",{type:"submit",className:"btn btn-primary",disabled:!b.trim(),onClick:H=>{h||(H.preventDefault(),p(!0))},children:"Gi"})]}),c.jsx("div",{className:"comments-list",children:K.length===0?c.jsx("p",{className:"no-comments",children:"Cha c bnh lun no. Hy l ngi u tin!"}):K.map(H=>c.jsxs("div",{className:"comment",children:[c.jsx("img",{src:H.avatar,alt:H.author,className:"comment-avatar"}),c.jsxs("div",{className:"comment-content",children:[c.jsxs("div",{className:"comment-header",children:[c.jsx("span",{className:"comment-author",children:H.author}),c.jsx("span",{className:"comment-time",children:new Date(H.timestamp).toLocaleDateString("vi-VN")})]}),c.jsx("p",{className:"comment-text",children:H.text})]})]},H.id))})]}),se.length>0&&c.jsxs("div",{className:"similar-setups",children:[c.jsx("h4",{children:"Setup Tng T"}),c.jsx("div",{className:"similar-grid",children:se.map(H=>c.jsxs("div",{className:"similar-card",onClick:()=>{e(H),A(0),T("")},children:[c.jsx("img",{src:H.mainImage,alt:H.title}),c.jsx("p",{className:"similar-title",children:H.title})]},H.id))})]})]})]})]}),N&&m&&jI.createPortal(c.jsxs("div",{className:"product-tooltip-portal",style:{position:"fixed",bottom:"20px",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:"380px",background:"rgba(20, 20, 20, 0.95)",backdropFilter:"blur(12px)",color:"white",border:"1px solid rgba(255, 255, 255, 0.1)",padding:"20px",zIndex:1e5,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5), 0 2px 8px rgba(0, 0, 0, 0.3)",borderRadius:"16px",display:"flex",flexDirection:"column",gap:"12px",animation:"slideUpFade 0.3s ease-out"},onClick:H=>H.stopPropagation(),children:[c.jsx("button",{style:{position:"absolute",top:"12px",right:"12px",background:"rgba(255, 255, 255, 0.1)",border:"none",color:"rgba(255, 255, 255, 0.7)",fontSize:"20px",width:"32px",height:"32px",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",lineHeight:"1"},onClick:H=>{H.stopPropagation(),_(null)},onMouseEnter:H=>{H.target.style.background="rgba(255, 255, 255, 0.2)"},onMouseLeave:H=>{H.target.style.background="rgba(255, 255, 255, 0.1)"},children:""}),c.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"white",margin:"0 24px 0 0",lineHeight:"1.4",paddingRight:"8px"},children:m.name}),c.jsx("div",{style:{fontSize:"28px",fontWeight:700,color:"#ff6b35",margin:"4px 0",lineHeight:"1.2"},children:m.price}),m.link&&c.jsxs("a",{href:m.link,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"15px",fontWeight:600,color:"white",textDecoration:"none",background:"linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%)",padding:"14px 24px",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"8px",boxShadow:"0 4px 12px rgba(255, 107, 53, 0.4)",transition:"all 0.2s",border:"none"},onMouseEnter:H=>{H.target.style.transform="translateY(-2px)",H.target.style.boxShadow="0 6px 16px rgba(255, 107, 53, 0.5)"},onMouseLeave:H=>{H.target.style.transform="translateY(0)",H.target.style.boxShadow="0 4px 12px rgba(255, 107, 53, 0.4)"},children:[c.jsx("span",{children:"Xem sn phm"}),c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{marginTop:"1px"},children:c.jsx("path",{d:"M6 3L11 8L6 13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})]}),document.body)]})},J4=({url:t,poster:e})=>{const[n,r]=P.useState(!1);return zt.useEffect(()=>{r(!1)},[t]),n?c.jsx("iframe",{width:"100%",height:"100%",src:`${t}?autoplay=1&rel=0`,title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,style:{aspectRatio:"16/9",borderRadius:"8px",minHeight:"400px"}}):c.jsxs("div",{className:"youtube-placeholder",onClick:()=>r(!0),style:{position:"relative",width:"100%",height:"100%",minHeight:"400px",cursor:"pointer",backgroundImage:`url(${e})`,backgroundSize:"cover",backgroundPosition:"center",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:[c.jsx("div",{style:{background:"red",width:"60px",height:"40px",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center"},children:c.jsx("div",{style:{width:0,height:0,borderTop:"10px solid transparent",borderBottom:"10px solid transparent",borderLeft:"16px solid white"}})}),c.jsx("div",{style:{position:"absolute",bottom:"10px",left:"10px",color:"white",textShadow:"0 1px 2px rgba(0,0,0,0.8)"},children:"Click  pht video"})]})},Z4=({product:t,isActive:e,onActivate:n})=>{const[r,s]=P.useState(!1);zt.useEffect(()=>{const o=()=>s(window.innerWidth<=768);return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]);const i=o=>{o.stopPropagation(),n(e?null:t)};return c.jsxs("div",{className:"product-marker",style:{left:`${t.x}%`,top:`${t.y}%`},onClick:i,children:[c.jsx("button",{className:`marker-btn ${e?"active":""}`,children:c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[c.jsx("circle",{cx:"10",cy:"10",r:"8",fill:"var(--color-primary)"}),c.jsx("path",{d:"M10 6v8M6 10h8",stroke:"white",strokeWidth:"2",strokeLinecap:"round"})]})}),!r&&e&&c.jsxs("div",{className:"product-tooltip-desktop",style:{position:"absolute",left:"50%",bottom:"100%",transform:"translateX(-50%) translateY(-8px)",marginBottom:"8px",background:"white",color:"#333",padding:"16px",borderRadius:"12px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.15), 0 2px 8px rgba(0, 0, 0, 0.1)",minWidth:"280px",maxWidth:"320px",zIndex:1e4,animation:"fadeIn 0.2s ease-out",border:"1px solid rgba(0, 0, 0, 0.08)"},onClick:o=>o.stopPropagation(),children:[c.jsx("h3",{style:{fontSize:"15px",fontWeight:600,color:"#333",margin:"0 0 8px 0",lineHeight:"1.4"},children:t.name}),c.jsx("div",{style:{fontSize:"24px",fontWeight:700,color:"#ff6b35",margin:"0 0 12px 0",lineHeight:"1.2"},children:t.price}),t.link&&c.jsxs("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"14px",fontWeight:600,color:"white",textDecoration:"none",background:"linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%)",padding:"10px 20px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",boxShadow:"0 4px 12px rgba(255, 107, 53, 0.3)",transition:"all 0.2s",border:"none"},onMouseEnter:o=>{o.target.style.transform="translateY(-2px)",o.target.style.boxShadow="0 6px 16px rgba(255, 107, 53, 0.4)"},onMouseLeave:o=>{o.target.style.transform="translateY(0)",o.target.style.boxShadow="0 4px 12px rgba(255, 107, 53, 0.3)"},children:[c.jsx("span",{children:"Xem sn phm"}),c.jsx("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"none",children:c.jsx("path",{d:"M6 3L11 8L6 13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),c.jsx("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderTop:"8px solid white",filter:"drop-shadow(0 1px 1px rgba(0, 0, 0, 0.05))"}})]})]})},e6=()=>{const{blogs:t}=Mt();return c.jsxs("div",{className:"blog-view",children:[c.jsx(Su,{title:"Blog DeskHub - Kinh Nghim & Cm Hng",description:"Tng hp cc bi vit hng dn setup, review gear, v xu hng thit k gc lm vic mi nht."}),c.jsxs("div",{className:"blog-hero",children:[c.jsx("h1",{children:"Gc Nhn Desk Setup"}),c.jsx("p",{children:"Mo, xu hng v cm hng cho gc lm vic hon ho ca bn"})]}),c.jsx("div",{className:"blog-grid",children:t.map(e=>c.jsx(gn,{to:`/blog/${e.slug||e.id}`,className:"blog-card-link",children:c.jsxs("article",{className:"blog-card",children:[c.jsxs("div",{className:"blog-card-image",children:[c.jsx("img",{src:e.coverImage,alt:e.title}),c.jsx("span",{className:"blog-category",children:e.category})]}),c.jsxs("div",{className:"blog-card-content",children:[c.jsx("h3",{className:"blog-card-title",children:e.title}),c.jsx("p",{className:"blog-card-excerpt",children:e.excerpt}),c.jsxs("div",{className:"blog-card-meta",children:[c.jsxs("div",{className:"blog-author",children:[c.jsx("img",{src:e.author.avatar,alt:e.author.name}),c.jsx("span",{children:e.author.name})]}),c.jsxs("div",{className:"blog-stats",children:[c.jsxs("span",{className:"read-time",children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",children:[c.jsx("circle",{cx:"10",cy:"10",r:"8",stroke:"currentColor",strokeWidth:"1.5"}),c.jsx("path",{d:"M10 6v4l3 2",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),e.readTime," min"]}),c.jsxs("span",{className:"views",children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",children:[c.jsx("path",{d:"M1 10s3-7 9-7 9 7 9 7-3 7-9 7-9-7-9-7z",stroke:"currentColor",strokeWidth:"1.5"}),c.jsx("circle",{cx:"10",cy:"10",r:"3",stroke:"currentColor",strokeWidth:"1.5"})]}),e.views]})]})]})]})]})},e.id))})]})},t6=()=>{const{slug:t}=bg(),e=iu(),{blogs:n,setBlogs:r,deleteBlog:s,currentUser:i}=Mt(),[o,a]=P.useState(null);if(P.useEffect(()=>{let m=n.find(_=>_.slug===t||_.id==t);m||(m=Xa.find(_=>_.slug===t||_.id==t)),m&&a(m)},[t,n]),P.useEffect(()=>{window.scrollTo(0,0)},[]),P.useEffect(()=>{if(!o)return;console.log("BlogDetail: Setting up view timer for blog:",o.id);const m=setTimeout(async()=>{console.log("BlogDetail: 5 seconds elapsed, incrementing view for blog:",o.id);try{const _=await yt.incrementBlogView(o.id)}catch(_){console.error("BlogDetail: Error incrementing view:",_)}},5e3);return()=>clearTimeout(m)},[o==null?void 0:o.id]),!o)return c.jsxs("div",{className:"container",style:{padding:"2rem",textAlign:"center",minHeight:"50vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[c.jsx("h3",{children:"ang ti bi vit..."}),c.jsxs("div",{style:{color:"#666",marginTop:"1rem",fontSize:"0.9rem",textAlign:"left",background:"#f5f5f5",padding:"1rem",borderRadius:"8px"},children:[c.jsx("p",{children:c.jsx("strong",{children:"Debug Info:"})}),c.jsxs("p",{children:["Requested Slug/ID: ",t]}),c.jsxs("p",{children:["Context Blogs Loaded: ",n.length]}),c.jsxs("p",{children:["Sample Data Size: ",(Xa==null?void 0:Xa.length)||"undefined"]}),c.jsx("p",{style:{marginTop:"0.5rem",fontStyle:"italic",fontSize:"0.8rem"},children:"Nu s liu trn = 0, vui lng kim tra li kt ni mng hoc th li sau."})]})]});const l=()=>{e("/blog")},h=()=>{e(`/blog/edit/${o.id}`)},d=async()=>{if(window.confirm("Bn c chc chn mun xa bi vit ny khng?")){const m=await s(o.id);m.success?e("/blog"):alert(m.message||"C li xy ra")}},p={"@context":"https://schema.org","@type":"BlogPosting",headline:o.title,image:o.coverImage,author:{"@type":"Person",name:o.author.name},publisher:{"@type":"Organization",name:"DeskHub",logo:{"@type":"ImageObject",url:"https://deskhub.demo/logo.png"}},datePublished:o.publishedAt,description:o.excerpt};return c.jsxs("div",{className:"blog-detail-page",children:[c.jsx(Su,{title:o.title,description:o.excerpt,image:o.coverImage,type:"article",schema:p}),c.jsxs("div",{className:"blog-detail-actions",style:{display:"flex",justifyContent:"space-between",gap:"var(--space-md)"},children:[c.jsxs("button",{className:"back-btn",onClick:l,children:[c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:c.jsx("path",{d:"M12.5 15L7.5 10l5-5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),"Quay li"]}),i&&i.role==="admin"&&c.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)"},children:[c.jsxs("button",{className:"back-btn",style:{color:"#3b82f6",borderColor:"#3b82f6"},onClick:h,children:[c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:c.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),"Chnh sa"]}),c.jsxs("button",{className:"back-btn",style:{color:"#ef4444",borderColor:"#ef4444"},onClick:d,children:[c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:c.jsx("path",{d:"M5 7h10M8 7V5a1 1 0 011-1h2a1 1 0 011 1v2m-5 0h6M6 7v10a1 1 0 001 1h6a1 1 0 001-1V7",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})}),"Xa bi vit"]})]})]}),c.jsxs("article",{className:"blog-article",children:[c.jsxs("div",{className:"blog-cover",children:[c.jsx("img",{src:o.coverImage,alt:o.title}),c.jsx("div",{className:"blog-cover-overlay",children:c.jsx("span",{className:"blog-category-large",children:o.category})})]}),c.jsxs("header",{className:"blog-header",children:[c.jsx("h1",{className:"blog-title",children:o.title}),c.jsxs("div",{className:"blog-meta-large",children:[c.jsxs("div",{className:"blog-author-large",children:[c.jsx("img",{src:o.author.avatar,alt:o.author.name}),c.jsxs("div",{children:[c.jsx("p",{className:"author-name",children:o.author.name}),c.jsx("p",{className:"publish-date",children:new Date(o.publishedAt).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric"})})]})]}),c.jsxs("div",{className:"blog-stats-large",children:[c.jsxs("span",{className:"stat",children:[c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[c.jsx("circle",{cx:"10",cy:"10",r:"8",stroke:"currentColor",strokeWidth:"1.5"}),c.jsx("path",{d:"M10 6v4l3 2",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),o.readTime," pht c"]}),c.jsxs("span",{className:"stat",children:[c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[c.jsx("path",{d:"M1 10s3-7 9-7 9 7 9 7-3 7-9 7-9-7-9-7z",stroke:"currentColor",strokeWidth:"1.5"}),c.jsx("circle",{cx:"10",cy:"10",r:"3",stroke:"currentColor",strokeWidth:"1.5"})]}),o.views," lt xem"]})]})]})]}),c.jsx("div",{className:"blog-content",dangerouslySetInnerHTML:{__html:o.content}}),c.jsx("div",{className:"blog-tags",children:o.tags.map(m=>c.jsxs("span",{className:"blog-tag",children:["#",m]},m))})]})]})},Yf=t=>{if(!t)return"";const e={:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"i",:"i",:"i",:"i",:"i",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"y",:"y",:"y",:"y",:"y",:"d",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"I",:"I",:"I",:"I",:"I",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"Y",:"Y",:"Y",:"Y",:"Y",:"D"};let n=t.split("").map(r=>e[r]||r).join("");return n=n.toLowerCase(),n=n.replace(/\s+/g,"-"),n=n.replace(/[^a-z0-9-]/g,""),n=n.replace(/-+/g,"-"),n=n.replace(/^-+|-+$/g,""),n},wE=()=>{const{id:t}=bg(),e=iu(),{addBlog:n,updateBlog:r,blogs:s}=Mt(),i=!!t,[o,a]=P.useState(null),[l,h]=P.useState(""),[d,p]=P.useState(""),[m,_]=P.useState(""),[k,A]=P.useState(""),[b,T]=P.useState("Hng Dn"),[w,E]=P.useState(""),[N,j]=P.useState(5),[F,S]=P.useState(""),y=P.useRef(null),v=P.useRef(null),[C,R]=P.useState("image");P.useEffect(()=>{var B;if(i&&s.length>0){const Y=s.find(re=>re.id==t);Y?(a(Y),h(Y.title||""),p(Y.slug||""),_(Y.excerpt||""),A(Y.coverImage||""),T(Y.category||"Hng Dn"),E(((B=Y.tags)==null?void 0:B.join(", "))||""),j(Y.readTime||5),S(Y.content||""),y.current&&(y.current.innerHTML=Y.content||"")):(alert("Khng tm thy bi vit!"),e("/blog"))}},[i,t,s,e]);const D=B=>{const Y=B.target.value;h(Y);const re=Yf(Y);(!d||d===Yf(l))&&p(re)},x=async B=>{B.preventDefault(),console.log(" Blog form submission started");const Y={title:l,slug:d||Yf(l),excerpt:m,coverImage:k||"https://images.unsplash.com/photo-1593062096033-9a26b09da705?w=1200",content:F,category:b,tags:w.split(",").map(re=>re.trim()).filter(Boolean),readTime:parseInt(N)||5};if(console.log(" Blog data to save:",Y),i&&o){console.log(" Updating blog:",o.id);const re=await r(o.id,Y);console.log(" Update response:",re),re.success?(alert(" cp nht bi vit thnh cng!"),e(`/blog/${o.id}`)):alert(`Li: ${re.message||"C li xy ra khi cp nht!"}`)}else{console.log(" Creating new blog");const re=await n(Y);console.log(" Create response:",re),re.success?(alert(" ng bi vit thnh cng!"),e("/blog")):alert(`Li: ${re.message||"C li xy ra!"}`)}},le=(B,Y=null)=>{var re;document.execCommand(B,!1,Y),(re=y.current)==null||re.focus(),G()},me=B=>{const Y=window.getSelection();if(Y.rangeCount>0){const re=Y.getRangeAt(0),xe=document.createElement(`h${B}`);xe.textContent=Y.toString()||`Tiu  ${B}`,re.deleteContents(),re.insertNode(xe),G()}},et=B=>{R(B),v.current&&(v.current.accept=B==="image"?"image/*":"video/*",v.current.click())},ot=B=>{const Y=B.target.files[0];if(Y){const re=new FileReader;re.onload=xe=>{const Se=xe.target.result;if(C==="image"){const Ne=`<img src="${Se}" style="max-width: 100%; height: auto; border-radius: 8px; margin: 10px 0;" alt="Uploaded image" />`;document.execCommand("insertHTML",!1,Ne)}else{const Ne=`<div class="video-container" style="margin: 10px 0;"><video controls width="100%" style="border-radius: 8px;"><source src="${Se}" type="${Y.type}">Trnh duyt ca bn khng h tr th video.</video></div><p><br/></p>`;document.execCommand("insertHTML",!1,Ne)}G()},re.readAsDataURL(Y)}B.target.value=""},K=()=>{const B=prompt("Nhp ng dn (URL):");B&&le("createLink",B)},se=B=>{le("fontName",B)},L=B=>{le("foreColor",B)},G=()=>{y.current&&S(y.current.innerHTML)};return c.jsxs("div",{className:"blog-editor",children:[c.jsx("input",{type:"file",ref:v,style:{display:"none"},onChange:ot}),c.jsxs("div",{className:"editor-header",children:[c.jsx("h1",{children:i?"Chnh Sa Bi Vit":"To Bi Vit Mi"}),c.jsx("p",{children:i?"Cp nht ni dung bi vit ca bn":"Chia s kin thc v cm hng setup ca bn"})]}),c.jsxs("form",{onSubmit:x,className:"editor-form",children:[c.jsxs("div",{className:"form-section",children:[c.jsx("h3",{children:"Thng Tin C Bn"}),c.jsxs("div",{className:"form-grid",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"title",children:"Tiu  *"}),c.jsx("input",{id:"title",type:"text",className:"input",value:l,onChange:D,placeholder:"Nhp tiu  bi vit",required:!0})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"slug",children:"URL / Slug"}),c.jsx("input",{id:"slug",type:"text",className:"input",value:d,onChange:B=>p(B.target.value),placeholder:"tu-dong-tao-tu-tieu-de"})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"category",children:"Danh Mc *"}),c.jsxs("select",{id:"category",className:"input",value:b,onChange:B=>T(B.target.value),required:!0,children:[c.jsx("option",{value:"Hng Dn",children:"Hng Dn"}),c.jsx("option",{value:"Thit K",children:"Thit K"}),c.jsx("option",{value:"nh Gi",children:"nh Gi"}),c.jsx("option",{value:"Xu Hng",children:"Xu Hng"}),c.jsx("option",{value:"Mo",children:"Mo"})]})]}),c.jsxs("div",{className:"form-group full-width",children:[c.jsx("label",{htmlFor:"excerpt",children:"M T Ngn *"}),c.jsx("textarea",{id:"excerpt",className:"input",value:m,onChange:B=>_(B.target.value),placeholder:"M t ngn gn v ni dung bi vit",rows:"3",required:!0})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"coverImage",children:"nh Ba (URL hoc Upload bn di)"}),c.jsxs("div",{style:{display:"flex",gap:"10px"},children:[c.jsx("input",{id:"coverImage",type:"url",className:"input",value:k,onChange:B=>A(B.target.value),placeholder:"https://example.com/image.jpg",style:{flex:1}}),c.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{R("image"),alert("Hin ti nh ba h tr URL. Tnh nng upload nh ba ang pht trin.")},children:"URL"})]})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"readTime",children:"Thi Gian c (pht)"}),c.jsx("input",{id:"readTime",type:"number",className:"input",value:N,onChange:B=>j(B.target.value),min:"1",max:"60"})]}),c.jsxs("div",{className:"form-group full-width",children:[c.jsx("label",{htmlFor:"tags",children:"Th (phn cch bng du phy)"}),c.jsx("input",{id:"tags",type:"text",className:"input",value:w,onChange:B=>E(B.target.value),placeholder:"desk, productivity, ergonomics"})]})]})]}),c.jsxs("div",{className:"form-section",children:[c.jsx("h3",{children:"Ni Dung Bi Vit"}),c.jsxs("div",{className:"editor-toolbar",children:[c.jsxs("div",{className:"toolbar-group",children:[c.jsxs("select",{onChange:B=>me(B.target.value),className:"toolbar-select",children:[c.jsx("option",{value:"",children:"Tiu "}),c.jsx("option",{value:"2",children:"Heading 2"}),c.jsx("option",{value:"3",children:"Heading 3"}),c.jsx("option",{value:"4",children:"Heading 4"})]}),c.jsxs("select",{onChange:B=>se(B.target.value),className:"toolbar-select",children:[c.jsx("option",{value:"Arial",children:"Arial"}),c.jsx("option",{value:"Georgia",children:"Georgia"}),c.jsx("option",{value:"Courier New",children:"Courier New"}),c.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),c.jsx("option",{value:"System-ui",children:"System UI"})]})]}),c.jsxs("div",{className:"toolbar-group",children:[c.jsx("button",{type:"button",className:"toolbar-btn",onClick:()=>le("bold"),title:"In m",children:c.jsx("strong",{children:"B"})}),c.jsx("button",{type:"button",className:"toolbar-btn",onClick:()=>le("italic"),title:"In nghing",children:c.jsx("em",{children:"I"})}),c.jsx("button",{type:"button",className:"toolbar-btn",onClick:()=>le("underline"),title:"Gch chn",children:c.jsx("u",{children:"U"})}),c.jsx("button",{type:"button",className:"toolbar-btn",onClick:()=>K(),title:"Chn Link",children:""})]}),c.jsxs("div",{className:"toolbar-group",children:[c.jsx("button",{type:"button",className:"toolbar-btn",onClick:()=>le("insertUnorderedList"),title:"Danh sch",children:" List"}),c.jsx("button",{type:"button",className:"toolbar-btn",onClick:()=>le("insertOrderedList"),title:"S th t",children:"1. List"})]}),c.jsxs("div",{className:"toolbar-group",children:[c.jsx("button",{type:"button",className:"toolbar-btn",onClick:()=>et("image"),title:"Ti nh ln",children:" nh"}),c.jsx("button",{type:"button",className:"toolbar-btn",onClick:()=>et("video"),title:"Ti video ln",children:" Video"})]}),c.jsx("div",{className:"toolbar-group",children:c.jsx("input",{type:"color",onChange:B=>L(B.target.value),title:"Mu ch",className:"toolbar-color-picker"})})]}),c.jsx("div",{ref:y,className:"content-editor",contentEditable:!0,onInput:G,"data-placeholder":"Bt u vit bi ti y..."})]}),c.jsxs("div",{className:"editor-actions",children:[c.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>e("/blog"),children:"Hy"}),c.jsx("button",{type:"submit",className:"btn btn-primary",children:i?"Cp Nht":"ng Bi"})]})]})]})},Qk=({onClose:t,onSave:e,initialData:n=null})=>{var et,ot,K,se;const[r,s]=P.useState({title:(n==null?void 0:n.title)||"",caption:(n==null?void 0:n.caption)||"",authorName:((et=n==null?void 0:n.author)==null?void 0:et.name)||"",authorAvatar:((ot=n==null?void 0:n.author)==null?void 0:ot.avatar)||"",filters:(n==null?void 0:n.filters)||{colorTone:"neutral",budget:"mid-range",gender:"neutral",purpose:"productivity",size:"medium"},tags:((K=n==null?void 0:n.tags)==null?void 0:K.join(", "))||""}),[i,o]=P.useState(()=>n!=null&&n.media&&n.media.length>0?n.media:n!=null&&n.image?[{id:Date.now().toString(),type:"image",url:n.image,products:n.products||[]}]:[]),[a,l]=P.useState(null),[h,d]=P.useState(!1),[p,m]=P.useState(null),[_,k]=P.useState(((se=n==null?void 0:n.author)==null?void 0:se.avatar)||"");P.useEffect(()=>{i.length>0&&!a&&l(i[0].id)},[i,a]);const A=i.find(L=>L.id===a),[b,T]=P.useState(null),[w,E]=P.useState(!1),N=P.useRef(null),j=(L,G)=>{o(B=>B.map(Y=>Y.id===L?{...Y,...G}:Y))},F=L=>{const{name:G,value:B}=L.target;if(G.startsWith("filter.")){const Y=G.split(".")[1];s(re=>({...re,filters:{...re.filters,[Y]:B}}))}else s(Y=>({...Y,[G]:B}))},S=L=>{const G=Array.from(L.target.files);if(G.length===0)return;const B=G.map(Y=>Y.size>10*1024*1024?(alert(`nh ${Y.name} qu ln (>10MB).`),null):{id:Date.now()+Math.random().toString(),type:"image",url:URL.createObjectURL(Y),file:Y,products:[]}).filter(Boolean);o(Y=>[...Y,...B]),!a&&B.length>0&&l(B[0].id)},y=(L,G)=>{var Y;G.stopPropagation();const B=i.filter(re=>re.id!==L);o(B),a===L&&l(((Y=B[0])==null?void 0:Y.id)||null)},v=L=>{const G=L.target.files[0];if(G){if(G.size>5*1024*1024){alert("Avatar qu ln (>5MB).");return}m(G),k(URL.createObjectURL(G))}},C=L=>{if(!A||A.type!=="image")return;const G=N.current.getBoundingClientRect(),B=(L.clientX-G.left)/G.width*100,Y=(L.clientY-G.top)/G.height*100,re={id:Date.now().toString(),x:B,y:Y,name:"",price:"",link:""};T(re),E(!0)},R=(L,G)=>{L.stopPropagation(),T(G),E(!0)},D=()=>{if(!b.name)return alert("Vui lng nhp tn sn phm");const L=A.products||[],G=L.find(Y=>Y.id===b.id);let B;G?B=L.map(Y=>Y.id===b.id?b:Y):B=[...L,b],j(a,{products:B}),T(null),E(!1)},x=()=>{const G=(A.products||[]).filter(B=>B.id!==b.id);j(a,{products:G}),T(null),E(!1)},le=(L,G=2560,B=.95)=>new Promise(Y=>{const re=new FileReader;re.readAsDataURL(L),re.onload=xe=>{const Se=new Image;Se.src=xe.target.result,Se.onload=()=>{const Ne=document.createElement("canvas"),Kt=Ne.getContext("2d"),we=G,tt=G;let at=Se.width,H=Se.height;at>H?at>we&&(H*=we/at,at=we):H>tt&&(at*=tt/H,H=tt),Ne.width=at,Ne.height=H,Kt.drawImage(Se,0,0,at,H),Y(Ne.toDataURL("image/jpeg",B))}}}),me=async L=>{var G,B,Y;L.preventDefault(),console.log(" Form submission started"),d(!0);try{if(i.length===0){alert("Vui lng thm t nht mt nh hoc video!"),d(!1);return}console.log(" Processing media uploads...");let re=_;if(p)try{console.log(" Uploading avatar...");const we=await le(p,500),tt=await(await fetch(we)).blob(),at=new File([tt],"avatar.jpg",{type:"image/jpeg"});re=await yt.uploadFile(at),console.log(" Avatar uploaded:",re)}catch(we){console.error(" Avatar upload failed:",we);try{re=await le(p,300)}catch(tt){console.error("Avatar compression failed:",tt),re="https://ui-avatars.com/api/?name="+encodeURIComponent(r.authorName||"User")}}const xe=await Promise.all(i.map(async we=>{if(we.file)try{console.log(` Compressing image: ${we.file.name}`);const tt=await le(we.file,2560,.92),at=await(await fetch(tt)).blob(),H=new File([at],we.file.name.replace(/\.[^/.]+$/,"")+".jpg",{type:"image/jpeg"});console.log(` Starting upload (Compressed): ${(H.size/1024).toFixed(0)} KB`);let Ee=null,Et=null;for(let pt=1;pt<=3;pt++)try{console.log(` Upload attempt ${pt}/3...`);const J=yt.uploadFile(H),Ge=new Promise((ji,Me)=>setTimeout(()=>Me(new Error("TIMEOUT")),6e4));Ee=await Promise.race([J,Ge]),console.log(` Image uploaded on attempt ${pt}: ${Ee}`);break}catch(J){Et=J,console.warn(` Attempt ${pt} failed:`,J.message),pt<3&&(console.log(" Waiting 2s before retry..."),await new Promise(Ge=>setTimeout(Ge,2e3)))}if(!Ee)throw new Error(`Upload tht bi sau 3 ln th: ${(Et==null?void 0:Et.message)||"Network error"}`);return{...we,url:Ee,file:null}}catch(tt){throw console.error(" Image upload failed:",tt),new Error(`Khng th ti nh "${we.file.name}": ${tt.message}`)}return we}));console.log(" Media processing complete:",xe);const Se=r.tags.split(",").map(we=>we.trim()).filter(we=>we),Ne=xe.filter(we=>we.type==="image").map(we=>({url:we.url,products:we.products||[]})),Kt={title:r.caption.substring(0,50)||"Setup",caption:r.caption,filters:r.filters,tags:Se,author:{name:r.authorName||"Anonymous",avatar:re||"https://ui-avatars.com/api/?name="+encodeURIComponent(r.authorName||"User")},images:Ne,media:xe,mainImage:((G=xe[0])==null?void 0:G.url)||"",image:((B=xe[0])==null?void 0:B.url)||"",products:((Y=Ne[0])==null?void 0:Y.products)||[],updatedAt:new Date().toISOString()};console.log(" Final setupData to save:",Kt),console.log(" Calling onSave..."),n!=null&&n.id?await e(n.id,Kt):await e(Kt),console.log(" onSave completed successfully")}catch(re){console.error(" Form submission error:",re),alert(re.message||"C li xy ra khi lu setup.")}finally{d(!1)}};return c.jsx("div",{className:"modal-overlay",onClick:t,children:c.jsxs("div",{className:"modal-content add-setup-modal",onClick:L=>L.stopPropagation(),children:[c.jsxs("div",{className:"modal-header",children:[c.jsx("h2",{children:n?"Chnh Sa Setup":"Thm Gc Setup Mi"}),c.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[h&&c.jsx("span",{style:{color:"var(--accent-color)"},children:" ang ti ln... Vui lng ch"}),c.jsx("button",{className:"close-btn",onClick:t,children:""})]})]}),c.jsx("div",{className:"add-setup-body",children:c.jsxs("form",{id:"setupForm",onSubmit:me,className:"setup-form-layout",children:[c.jsxs("div",{className:"form-column",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"M t"}),c.jsx("textarea",{name:"caption",value:r.caption,onChange:F,required:!0,placeholder:"M t v gc setup ny...",rows:"4"})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Media (nh/Video)"}),c.jsxs("div",{className:"media-gallery-preview",children:[i.map(L=>c.jsxs("div",{className:`media-thumb ${a===L.id?"active":""}`,onClick:()=>l(L.id),children:[L.type==="video"&&L.platform==="youtube"?c.jsxs(c.Fragment,{children:[c.jsx("img",{src:L.thumb||L.thumbnail,alt:"yt-thumb",style:{opacity:.8}}),c.jsx("div",{className:"video-icon",style:{fontSize:"12px"},children:""})]}):L.type==="video"?c.jsx("div",{className:"video-icon",children:""}):c.jsx("img",{src:L.url,alt:"thumb"}),c.jsx("button",{type:"button",className:"btn-remove-media",onClick:G=>y(L.id,G),children:""})]},L.id)),c.jsxs("label",{className:"add-media-btn",children:[c.jsx("input",{type:"file",multiple:!0,accept:"image/*,video/*",onChange:S,style:{display:"none"}}),c.jsx("span",{children:"+ Thm"})]})]}),c.jsx("small",{style:{display:"block",marginTop:"5px",color:"#888"},children:"H tr ti a 8 nh (Max 10MB/nh)."})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Tn ngi ng"}),c.jsx("input",{type:"text",name:"authorName",value:r.authorName,onChange:F,placeholder:"Nhp tn ngi ng..."})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Avatar ngi ng"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[_&&c.jsx("img",{src:_,alt:"Avatar preview",style:{width:"60px",height:"60px",borderRadius:"50%",objectFit:"cover",border:"2px solid var(--color-border)"}}),c.jsxs("label",{className:"btn btn-secondary",style:{cursor:"pointer",margin:0},children:[c.jsx("input",{type:"file",accept:"image/*",onChange:v,style:{display:"none"}}),_?"i Avatar":"Ti Avatar"]})]}),c.jsx("small",{style:{display:"block",marginTop:"5px",color:"#888"},children:"nh i din ca ngi ng (Max 5MB)"})]}),c.jsxs("div",{className:"form-row",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Tng mu"}),c.jsx("select",{name:"filter.colorTone",value:r.filters.colorTone,onChange:F,children:Ya.colorTone.map(L=>c.jsx("option",{value:L.value,children:L.label},L.value))})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Ngn sch"}),c.jsx("select",{name:"filter.budget",value:r.filters.budget,onChange:F,children:Ya.budget.map(L=>c.jsx("option",{value:L.value,children:L.label},L.value))})]})]}),c.jsxs("div",{className:"form-row",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Phong cch"}),c.jsx("select",{name:"filter.gender",value:r.filters.gender,onChange:F,children:Ya.gender.map(L=>c.jsx("option",{value:L.value,children:L.label},L.value))})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Mc ch"}),c.jsx("select",{name:"filter.purpose",value:r.filters.purpose,onChange:F,children:Ya.purpose.map(L=>c.jsx("option",{value:L.value,children:L.label},L.value))})]})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Tags (ngn cch bi du phy)"}),c.jsx("input",{type:"text",name:"tags",value:r.tags,onChange:F,placeholder:"gaming, minimal, rgb..."})]})]}),c.jsxs("div",{className:"form-column",children:[c.jsx("label",{style:{marginBottom:"0.5rem",display:"block",fontWeight:"500"},children:A?A.type==="video"||A.type==="youtube"?"Xem Video (Khng h tr gn th)":"Gn Th Sn Phm (Click vo nh)":"Xem trc"}),c.jsx("div",{className:"image-tagging-area",children:A?A.type==="video"?c.jsx("video",{src:A.url,controls:!0,className:"tagging-image",style:{maxHeight:"100%"}}):A.type==="youtube"?c.jsx("iframe",{width:"100%",height:"100%",src:A.url,title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,style:{aspectRatio:"16/9",borderRadius:"8px"}}):c.jsxs("div",{className:"image-wrapper",ref:N,onClick:C,children:[c.jsx("img",{src:A.url,alt:"Tagging Area",className:"tagging-image"}),A.products.map(L=>c.jsx("div",{className:`tag-marker ${(b==null?void 0:b.id)===L.id?"active":""}`,style:{left:`${L.x}%`,top:`${L.y}%`},onClick:G=>R(G,L),children:"+"},L.id)),b&&!A.products.find(L=>L.id===b.id)&&c.jsx("div",{className:"tag-marker active",style:{left:`${b.x}%`,top:`${b.y}%`},children:" + "}),w&&b&&c.jsxs("div",{className:"tag-popup",style:{left:`${Math.min(b.x,60)}%`,top:`${Math.min(b.y+5,80)}%`},onClick:L=>L.stopPropagation(),children:[c.jsx("h4",{children:A.products.find(L=>L.id===b.id)?"Sa Sn Phm":"Thm Sn Phm"}),c.jsx("div",{className:"form-group",children:c.jsx("input",{autoFocus:!0,placeholder:"Tn sn phm",value:b.name,onChange:L=>T({...b,name:L.target.value})})}),c.jsx("div",{className:"form-group",children:c.jsx("input",{placeholder:"Gi",value:b.price,onChange:L=>T({...b,price:L.target.value})})}),c.jsx("div",{className:"form-group",children:c.jsx("input",{placeholder:"Link (ty chn)",value:b.link,onChange:L=>T({...b,link:L.target.value})})}),c.jsxs("div",{className:"popup-actions",children:[c.jsx("button",{type:"button",className:"btn-small btn-delete",onClick:()=>{A.products.find(L=>L.id===b.id)?x():(T(null),E(!1))},children:"Xa"}),c.jsx("button",{type:"button",className:"btn-small btn-submit",onClick:D,children:"Lu"})]})]})]}):c.jsx("div",{className:"placeholder-text",children:"Chn hoc ti ln media  bt u custom"})})]})]})}),c.jsxs("div",{className:"form-actions",children:[c.jsx("button",{type:"button",className:"btn-cancel",onClick:t,children:"Hy"}),c.jsx("button",{type:"submit",form:"setupForm",className:"btn-submit",disabled:h,children:h?"ang Upload...":"ng Setup"})]})]})})},n6=()=>{const{setups:t,blogs:e,getComments:n,currentUser:r,addSetup:s,updateSetup:i,deleteSetup:o,refreshData:a}=Mt(),[l,h]=P.useState(null),[d,p]=P.useState(new Set),[m,_]=P.useState({startDate:"",endDate:""}),k=y=>{y.target.checked?p(new Set(t.map(v=>v.id))):p(new Set)},A=y=>{const v=new Set(d);v.has(y)?v.delete(y):v.add(y),p(v)},b=async()=>{if(d.size!==0&&confirm(`Bn c chc chn mun xa ${d.size} setup  chn khng?`))try{const y=Array.from(d).map(v=>o(v));await Promise.all(y),p(new Set),alert(" xa cc setup  chn!")}catch(y){console.error("Bulk delete failed:",y),alert("C li xy ra khi xa hng lot.")}},T=async(y,v)=>{if(v){const C=await i(y,v);C.success?(h(null),alert(" cp nht setup thnh cng!")):alert(C.message||"Li cp nht")}else{const C=await s(y);C.success?alert(" thm setup thnh cng!"):alert(C.message||"C li xy ra")}},w=y=>{h(y)},E=async(y,v)=>{if(window.confirm(`Bn c chc mun xa setup "${v}" khng?`)){const C=await o(y);C.success||alert(C.message||"Xa tht bi")}},N=y=>{if(!y)return!1;const v=new Date(y);if(m.startDate){const C=m.startDate.split("-"),R=new Date(C[0],C[1]-1,C[2],0,0,0,0);if(v<R)return!1}if(m.endDate){const C=m.endDate.split("-"),R=new Date(C[0],C[1]-1,C[2],23,59,59,999);if(v>R)return!1}return!0},j=P.useMemo(()=>{const y=t.filter(x=>N(x.createdAt)).length,v=e.filter(x=>N(x.publishedAt)).length;let C=0,R=0,D=0;return t.forEach(x=>{Array.isArray(x.likes)&&(C+=x.likes.filter(me=>typeof me=="object"?N(me.timestamp):!0).length),Array.isArray(x.saves)&&(R+=x.saves.filter(me=>typeof me=="object"?N(me.timestamp):!0).length);const le=n(x.id);D+=le.filter(me=>N(me.timestamp)).length}),{totalSetups:y,totalBlogs:v,totalLikes:C,totalSaves:R,totalComments:D}},[t,e,m,n]),F=P.useMemo(()=>t.map(y=>{const v=n(y.id),C=(y.likes||[]).filter(x=>typeof x=="object"?N(x.timestamp):!0).length,R=(y.saves||[]).filter(x=>typeof x=="object"?N(x.timestamp):!0).length,D=v.filter(x=>N(x.timestamp)).length;return{...y,rangeLikeCount:C,rangeSaveCount:R,rangeCommentCount:D,engagement:C*2+R*3+D*1}}).sort((y,v)=>v.engagement-y.engagement).slice(0,5),[t,m,n]),S=P.useMemo(()=>{const y={};return t.filter(C=>N(C.createdAt)).forEach(C=>{const R=C.filters.purpose||"Other";y[R]||(y[R]=0),y[R]++}),Object.entries(y).sort((C,R)=>R[1]-C[1])},[t,m]);return!r||r.role!=="admin"?c.jsx("div",{className:"admin-dashboard-error",children:"Access Denied"}):c.jsxs("div",{className:"admin-dashboard",children:[c.jsxs("header",{className:"dashboard-header",children:[c.jsxs("div",{children:[c.jsx("h1",{children:"Admin Dashboard"}),c.jsxs("p",{children:["Welcome back, ",r.displayName]})]}),c.jsxs("div",{className:"header-actions",style:{display:"flex",gap:"1rem",alignItems:"center"},children:[c.jsx("button",{className:"btn",onClick:async()=>{confirm("Ti li d liu t server/local?")&&(await a(),alert(" cp nht!"))},style:{background:"var(--bg-secondary)",color:"var(--text-primary)",padding:"0.5rem 1rem",borderRadius:"8px",border:"1px solid var(--border-color)",cursor:"pointer"},children:" Khi phc D liu"}),c.jsxs("div",{className:"dashboard-filter",children:[c.jsx("span",{className:"filter-label",children:"Lc:"}),c.jsx("input",{type:"date",className:"date-input",value:m.startDate,onChange:y=>_(v=>({...v,startDate:y.target.value}))}),c.jsx("span",{className:"filter-separator",children:"-"}),c.jsx("input",{type:"date",className:"date-input",value:m.endDate,onChange:y=>_(v=>({...v,endDate:y.target.value}))}),(m.startDate||m.endDate)&&c.jsx("button",{className:"btn-clear",onClick:()=>_({startDate:"",endDate:""}),children:""})]})]})]}),c.jsxs("div",{className:"stats-grid",children:[c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Tng Lt Thch"}),c.jsx("div",{className:"stat-value",children:j.totalLikes}),c.jsxs("div",{className:"stat-trend positive",children:[" ",m.startDate||m.endDate?"Trong khong":"Tt c"]})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Tng Lt Lu"}),c.jsx("div",{className:"stat-value",children:j.totalSaves}),c.jsxs("div",{className:"stat-trend positive",children:[" ",m.startDate||m.endDate?"Trong khong":"Tt c"]})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Tng Bnh Lun"}),c.jsx("div",{className:"stat-value",children:j.totalComments}),c.jsx("div",{className:"stat-trend",children:" Tho lun"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Tng Setup Mi"}),c.jsx("div",{className:"stat-value",children:j.totalSetups}),c.jsx("div",{className:"stat-trend",children:" Bi ng"})]})]}),c.jsxs("div",{className:"dashboard-layout",children:[c.jsxs("div",{className:"dashboard-section manage-section",children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[c.jsxs("h2",{children:[" Qun L Tt C Setup (",t.length,")"]}),d.size>0&&c.jsxs("div",{className:"bulk-actions",style:{margin:0},children:[c.jsxs("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:[" chn ",d.size]}),c.jsxs("button",{onClick:b,className:"btn-bulk-delete",children:[" Xa ",d.size," Setup"]})]})]}),c.jsx("div",{className:"ranking-table-wrapper",style:{maxHeight:"400px",overflowY:"auto"},children:c.jsxs("table",{className:"ranking-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{className:"checkbox-col",children:c.jsx("input",{type:"checkbox",className:"custom-checkbox",checked:t.length>0&&d.size===t.length,onChange:k})}),c.jsx("th",{children:"Setup"}),c.jsx("th",{children:"Ngy to"}),c.jsx("th",{children:"Thng k (Like/Save/Cmt)"}),c.jsx("th",{children:"Hnh ng"})]})}),c.jsx("tbody",{children:t.map(y=>{var v,C;return c.jsxs("tr",{style:{background:d.has(y.id)?"var(--bg-secondary)":"transparent"},children:[c.jsx("td",{className:"checkbox-col",children:c.jsx("input",{type:"checkbox",className:"custom-checkbox",checked:d.has(y.id),onChange:()=>A(y.id)})}),c.jsx("td",{children:c.jsxs("div",{className:"setup-cell",children:[c.jsx("img",{src:y.mainImage,alt:"",className:"setup-thumb"}),c.jsx("span",{className:"setup-title",title:y.title,children:y.title})]})}),c.jsx("td",{children:new Date(y.createdAt).toLocaleDateString("vi-VN")}),c.jsxs("td",{children:[((v=y.likes)==null?void 0:v.length)||0," / ",((C=y.saves)==null?void 0:C.length)||0," / ",y.comments||0]}),c.jsxs("td",{children:[c.jsx("button",{className:"btn-edit",onClick:()=>w(y),title:"Sa setup ny",style:{marginRight:"0.5rem",background:"none",border:"none",cursor:"pointer",fontSize:"1.2rem"},children:""}),c.jsx("button",{className:"btn-delete",onClick:()=>E(y.id,y.title),title:"Xa setup ny",children:""})]})]},y.id)})})]})})]}),c.jsxs("div",{className:"dashboard-section ranking-section",children:[c.jsx("h2",{children:" BXH Tng Tc Top 5"}),c.jsx("div",{className:"ranking-table-wrapper",children:c.jsxs("table",{className:"ranking-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Rank"}),c.jsx("th",{children:"Setup"}),c.jsx("th",{children:"im"})]})}),c.jsx("tbody",{children:F.map((y,v)=>c.jsxs("tr",{children:[c.jsx("td",{children:c.jsxs("span",{className:`rank-badge rank-${v+1}`,children:["#",v+1]})}),c.jsx("td",{children:c.jsxs("div",{className:"setup-cell",children:[c.jsx("img",{src:y.mainImage,alt:"",className:"setup-thumb"}),c.jsx("span",{className:"setup-title",children:y.title})]})}),c.jsx("td",{children:c.jsx("strong",{children:y.engagement})})]},y.id))})]})})]}),c.jsxs("div",{className:"dashboard-section insights-section",children:[c.jsx("h2",{children:" Xu Hng"}),c.jsxs("div",{className:"insights-card",children:[c.jsx("h3",{children:"Danh Mc Ph Bin"}),S.length>0?c.jsx("ul",{className:"category-list",children:S.map(([y,v])=>c.jsxs("li",{className:"category-item",children:[c.jsx("span",{className:"category-name",children:y.replace("-"," ")}),c.jsx("div",{className:"progress-bar",children:c.jsx("div",{className:"progress-fill",style:{width:`${v/j.totalSetups*100}%`}})}),c.jsx("span",{className:"category-count",children:v})]},y))}):c.jsx("p",{className:"no-data",children:"Khng c d liu."})]})]})]}),l&&c.jsx(Qk,{initialData:l,onClose:()=>h(null),onSave:T})]})},r6=()=>{const{showAuthModal:t,setShowAuthModal:e}=Mt(),[n,r]=P.useState("login"),[s,i]=P.useState(""),[o,a]=P.useState(""),[l,h]=P.useState(""),[d,p]=P.useState(""),[m,_]=P.useState(""),[k,A]=P.useState(!1),[b,T]=P.useState("");if(!t)return null;const w=()=>{e(!1),_(""),i(""),a(""),h(""),p("")},E=async N=>{N.preventDefault(),_(""),T(""),A(!0);try{if(n==="login")await yt.login(s,o),T("ng nhp thnh cng!"),setTimeout(()=>{w(),T(""),A(!1)},500);else{if(!l){_("Vui lng nhp tn hin th"),A(!1);return}await yt.register({email:s,password:o,displayName:l,username:d}),T("ng k thnh cng!"),setTimeout(()=>{w(),T(""),A(!1)},500)}}catch(j){console.error(j),A(!1),j.code==="auth/wrong-password"||j.code==="auth/user-not-found"||j.code==="auth/invalid-credential"?_("Email hoc mt khu khng ng"):j.code==="auth/email-already-in-use"?_("Email  c s dng"):_(" c li xy ra: "+j.message)}};return c.jsx("div",{className:"modal-overlay",onClick:N=>N.target===N.currentTarget&&w(),children:c.jsxs("div",{className:"auth-modal modal-content",children:[c.jsx("button",{className:"modal-close-btn",onClick:w,children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),c.jsxs("div",{className:"auth-content",children:[c.jsx("h2",{children:n==="login"?"ng Nhp":"ng K"}),c.jsx("p",{className:"auth-subtitle",children:n==="login"?"ng nhp  lu setup yu thch v vit bnh lun":"To ti khon mi  tham gia cng ng DeskHub"}),m&&c.jsx("div",{className:"auth-error",children:m}),b&&c.jsx("div",{className:"auth-error",style:{color:"#059669",borderColor:"#059669",backgroundColor:"#ecfdf5"},children:b}),c.jsxs("form",{onSubmit:E,className:"auth-form",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Email"}),c.jsx("input",{type:"email",className:"input",value:s,onChange:N=>i(N.target.value),placeholder:"name@example.com",required:!0})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Mt khu"}),c.jsx("input",{type:"password",className:"input",value:o,onChange:N=>a(N.target.value),placeholder:"",required:!0,minLength:6})]}),n==="register"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Tn hin th"}),c.jsx("input",{type:"text",className:"input",value:l,onChange:N=>h(N.target.value),placeholder:"Tn ca bn",required:!0})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Username"}),c.jsx("input",{type:"text",className:"input",value:d,onChange:N=>p(N.target.value),placeholder:"username",required:!0,pattern:"[a-zA-Z0-9_-]+",title:"Ch cha ch ci, s, gch ngang v gch di"})]})]}),c.jsx("button",{type:"submit",className:"btn btn-primary auth-submit",disabled:k,style:{opacity:k?.7:1,cursor:k?"wait":"pointer"},children:k?"ang x l...":n==="login"?"ng Nhp":"ng K"})]}),c.jsx("div",{className:"auth-switch",children:n==="login"?c.jsxs("p",{children:["Cha c ti khon?"," ",c.jsx("button",{onClick:()=>r("register"),className:"link-btn",children:"ng k ngay"})]}):c.jsxs("p",{children:[" c ti khon?"," ",c.jsx("button",{onClick:()=>r("login"),className:"link-btn",children:"ng nhp"})]})}),c.jsx("div",{className:"auth-divider",children:c.jsx("span",{children:"hoc"})}),c.jsx("button",{className:"btn btn-secondary",onClick:w,children:"Tip tc vi ti khon Khch"}),c.jsx("p",{className:"auth-note",children:c.jsx("small",{children:"Ti khon Khch s dng IP my  lu d liu. D liu s c gi trn thit b ny."})})]})]})})},s6=()=>{const{showProfileModal:t,setShowProfileModal:e,refreshUser:n,currentUser:r,logout:s}=Mt(),[i,o]=P.useState((r==null?void 0:r.displayName)||""),[a,l]=P.useState((r==null?void 0:r.avatar)||""),[h,d]=P.useState("");if(!t)return null;const p=()=>{e(!1),d("")},m=async A=>{if(A.preventDefault(),d(""),r!=null&&r.isGuest)ZP(i),n(),d(" cp nht tn hin th!"),setTimeout(()=>p(),1500);else try{const b=a&&a.startsWith("data:");if(ko.currentUser){const w={displayName:i};b||(w.photoURL=a),await mk(ko.currentUser,w)}const T=Gt(ut,"users",r.id);await Kr(T,{displayName:i,avatar:a}),d("Cp nht thnh cng! ang ti li..."),setTimeout(()=>window.location.reload(),500)}catch(b){console.error(b),d("Li: "+b.message)}},_=A=>{const b=A.target.files[0];if(b){if(b.size>2e6)return alert("File qu ln (>2MB)");const T=new FileReader;T.onloadend=()=>{l(T.result)},T.readAsDataURL(b)}},k=async()=>{confirm("Bn c chc mun ng xut?")&&(await s(),p())};return c.jsx("div",{className:"modal-overlay",onClick:A=>A.target===A.currentTarget&&p(),children:c.jsxs("div",{className:"profile-modal modal-content",children:[c.jsx("button",{className:"modal-close-btn",onClick:p,children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),c.jsxs("div",{className:"profile-content",children:[c.jsxs("div",{className:"profile-header",children:[c.jsx("img",{src:r==null?void 0:r.avatar,alt:r==null?void 0:r.displayName,className:"profile-avatar-large"}),c.jsx("h2",{children:r==null?void 0:r.displayName}),c.jsx("p",{className:"profile-role",children:r!=null&&r.isGuest?" Ti khon Khch":" Thnh vin"})]}),h&&c.jsx("div",{className:"profile-message success",children:h}),r!=null&&r.isGuest?c.jsxs("form",{onSubmit:m,className:"profile-form",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Tn hin th"}),c.jsx("input",{type:"text",className:"input",value:i,onChange:A=>o(A.target.value),placeholder:"Tn ca bn",required:!0})]}),c.jsx("button",{type:"submit",className:"btn btn-primary",children:"Lu Thay i"})]}):c.jsxs("form",{onSubmit:m,className:"profile-form",children:[c.jsxs("div",{className:"form-group profile-avatar-edit",children:[c.jsx("label",{children:"nh i Din"}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("img",{src:a||r.photoURL,style:{width:"60px",height:"60px",borderRadius:"50%",objectFit:"cover",border:"2px solid var(--border-color)"},alt:"Avatar"}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"avatar-upload",className:"btn btn-primary",style:{padding:"0.4rem 0.8rem",fontSize:"0.85rem"},children:"Thay i"}),c.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",onChange:_,style:{display:"none"}})]})]})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Tn hin th"}),c.jsx("input",{type:"text",className:"input",value:i,onChange:A=>o(A.target.value),placeholder:"Tn ca bn",required:!0})]}),c.jsxs("div",{className:"profile-info-readonly",style:{margin:"1rem 0",opacity:.8,fontSize:"0.9rem",background:"var(--bg-secondary)",padding:"0.75rem",borderRadius:"8px"},children:[c.jsxs("div",{style:{marginBottom:"0.5rem"},children:[c.jsx("strong",{children:"Email:"})," ",r.email]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Vai tr:"})," ",(r==null?void 0:r.role)==="admin"?"Qun tr vin":"Thnh vin"]})]}),c.jsx("button",{type:"submit",className:"btn btn-primary",style:{width:"100%"},children:"Lu Thay i"})]}),!(r!=null&&r.isGuest)&&c.jsx("button",{className:"btn btn-secondary logout-btn",onClick:k,children:"ng Xut"}),c.jsx("div",{className:"profile-note",children:c.jsx("small",{children:r!=null&&r.isGuest?"D liu ca bn c lu trn thit b ny. To ti khon  ng b trn nhiu thit b.":"Ti khon ca bn  c ng k v c th s dng trn nhiu thit b."})})]})]})})},i6=()=>{const{showNewsletterModal:t,setShowNewsletterModal:e,subscribeNewsletter:n}=Mt(),[r,s]=P.useState(""),[i,o]=P.useState(""),[a,l]=P.useState(""),[h,d]=P.useState(!1);if(!t)return null;const p=()=>{e(!1),s(""),o(""),l(""),d(!1)},m=async _=>{_.preventDefault();try{(await n({email:r,name:i})).success?(l("ng k thnh cng! Cm n bn."),d(!0),setTimeout(()=>{p()},2e3)):(l(" c li xy ra. Vui lng th li."),d(!1))}catch(k){l("Li: "+k.message),d(!1)}};return c.jsx("div",{className:"modal-overlay",onClick:_=>_.target===_.currentTarget&&p(),children:c.jsxs("div",{className:"newsletter-modal modal-content",children:[c.jsx("button",{className:"modal-close-btn",onClick:p,children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),c.jsxs("div",{className:"newsletter-content",children:[c.jsx("div",{className:"newsletter-icon",children:c.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",children:[c.jsx("circle",{cx:"32",cy:"32",r:"30",fill:"url(#newsletter-gradient)",opacity:"0.1"}),c.jsx("path",{d:"M16 24l16 12 16-12M16 24v24h32V24M16 24h32",stroke:"url(#newsletter-gradient)",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("defs",{children:c.jsxs("linearGradient",{id:"newsletter-gradient",x1:"0",y1:"0",x2:"64",y2:"64",children:[c.jsx("stop",{offset:"0%",stopColor:"hsl(220, 90%, 56%)"}),c.jsx("stop",{offset:"100%",stopColor:"hsl(280, 70%, 60%)"})]})})]})}),c.jsx("h2",{children:"ng K Newsletter"}),c.jsx("p",{className:"newsletter-subtitle",children:"Nhn nhng setup p nht mi tun v tips thit k workspace t DeskHub"}),a&&c.jsx("div",{className:`newsletter-message ${h?"success":"error"}`,children:a}),c.jsxs("form",{onSubmit:m,className:"newsletter-form",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Tn ca bn"}),c.jsx("input",{type:"text",className:"input",value:i,onChange:_=>o(_.target.value),placeholder:"Nguyn Vn A",required:!0})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Email"}),c.jsx("input",{type:"email",className:"input",value:r,onChange:_=>s(_.target.value),placeholder:"email@example.com",required:!0})]}),c.jsxs("button",{type:"submit",className:"btn btn-primary newsletter-submit",children:[c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:c.jsx("path",{d:"M18 2L9 11M18 2l-7 16-2-7-7-2 16-7z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"ng K Ngay"]})]}),c.jsx("p",{className:"newsletter-note",children:c.jsx("small",{children:"Chng ti s gi email mi tun v nhng setup c bnh chn p nht. Bn c th hy ng k bt c lc no."})})]})]})})},o6=()=>{const{showCollectionsModal:t,setShowCollectionsModal:e,getSavedSetups:n,setSelectedSetup:r}=Mt();if(!t)return null;const s=n(),i=()=>{e(!1)},o=a=>{r(a),i()};return c.jsx("div",{className:"modal-overlay",onClick:a=>a.target===a.currentTarget&&i(),children:c.jsxs("div",{className:"collections-modal modal-content",children:[c.jsx("button",{className:"modal-close-btn",onClick:i,children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),c.jsxs("div",{className:"collections-content",children:[c.jsxs("div",{className:"collections-header",children:[c.jsx("h2",{children:"Setup  Lu"}),c.jsxs("p",{className:"collections-count",children:[s.length," setup"]})]}),s.length===0?c.jsxs("div",{className:"collections-empty",children:[c.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[c.jsx("circle",{cx:"60",cy:"60",r:"50",stroke:"var(--color-border)",strokeWidth:"2"}),c.jsx("path",{d:"M50 40h20a5 5 0 015 5v40l-15-8-15 8V45a5 5 0 015-5z",stroke:"var(--color-text-tertiary)",strokeWidth:"2"})]}),c.jsx("h3",{children:"Cha c setup no"}),c.jsx("p",{children:"Bm vo biu tng  trn cc setup  lu vo b su tp ca bn"})]}):c.jsx("div",{className:"collections-grid",children:s.map(a=>{var l;return c.jsxs("div",{className:"collection-item",onClick:()=>o(a),children:[c.jsx("div",{className:"collection-item-image",children:c.jsx("img",{src:a.mainImage,alt:a.title})}),c.jsxs("div",{className:"collection-item-content",children:[c.jsx("h4",{children:a.title}),c.jsx("p",{children:a.caption}),c.jsxs("div",{className:"collection-item-meta",children:[c.jsxs("span",{children:[" ",((l=a.likes)==null?void 0:l.length)||0]}),c.jsxs("span",{children:[" ",a.comments||0]})]})]})]},a.id)})})]})]})})},a6=({product:t,isActive:e,onActivate:n})=>{const[r,s]=P.useState(!1);P.useEffect(()=>{const o=()=>s(window.innerWidth<=768);return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]);const i=o=>{o.stopPropagation(),n(e?null:t)};return c.jsxs("div",{className:"product-marker",style:{left:`${t.x}%`,top:`${t.y}%`},onClick:i,children:[c.jsx("button",{className:`marker-btn ${e?"active":""}`,children:c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[c.jsx("circle",{cx:"10",cy:"10",r:"8",fill:"var(--color-primary)"}),c.jsx("path",{d:"M10 6v8M6 10h8",stroke:"white",strokeWidth:"2",strokeLinecap:"round"})]})}),!r&&e&&c.jsxs("div",{className:"product-tooltip-desktop",style:{position:"absolute",left:"50%",bottom:"100%",transform:"translateX(-50%) translateY(-8px)",marginBottom:"8px",background:"white",color:"#333",padding:"16px",borderRadius:"12px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.15), 0 2px 8px rgba(0, 0, 0, 0.1)",minWidth:"280px",maxWidth:"320px",zIndex:1e4,animation:"fadeIn 0.2s ease-out",border:"1px solid rgba(0, 0, 0, 0.08)"},onClick:o=>o.stopPropagation(),children:[c.jsx("h3",{style:{fontSize:"15px",fontWeight:600,color:"#333",margin:"0 0 8px 0",lineHeight:"1.4"},children:t.name}),c.jsx("div",{style:{fontSize:"24px",fontWeight:700,color:"#ff6b35",margin:"0 0 12px 0",lineHeight:"1.2"},children:t.price}),t.link&&c.jsxs("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"14px",fontWeight:600,color:"white",textDecoration:"none",background:"linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%)",padding:"10px 20px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",boxShadow:"0 4px 12px rgba(255, 107, 53, 0.3)",transition:"all 0.2s",border:"none"},children:[c.jsx("span",{children:"Xem sn phm"}),c.jsx("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"none",children:c.jsx("path",{d:"M6 3L11 8L6 13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),c.jsx("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderTop:"8px solid white"}})]})]})},l6=()=>{var pt;const{setupId:t}=bg(),e=iu(),{setups:n,toggleLike:r,toggleSave:s,addComment:i,getComments:o,hasUserLiked:a,hasUserSaved:l,getSimilarSetups:h,currentUser:d,setShowAuthModal:p,loading:m}=Mt(),[_,k]=P.useState(0),[A,b]=P.useState(""),[T,w]=P.useState(!0),[E,N]=P.useState(null),[j,F]=P.useState(!1),[S,y]=P.useState(!1),[v,C]=P.useState(null),[R,D]=P.useState(null),[x,le]=P.useState(!1),[me,et]=P.useState(1),[ot,K]=P.useState(!1),se=50,L=n.find(J=>J.id===t);if(m&&!L)return c.jsx("div",{className:"setup-detail-page",style:{paddingTop:"100px",display:"flex",justifyContent:"center"},children:c.jsx("div",{style:{color:"var(--color-text-primary)"},children:"Loading..."})});if(!L)return c.jsxs("div",{className:"setup-not-found",children:[c.jsx("h2",{children:"Setup khng tn ti"}),c.jsx("button",{onClick:()=>e("/"),children:"Quay v trang ch"})]});const G=((pt=L.images)==null?void 0:pt.length)>0?[...L.images.map(J=>({type:"image",url:J.url,products:J.products||[]})),...L.youtubeVideo?[{type:"youtube",url:L.youtubeVideo,poster:L.mainImage}]:[]]:[{type:"image",url:L.mainImage,products:L.products||[]},...(L.moreImages||[]).map(J=>({type:"image",url:J})),...L.youtubeVideo?[{type:"youtube",url:L.youtubeVideo,poster:L.mainImage}]:[]],B=G[_]||G[0],Y=a(L.id),re=l(L.id),xe=o(L.id),Se=h(L.id,16);P.useEffect(()=>{const J=()=>F(window.innerWidth<=768);return J(),window.addEventListener("resize",J),()=>window.removeEventListener("resize",J)},[]),P.useEffect(()=>{j&&L&&G.length>1&&(localStorage.getItem("hasSeenSwipeHint")||(y(!0),setTimeout(()=>{y(!1),localStorage.setItem("hasSeenSwipeHint","true")},3e3)))},[j,L,G.length]);const Ne=J=>{D(null),C(J.targetTouches[0].clientX)},Kt=J=>{D(J.targetTouches[0].clientX)},we=()=>{if(!v||!R)return;const J=v-R,Ge=J>se,ji=J<-se;Ge&&_<G.length-1&&k(Me=>Me+1),ji&&_>0&&k(Me=>Me-1)},tt=()=>{if(!d){p(!0);return}r(L.id)},at=()=>{if(!d){p(!0);return}s(L.id)},H=J=>{if(J.preventDefault(),!d){p(!0);return}A.trim()&&(i(L.id,{text:A,author:d.displayName,userId:d.id,avatar:d.photoURL}),b(""))},Ee=()=>{E&&N(null)},Et={"@context":"https://schema.org","@type":"Article",headline:L.title,image:L.mainImage,author:{"@type":"Person",name:L.author},datePublished:L.createdAt};return c.jsxs(c.Fragment,{children:[c.jsx(Su,{title:`${L.title} | DeskHub`,description:L.caption,image:L.mainImage,type:"article",schema:Et}),c.jsxs("div",{className:"setup-detail-page",children:[S&&j&&c.jsxs("div",{className:"swipe-hint-popup",children:[c.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M9 18l6-6-6-6",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),c.jsx("p",{children:"Vut  xem nh tip theo"})]}),c.jsxs("div",{className:"setup-content",children:[c.jsxs("div",{className:"setup-left-column",children:[c.jsx("div",{className:"setup-gallery-section",children:c.jsxs("div",{className:"setup-main-image-container",onTouchStart:j?Ne:void 0,onTouchMove:j?Kt:void 0,onTouchEnd:j?we:void 0,onClick:Ee,onMouseEnter:()=>!j&&K(!0),onMouseLeave:()=>!j&&K(!1),children:[c.jsx("button",{className:"back-btn",onClick:()=>e(-1),"aria-label":"Quay li",children:c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),c.jsx("img",{src:B.url,alt:L.title,className:"setup-main-image",style:{transform:`scale(${me})`,transition:"transform 0.2s ease"}}),T&&B.products&&B.products.map((J,Ge)=>c.jsx(a6,{product:J,isActive:E===J,onActivate:N},Ge)),B.products&&B.products.length>0&&c.jsx("button",{className:"toggle-products-btn",onClick:J=>{J.stopPropagation(),w(!T)},children:c.jsx("div",{className:"toggle-content",children:c.jsx("span",{children:T?"n sn phm":"Hin sn phm"})})}),!j&&ot&&c.jsxs("div",{className:"zoom-controls",children:[c.jsx("button",{className:"zoom-btn",onClick:J=>{J.stopPropagation(),et(Ge=>Math.min(Ge+.25,3))},title:"Phng to",children:c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[c.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),c.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),c.jsx("button",{className:"zoom-btn",onClick:J=>{J.stopPropagation(),et(Ge=>Math.max(Ge-.25,.5))},title:"Thu nh",children:c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:c.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})}),me!==1&&c.jsxs("button",{className:"zoom-btn zoom-reset",onClick:J=>{J.stopPropagation(),et(1)},title:"Reset",children:[Math.round(me*100),"%"]})]}),!j&&G.length>1&&c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"nav-arrow prev",onClick:()=>k(J=>Math.max(0,J-1)),disabled:_===0,children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),c.jsx("button",{className:"nav-arrow next",onClick:()=>k(J=>Math.min(G.length-1,J+1)),disabled:_===G.length-1,children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M9 18l6-6-6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),G.length>1&&c.jsx("div",{className:"image-pagination-dots",children:G.map((J,Ge)=>c.jsx("button",{className:`pagination-dot ${Ge===_?"active":""}`,onClick:()=>k(Ge)},Ge))})]})}),c.jsxs("div",{className:"setup-details-section",children:[c.jsxs("div",{className:"setup-header-row",children:[c.jsxs("div",{className:"setup-author-simple",children:[c.jsx("img",{src:typeof L.author=="object"?L.author.avatar:L.avatar,alt:typeof L.author=="object"?L.author.name:L.author,className:"author-avatar-small"}),c.jsx("span",{className:"author-name-simple",children:typeof L.author=="object"?L.author.name:L.author})]}),c.jsxs("div",{className:"setup-actions-row",children:[c.jsx("button",{className:`action-btn-icon ${Y?"active":""}`,onClick:tt,title:"Thch",children:c.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:Y?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})}),c.jsx("button",{className:`action-btn-icon ${re?"active":""}`,onClick:at,title:"Lu",children:c.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:re?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}),c.jsx("button",{className:"action-btn-icon",title:"Chia s",onClick:()=>{navigator.share?navigator.share({title:L.title,text:L.caption,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),alert(" copy link!"))},children:c.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("circle",{cx:"18",cy:"5",r:"3"}),c.jsx("circle",{cx:"6",cy:"12",r:"3"}),c.jsx("circle",{cx:"18",cy:"19",r:"3"}),c.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),c.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]})})]})]}),c.jsx("p",{className:"setup-caption",children:L.caption}),L.tags&&L.tags.length>0&&c.jsx("div",{className:"setup-tags",children:L.tags.map((J,Ge)=>c.jsxs("span",{className:"setup-tag",children:["#",J]},Ge))}),c.jsxs("div",{className:"comments-section",children:[c.jsxs("h4",{children:["Bnh lun (",xe.length,")"]}),c.jsxs("form",{className:"comment-form",onSubmit:H,children:[c.jsx("input",{type:"text",placeholder:"Thm bnh lun...",value:A,onChange:J=>b(J.target.value),className:"comment-input"}),c.jsx("button",{type:"submit",className:"btn-primary",children:"Gi"})]}),c.jsx("div",{className:"comments-list",children:xe.length===0?c.jsx("p",{className:"no-comments",children:"Cha c bnh lun no"}):c.jsxs(c.Fragment,{children:[xe.slice(0,x?xe.length:2).map(J=>c.jsxs("div",{className:"comment",children:[c.jsx("img",{src:J.avatar,alt:J.author,className:"comment-avatar"}),c.jsxs("div",{className:"comment-content",children:[c.jsx("p",{className:"comment-author",children:J.author}),c.jsx("p",{className:"comment-text",children:J.text})]})]},J.id)),xe.length>2&&!x&&c.jsxs("button",{className:"show-more-comments",onClick:()=>le(!0),children:["Xem thm ",xe.length-2," bnh lun"]})]})})]}),j&&Se.length>0&&c.jsx("div",{className:"similar-setups-section mobile-similar",children:c.jsx("div",{className:"similar-setups-grid",children:Se.slice(0,6).map(J=>c.jsx("div",{className:"similar-setup-card",onClick:()=>e(`/setup/${J.id}`),children:c.jsx("img",{src:J.mainImage,alt:J.title})},J.id))})})]})]}),!j&&Se.length>0&&c.jsx("div",{className:"setup-right-column",children:c.jsx("div",{className:"similar-setups-section-desktop",children:c.jsx("div",{className:"similar-setups-grid-desktop",children:Se.map(J=>c.jsx("div",{className:"similar-setup-card",onClick:()=>e(`/setup/${J.id}`),children:c.jsx("img",{src:J.mainImage,alt:J.title})},J.id))})})})]})]}),j&&E&&jI.createPortal(c.jsxs("div",{className:"product-tooltip-portal",style:{position:"fixed",bottom:"20px",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:"380px",background:"rgba(20, 20, 20, 0.95)",backdropFilter:"blur(12px)",color:"white",border:"1px solid rgba(255, 255, 255, 0.1)",padding:"20px",zIndex:1e5,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",borderRadius:"16px",display:"flex",flexDirection:"column",gap:"12px",animation:"slideUpFade 0.3s ease-out"},onClick:J=>J.stopPropagation(),children:[c.jsx("button",{style:{position:"absolute",top:"12px",right:"12px",background:"rgba(255, 255, 255, 0.1)",border:"none",color:"rgba(255, 255, 255, 0.7)",fontSize:"20px",width:"32px",height:"32px",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>N(null),children:""}),c.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"white",margin:"0 24px 0 0",lineHeight:"1.4"},children:E.name}),c.jsx("div",{style:{fontSize:"28px",fontWeight:700,color:"#ff6b35",margin:"4px 0",lineHeight:"1.2"},children:E.price}),E.link&&c.jsxs("a",{href:E.link,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"15px",fontWeight:600,color:"white",textDecoration:"none",background:"linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%)",padding:"14px 24px",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"8px",boxShadow:"0 4px 12px rgba(255, 107, 53, 0.4)"},children:[c.jsx("span",{children:"Xem sn phm"}),c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:c.jsx("path",{d:"M6 3L11 8L6 13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})]}),document.body)]})},Jf=()=>c.jsxs("div",{className:"gallery-layout",children:[c.jsx("div",{className:"desktop-sidebar-wrapper",children:c.jsx(Gk,{})}),c.jsx("div",{className:"gallery-content",children:c.jsx(X4,{})})]}),u6=()=>{const{subscribeNewsletter:t}=Mt(),[e,n]=P.useState(""),[r,s]=P.useState("idle"),i=async o=>{o.preventDefault(),s("loading"),(await t({email:e})).success?(s("success"),n(""),setTimeout(()=>s("idle"),3e3)):(s("error"),setTimeout(()=>s("idle"),3e3))};return c.jsxs("div",{className:"footer-newsletter",children:[c.jsx("p",{className:"newsletter-label",children:" Nhn tin mi:"}),c.jsxs("form",{className:"newsletter-inline-form",onSubmit:i,children:[c.jsx("input",{type:"email",placeholder:"Email ca bn...",value:e,onChange:o=>n(o.target.value),required:!0,disabled:r==="loading"||r==="success"}),c.jsx("button",{type:"submit",className:`btn-newsletter-small ${r}`,disabled:r==="loading",children:r==="loading"?"...":r==="success"?"":"ng k"})]})]})},c6=()=>{const{selectedSetup:t,showAddSetupModal:e,setShowAddSetupModal:n,addSetup:r,setShowNewsletterModal:s}=Mt(),i=Nr();P.useEffect(()=>{window.scrollTo(0,0)},[i.pathname]);const o=async a=>{console.log(" App.handleSaveSetup called with:",a);const l=await r(a);console.log(" App.handleSaveSetup response:",l),l.success?(n(!1),alert(" thm setup thnh cng!")):alert(`Li: ${l.message||"C li xy ra"}`)};return c.jsxs("div",{className:"app",children:[c.jsx(K4,{}),c.jsx("main",{className:"main-content",children:c.jsxs(zR,{children:[c.jsx(Hn,{path:"/",element:c.jsx(Jf,{})}),c.jsx(Hn,{path:"/gallery",element:c.jsx(Jf,{})}),c.jsx(Hn,{path:"/setup/:setupId",element:c.jsx(l6,{})}),c.jsx(Hn,{path:"/blog",element:c.jsx(e6,{})}),c.jsx(Hn,{path:"/blog/:slug",element:c.jsx(t6,{})}),c.jsx(Hn,{path:"/blog/new",element:c.jsx(wE,{})}),c.jsx(Hn,{path:"/blog/edit/:id",element:c.jsx(wE,{})}),c.jsx(Hn,{path:"/admin",element:c.jsx(n6,{})}),c.jsx(Hn,{path:"*",element:c.jsx(Jf,{})})]})}),c.jsx("div",{className:"mobile-filter-wrapper",children:c.jsx(Gk,{})}),t&&c.jsx(Y4,{}),e&&c.jsx(Qk,{onClose:()=>n(!1),onSave:o}),c.jsx(r6,{}),c.jsx(s6,{}),c.jsx(i6,{}),c.jsx(o6,{}),c.jsxs("footer",{className:"footer",children:[c.jsxs("div",{className:"container footer-content",children:[c.jsxs("div",{className:"footer-section",children:[c.jsx("h4",{children:"DeskHub"}),c.jsx("p",{children:"Khm ph v chia s nhng gc lm vic p nht t khp ni trn th gii."}),c.jsx(u6,{})]}),c.jsxs("div",{className:"footer-section",children:[c.jsx("h5",{children:"Lin Kt"}),c.jsxs("ul",{children:[c.jsx("li",{children:c.jsx("a",{href:"/",children:"B Su Tp"})}),c.jsx("li",{children:c.jsx("a",{href:"/blog",children:"Blog"})}),c.jsx("li",{children:c.jsx("a",{href:"#",children:"Gii Thiu"})}),c.jsx("li",{children:c.jsx("a",{href:"#",children:"Lin H"})})]})]}),c.jsxs("div",{className:"footer-section",children:[c.jsx("h5",{children:"Theo Di"}),c.jsxs("div",{className:"social-links",children:[c.jsx("a",{href:"#",className:"social-link","aria-label":"Facebook",children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"})})}),c.jsx("a",{href:"#",className:"social-link","aria-label":"Instagram",children:c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"5",ry:"5"}),c.jsx("path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"}),c.jsx("line",{x1:"17.5",y1:"6.5",x2:"17.51",y2:"6.5"})]})}),c.jsx("a",{href:"#",className:"social-link","aria-label":"YouTube",children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.33 29 29 0 0 0-.46-5.33zM9.75 15.02V8.5l5.75 3.26z"})})})]})]})]}),c.jsx("div",{className:"footer-bottom",children:c.jsx("div",{className:"container",children:c.jsx("p",{children:" 2026 DeskHub. Tt c quyn c bo lu."})})})]})]})};function h6(){return c.jsx(W4,{children:c.jsx(c6,{})})}ep.createRoot(document.getElementById("root")).render(c.jsx(zt.StrictMode,{children:c.jsx(ax,{children:c.jsx(dP,{children:c.jsx(h6,{})})})}));
